---
title: COleClientItem クラス
ms.date: 11/04/2016
f1_keywords:
- COleClientItem
- AFXOLE/COleClientItem
- AFXOLE/COleClientItem::COleClientItem
- AFXOLE/COleClientItem::Activate
- AFXOLE/COleClientItem::ActivateAs
- AFXOLE/COleClientItem::AttachDataObject
- AFXOLE/COleClientItem::CanCreateFromData
- AFXOLE/COleClientItem::CanCreateLinkFromData
- AFXOLE/COleClientItem::CanPaste
- AFXOLE/COleClientItem::CanPasteLink
- AFXOLE/COleClientItem::Close
- AFXOLE/COleClientItem::ConvertTo
- AFXOLE/COleClientItem::CopyToClipboard
- AFXOLE/COleClientItem::CreateCloneFrom
- AFXOLE/COleClientItem::CreateFromClipboard
- AFXOLE/COleClientItem::CreateFromData
- AFXOLE/COleClientItem::CreateFromFile
- AFXOLE/COleClientItem::CreateLinkFromClipboard
- AFXOLE/COleClientItem::CreateLinkFromData
- AFXOLE/COleClientItem::CreateLinkFromFile
- AFXOLE/COleClientItem::CreateNewItem
- AFXOLE/COleClientItem::CreateStaticFromClipboard
- AFXOLE/COleClientItem::CreateStaticFromData
- AFXOLE/COleClientItem::Deactivate
- AFXOLE/COleClientItem::DeactivateUI
- AFXOLE/COleClientItem::Delete
- AFXOLE/COleClientItem::DoDragDrop
- AFXOLE/COleClientItem::DoVerb
- AFXOLE/COleClientItem::Draw
- AFXOLE/COleClientItem::GetActiveView
- AFXOLE/COleClientItem::GetCachedExtent
- AFXOLE/COleClientItem::GetClassID
- AFXOLE/COleClientItem::GetClipboardData
- AFXOLE/COleClientItem::GetDocument
- AFXOLE/COleClientItem::GetDrawAspect
- AFXOLE/COleClientItem::GetExtent
- AFXOLE/COleClientItem::GetIconFromRegistry
- AFXOLE/COleClientItem::GetIconicMetafile
- AFXOLE/COleClientItem::GetInPlaceWindow
- AFXOLE/COleClientItem::GetItemState
- AFXOLE/COleClientItem::GetLastStatus
- AFXOLE/COleClientItem::GetLinkUpdateOptions
- AFXOLE/COleClientItem::GetType
- AFXOLE/COleClientItem::GetUserType
- AFXOLE/COleClientItem::IsInPlaceActive
- AFXOLE/COleClientItem::IsLinkUpToDate
- AFXOLE/COleClientItem::IsModified
- AFXOLE/COleClientItem::IsOpen
- AFXOLE/COleClientItem::IsRunning
- AFXOLE/COleClientItem::OnActivate
- AFXOLE/COleClientItem::OnActivateUI
- AFXOLE/COleClientItem::OnChange
- AFXOLE/COleClientItem::OnDeactivate
- AFXOLE/COleClientItem::OnDeactivateUI
- AFXOLE/COleClientItem::OnGetClipboardData
- AFXOLE/COleClientItem::OnInsertMenus
- AFXOLE/COleClientItem::OnRemoveMenus
- AFXOLE/COleClientItem::OnSetMenu
- AFXOLE/COleClientItem::OnShowControlBars
- AFXOLE/COleClientItem::OnUpdateFrameTitle
- AFXOLE/COleClientItem::ReactivateAndUndo
- AFXOLE/COleClientItem::Release
- AFXOLE/COleClientItem::Reload
- AFXOLE/COleClientItem::Run
- AFXOLE/COleClientItem::SetDrawAspect
- AFXOLE/COleClientItem::SetExtent
- AFXOLE/COleClientItem::SetHostNames
- AFXOLE/COleClientItem::SetIconicMetafile
- AFXOLE/COleClientItem::SetItemRects
- AFXOLE/COleClientItem::SetLinkUpdateOptions
- AFXOLE/COleClientItem::SetPrintDevice
- AFXOLE/COleClientItem::UpdateLink
- AFXOLE/COleClientItem::CanActivate
- AFXOLE/COleClientItem::OnChangeItemPosition
- AFXOLE/COleClientItem::OnDeactivateAndUndo
- AFXOLE/COleClientItem::OnDiscardUndoState
- AFXOLE/COleClientItem::OnGetClipRect
- AFXOLE/COleClientItem::OnGetItemPosition
- AFXOLE/COleClientItem::OnGetWindowContext
- AFXOLE/COleClientItem::OnScrollBy
- AFXOLE/COleClientItem::OnShowItem
helpviewer_keywords:
- COleClientItem [MFC], COleClientItem
- COleClientItem [MFC], Activate
- COleClientItem [MFC], ActivateAs
- COleClientItem [MFC], AttachDataObject
- COleClientItem [MFC], CanCreateFromData
- COleClientItem [MFC], CanCreateLinkFromData
- COleClientItem [MFC], CanPaste
- COleClientItem [MFC], CanPasteLink
- COleClientItem [MFC], Close
- COleClientItem [MFC], ConvertTo
- COleClientItem [MFC], CopyToClipboard
- COleClientItem [MFC], CreateCloneFrom
- COleClientItem [MFC], CreateFromClipboard
- COleClientItem [MFC], CreateFromData
- COleClientItem [MFC], CreateFromFile
- COleClientItem [MFC], CreateLinkFromClipboard
- COleClientItem [MFC], CreateLinkFromData
- COleClientItem [MFC], CreateLinkFromFile
- COleClientItem [MFC], CreateNewItem
- COleClientItem [MFC], CreateStaticFromClipboard
- COleClientItem [MFC], CreateStaticFromData
- COleClientItem [MFC], Deactivate
- COleClientItem [MFC], DeactivateUI
- COleClientItem [MFC], Delete
- COleClientItem [MFC], DoDragDrop
- COleClientItem [MFC], DoVerb
- COleClientItem [MFC], Draw
- COleClientItem [MFC], GetActiveView
- COleClientItem [MFC], GetCachedExtent
- COleClientItem [MFC], GetClassID
- COleClientItem [MFC], GetClipboardData
- COleClientItem [MFC], GetDocument
- COleClientItem [MFC], GetDrawAspect
- COleClientItem [MFC], GetExtent
- COleClientItem [MFC], GetIconFromRegistry
- COleClientItem [MFC], GetIconicMetafile
- COleClientItem [MFC], GetInPlaceWindow
- COleClientItem [MFC], GetItemState
- COleClientItem [MFC], GetLastStatus
- COleClientItem [MFC], GetLinkUpdateOptions
- COleClientItem [MFC], GetType
- COleClientItem [MFC], GetUserType
- COleClientItem [MFC], IsInPlaceActive
- COleClientItem [MFC], IsLinkUpToDate
- COleClientItem [MFC], IsModified
- COleClientItem [MFC], IsOpen
- COleClientItem [MFC], IsRunning
- COleClientItem [MFC], OnActivate
- COleClientItem [MFC], OnActivateUI
- COleClientItem [MFC], OnChange
- COleClientItem [MFC], OnDeactivate
- COleClientItem [MFC], OnDeactivateUI
- COleClientItem [MFC], OnGetClipboardData
- COleClientItem [MFC], OnInsertMenus
- COleClientItem [MFC], OnRemoveMenus
- COleClientItem [MFC], OnSetMenu
- COleClientItem [MFC], OnShowControlBars
- COleClientItem [MFC], OnUpdateFrameTitle
- COleClientItem [MFC], ReactivateAndUndo
- COleClientItem [MFC], Release
- COleClientItem [MFC], Reload
- COleClientItem [MFC], Run
- COleClientItem [MFC], SetDrawAspect
- COleClientItem [MFC], SetExtent
- COleClientItem [MFC], SetHostNames
- COleClientItem [MFC], SetIconicMetafile
- COleClientItem [MFC], SetItemRects
- COleClientItem [MFC], SetLinkUpdateOptions
- COleClientItem [MFC], SetPrintDevice
- COleClientItem [MFC], UpdateLink
- COleClientItem [MFC], CanActivate
- COleClientItem [MFC], OnChangeItemPosition
- COleClientItem [MFC], OnDeactivateAndUndo
- COleClientItem [MFC], OnDiscardUndoState
- COleClientItem [MFC], OnGetClipRect
- COleClientItem [MFC], OnGetItemPosition
- COleClientItem [MFC], OnGetWindowContext
- COleClientItem [MFC], OnScrollBy
- COleClientItem [MFC], OnShowItem
ms.assetid: 7f571b7c-2758-4839-847a-0cf1ef643128
ms.openlocfilehash: 2687dfc9941a512523a7cb771cb872c78b97ce2d
ms.sourcegitcommit: 5cecccba0a96c1b4ccea1f7a1cfd91f259cc5bde
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/01/2019
ms.locfileid: "58773984"
---
# <a name="coleclientitem-class"></a>COleClientItem クラス

OLE アイテムへのコンテナー インターフェイスを定義します。

## <a name="syntax"></a>構文

```
class COleClientItem : public CDocItem
```

## <a name="members"></a>メンバー

### <a name="public-constructors"></a>パブリック コンストラクター

|名前|説明|
|----------|-----------------|
|[COleClientItem::COleClientItem](#coleclientitem)|`COleClientItem` オブジェクトを構築します。|

### <a name="public-methods"></a>パブリック メソッド

|名前|説明|
|----------|-----------------|
|[COleClientItem::Activate](#activate)|操作の OLE 項目を開きし、指定された動詞を実行します。|
|[COleClientItem::ActivateAs](#activateas)|別の種類として、項目をアクティブにします。|
|[COleClientItem::AttachDataObject](#attachdataobject)|OLE オブジェクトのデータにアクセスします。|
|[COleClientItem::CanCreateFromData](#cancreatefromdata)|コンテナー アプリケーションが、埋め込みオブジェクトを作成できるかどうかを示します。|
|[COleClientItem::CanCreateLinkFromData](#cancreatelinkfromdata)|コンテナー アプリケーションがリンクされたオブジェクトを作成できるかどうかを示します。|
|[COleClientItem::CanPaste](#canpaste)|埋め込み可能なまたは静的 OLE アイテムがクリップボードに含まれるかどうかを示します。|
|[置き換えるには](#canpastelink)|OLE 項目をリンク可能がクリップボードに含まれるかどうかを示します。|
|[COleClientItem::Close](#close)|サーバーへのリンクを閉じますが、OLE 項目を破棄しません。|
|[COleClientItem::ConvertTo](#convertto)|項目を別の型に変換します。|
|[COleClientItem::CopyToClipboard](#copytoclipboard)|OLE 項目をクリップボードにコピーします。|
|[COleClientItem::CreateCloneFrom](#createclonefrom)|既存の項目の複製を作成します。|
|[COleClientItem::CreateFromClipboard](#createfromclipboard)|クリップボードから埋め込みアイテムを作成します。|
|[COleClientItem::CreateFromData](#createfromdata)|データ オブジェクトから埋め込みアイテムを作成します。|
|[COleClientItem::CreateFromFile](#createfromfile)|ファイルから埋め込みアイテムを作成します。|
|[COleClientItem::CreateLinkFromClipboard](#createlinkfromclipboard)|クリップボードからのリンクされた項目を作成します。|
|[COleClientItem::CreateLinkFromData](#createlinkfromdata)|データ オブジェクトからリンクされた項目を作成します。|
|[COleClientItem::CreateLinkFromFile](#createlinkfromfile)|ファイルからのリンクされた項目を作成します。|
|[COleClientItem::CreateNewItem](#createnewitem)|サーバー アプリケーションを起動して新しい埋め込みアイテムを作成します。|
|[COleClientItem::CreateStaticFromClipboard](#createstaticfromclipboard)|クリップボードから静的な項目を作成します。|
|[COleClientItem::CreateStaticFromData](#createstaticfromdata)|データ オブジェクトから、静的な項目を作成します。|
|[COleClientItem::Deactivate](#deactivate)|アイテムを非アクティブ化します。|
|[COleClientItem::DeactivateUI](#deactivateui)|コンテナー アプリケーションのユーザー インターフェイスは、元の状態に復元します。|
|[COleClientItem::Delete](#delete)|削除するか、またはリンクされた項目があった場合、OLE 項目を閉じます。|
|[COleClientItem::DoDragDrop](#dodragdrop)|ドラッグ アンド ドロップ操作を実行します。|
|[COleClientItem::DoVerb](#doverb)|指定した動詞を実行します。|
|[値](#draw)|OLE 項目を描画します。|
|[COleClientItem::GetActiveView](#getactiveview)|場所に項目がアクティブにビューを取得します。|
|[COleClientItem::GetCachedExtent](#getcachedextent)|OLE 項目の四角形の境界を返します。|
|[COleClientItem::GetClassID](#getclassid)|現在のアイテムのクラス ID を取得します|
|[COleClientItem::GetClipboardData](#getclipboarddata)|呼び出すことによって、クリップボードに配置がデータを取得、`CopyToClipboard`メンバー関数。|
|[COleClientItem::GetDocument](#getdocument)|返します、`COleDocument`存在する項目を格納しているオブジェクト。|
|[COleClientItem::GetDrawAspect](#getdrawaspect)|表示の項目の現在のビューを取得します。|
|[COleClientItem::GetExtent](#getextent)|OLE 項目の四角形の境界を返します。|
|[COleClientItem::GetIconFromRegistry](#geticonfromregistry)|特定の CLSID のサーバーに関連付けられているアイコンへのハンドルを取得します。|
|[COleClientItem::GetIconicMetafile](#geticonicmetafile)|項目のアイコンを描画するために使われるメタファイルを取得します。|
|[COleClientItem::GetInPlaceWindow](#getinplacewindow)|項目の一括編集ウィンドウへのポインターを返します。|
|[COleClientItem::GetItemState](#getitemstate)|アイテムの現在の状態を取得します。|
|[COleClientItem::GetLastStatus](#getlaststatus)|最後の OLE 操作の状態を返します。|
|[COleClientItem::GetLinkUpdateOptions](#getlinkupdateoptions)|リンクされた項目 (高度な機能) の更新モードを返します。|
|[COleClientItem::GetType](#gettype)|OLE 項目の種類 (埋め込み、リンク、または静的) を返します。|
|[COleClientItem::GetUserType](#getusertype)|項目の型を記述する文字列を取得します。|
|[COleClientItem::IsInPlaceActive](#isinplaceactive)|項目がアクティブである場合は、TRUE を返します。|
|[COleClientItem::IsLinkUpToDate](#islinkuptodate)|ソース ドキュメント内で最新の状態が、リンクされた項目の場合は TRUE を返します。|
|[COleClientItem::IsModified](#ismodified)|TRUE を返しますが最後の項目が変更された場合は、保存されます。|
|[COleClientItem::IsOpen](#isopen)|TRUE を返し、アイテムは、現在の場合は、サーバー アプリケーションで開きます。|
|[COleClientItem::IsRunning](#isrunning)|アイテムのサーバー アプリケーションが実行されている場合は、TRUE を返します。|
|[COleClientItem::OnActivate](#onactivate)|アイテムがアクティブ化されることを通知するためにフレームワークによって呼び出されます。|
|[COleClientItem::OnActivateUI](#onactivateui)|アクティブになるし、そのユーザー インターフェイスを表示する必要がありますが、アイテムを通知するためにフレームワークによって呼び出されます。|
|[COleClientItem::OnChange](#onchange)|サーバーは OLE 項目を変更するときに呼び出されます。 必要な実装です。|
|[COleClientItem::OnDeactivate](#ondeactivate)|項目が非アクティブ化されたときに、フレームワークによって呼び出されます。|
|[COleClientItem::OnDeactivateUI](#ondeactivateui)|サーバーがその場所でのユーザー インターフェイスを削除すると、フレームワークによって呼び出されます。|
|[COleClientItem::OnGetClipboardData](#ongetclipboarddata)|クリップボードにコピーするデータを取得するためにフレームワークによって呼び出されます。|
|[COleClientItem::OnInsertMenus](#oninsertmenus)|コンポジット メニューを作成するためにフレームワークによって呼び出されます。|
|[COleClientItem::OnRemoveMenus](#onremovemenus)|コンポジット メニューから、コンテナーのメニューを削除するためにフレームワークによって呼び出されます。|
|[COleClientItem::OnSetMenu](#onsetmenu)|インストールおよびコンポジット メニューを削除するためにフレームワークによって呼び出されます。|
|[COleClientItem::OnShowControlBars](#onshowcontrolbars)|コントロール バーを非表示にしたりするためにフレームワークによって呼び出されます。|
|[COleClientItem::OnUpdateFrameTitle](#onupdateframetitle)|フレーム ウィンドウのタイトル バーを更新するためにフレームワークによって呼び出されます。|
|[COleClientItem::ReactivateAndUndo](#reactivateandundo)|項目を再アクティブ化して、最後のインプレース編集操作を元に戻します。|
|[COleClientItem::Release](#release)|OLE リンク アイテムへの接続を解放し、開いていた場合に終了します。 クライアントの項目を破棄しません。|
|[COleClientItem::Reload](#reload)|呼び出しの後に、項目を再読み込み`ActivateAs`します。|
|[COleClientItem::Run](#run)|項目に関連付けられているアプリケーションを実行します。|
|[COleClientItem::SetDrawAspect](#setdrawaspect)|表示の項目の現在のビューを設定します。|
|[COleClientItem::SetExtent](#setextent)|OLE 項目の外接する四角形を設定します。|
|[COleClientItem::SetHostNames](#sethostnames)|OLE 項目を編集するときに、サーバーが表示名を設定します。|
|[COleClientItem::SetIconicMetafile](#seticonicmetafile)|項目のアイコンを描画するために使われるメタファイルをキャッシュします。|
|[COleClientItem::SetItemRects](#setitemrects)|項目の外接する四角形を設定します。|
|[COleClientItem::SetLinkUpdateOptions](#setlinkupdateoptions)|リンクされた項目 (高度な機能) の更新モードを設定します。|
|[COleClientItem::SetPrintDevice](#setprintdevice)|このクライアント アイテムの出力先のデバイスを設定します。|
|[COleClientItem::UpdateLink](#updatelink)|項目のプレゼンテーションのキャッシュを更新します。|

### <a name="protected-methods"></a>プロテクト メソッド

|名前|説明|
|----------|-----------------|
|[COleClientItem::CanActivate](#canactivate)|埋めこみ先編集が許可されているかどうかを判断するためにフレームワークによって呼び出されます。|
|[COleClientItem::OnChangeItemPosition](#onchangeitemposition)|アイテムの位置が変更されたときに、フレームワークによって呼び出されます。|
|[COleClientItem::OnDeactivateAndUndo](#ondeactivateandundo)|アクティブ化の後に元に戻すために、フレームワークによって呼び出されます。|
|[COleClientItem::OnDiscardUndoState](#ondiscardundostate)|項目の元に戻す状態情報を破棄するためにフレームワークによって呼び出されます。|
|[COleClientItem::OnGetClipRect](#ongetcliprect)|アイテムのクリッピング四角形の座標を取得するためにフレームワークによって呼び出されます。|
|[COleClientItem::OnGetItemPosition](#ongetitemposition)|ビューの基準とする項目の位置を取得するためにフレームワークによって呼び出されます。|
|[COleClientItem::OnGetWindowContext](#ongetwindowcontext)|場所に項目がアクティブになったときに、フレームワークによって呼び出されます。|
|[COleClientItem::OnScrollBy](#onscrollby)|項目をスクロールして表示するためにフレームワークによって呼び出されます。|
|[COleClientItem::OnShowItem](#onshowitem)|OLE 項目を表示するためにフレームワークによって呼び出されます。|

## <a name="remarks"></a>Remarks

OLE 項目を作成および管理「シームレス」に組み込めるドキュメントを 1 つのドキュメントをユーザーに表示されるように、サーバーのアプリケーションでは、データを表します。 OLE 項目とコンテナーのドキュメントで構成「複合ドキュメント」になります。

OLE アイテムは、いずれか埋め込みまたはリンクされています。 埋め込まれている場合、そのデータは、複合ドキュメントの一部として格納されます。 リンクされている場合、サーバー アプリケーションによって作成された別のファイルの一部としてそのデータが格納されているし、そのファイルへのリンクのみが複合ドキュメントに格納されています。 すべての OLE 項目には、その編集を呼び出す必要があるサーバー アプリケーションを指定する情報が含まれます。

`COleClientItem` サーバー アプリケーションからの要求に対する応答として呼び出されるいくつかのオーバーライド可能な関数を定義します。これらのオーバーライド可能な関数は、通常、通知として機能します。 これにより、サーバー アプリケーションは、OLE 項目を編集するときに、ユーザーが行った変更のコンテナーに通知する、または編集中に必要な情報を取得します。

`COleClientItem` いずれかで使用できる、 [COleDocument](../../mfc/reference/coledocument-class.md)、 [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)、または[COleServerDoc](../../mfc/reference/coleserverdoc-class.md)クラス。 使用する`COleClientItem`、そこから派生クラスを作成および実装、 [OnChange](#onchange)メンバー関数は、コンテナーが項目に加えられた変更をどのように応答する方法を定義します。 インプレース アクティブ化をサポートするためにオーバーライド、 [:ongetitemposition](#ongetitemposition)メンバー関数。 この関数は、OLE アイテムの表示位置に関する情報を提供します。

詳細については、コンテナー インターフェイスを使用して、記事をご覧ください。[コンテナー。コンテナーの実装](../../mfc/containers-implementing-a-container.md)と[アクティベーション](../../mfc/activation-cpp.md)します。

> [!NOTE]
>  Windows SDK は、「オブジェクト」として埋め込みおよびリンクされた項目を参照し、「クラスです」として項目の種類を参照 この参照は、OLE のエンティティを対応する C++ オブジェクトや C++ クラスから OLE カテゴリを区別するためには、"type"という用語と区別するのに、"item"という用語を使用します。

## <a name="inheritance-hierarchy"></a>継承階層

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CDocItem](../../mfc/reference/cdocitem-class.md)

`COleClientItem`

## <a name="requirements"></a>必要条件

**ヘッダー:** afxole.h

##  <a name="activate"></a>  COleClientItem::Activate

代わりに、指定された動詞を実行するには、この関数を呼び出す[DoVerb](#doverb)例外がスローされたときに、独自の処理を実行できるようにします。

```
void Activate(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>パラメーター

*nVerb*<br/>
実行する動詞を指定します。 次のいずれかを指定できます。

|[値]|説明|シンボル|
|-----------|-------------|------------|
|- 0|主動詞|OLEIVERB_PRIMARY|
|- 1|セカンダリの動詞|(なし)|
|- 1|編集するための表示項目|で|
|- 2|別のウィンドウで項目を編集します。|OLEIVERB_OPEN|
|- 3|アイテムを非表示します。|OLEIVERB_HIDE|

-1 という値は、通常、他の動詞のエイリアスです。 編集のオープンがサポートされていない場合は、-1 と同じ効果が-2。 追加の値を参照してください。 [IOleObject::DoVerb](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-doverb) Windows SDK に含まれています。

*pView*<br/>
OLE アイテムを保持するコンテナーの表示ウィンドウへのポインターこれは、インプレース アクティブ化のサーバー アプリケーションが使用されます。 コンテナーは、インプレース アクティブ化をサポートしていない場合、このパラメーターは NULL を指定する必要があります。

*lpMsg*<br/>
アクティブ化する項目を原因となったメッセージへのポインター。

### <a name="remarks"></a>Remarks

この関数は、サーバー アプリケーション、Microsoft Foundation Class ライブラリを使用して記述されていますが場合、 [OnDoVerb](../../mfc/reference/coleserveritem-class.md#ondoverb)メンバー関数は、対応する`COleServerItem`実行対象のオブジェクト。

主動詞し、で 0 が指定された場合、 *nVerb* OLE 項目の編集を許可するパラメーター、サーバー アプリケーションを起動します。 コンテナー アプリケーションでは、インプレース アクティブ化をサポートする場合は、インプレース編集を実行できます。 場合は、コンテナーは、インプレース アクティブ化 (または Open 動詞が指定されているかどうか) をサポートしていない、別のウィンドウで、サーバーを起動し、編集しが実行できます。 通常、コンテナー アプリケーションのユーザーが主動詞の値である OLE 項目をダブルクリックときに、 *nVerb*パラメーターは、ユーザーが実行できるアクションを決定します。 ただし、サーバーは、1 つのみのアクションをサポートする場合は、その操作が、関係なく、値がで指定された、 *nVerb*パラメーター。

詳細については、次を参照してください。 [IOleObject::DoVerb](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-doverb) Windows SDK に含まれています。

##  <a name="activateas"></a>  COleClientItem::ActivateAs

指定された型の項目と同様に、項目をアクティブ化する OLE オブジェクトの変換機能を使用して*clsidNew*します。

```
virtual BOOL ActivateAs(
    LPCTSTR lpszUserType,
    REFCLSID clsidOld,
    REFCLSID clsidNew);
```

### <a name="parameters"></a>パラメーター

*lpszUserType*<br/>
"Word"など、ターゲット ユーザーの種類を表す文字列へのポインター

*clsidOld*<br/>
アイテムの現在のクラスへの参照の id。 クラス ID にリンクがない限りは、格納されている実際のオブジェクトの種類を表す必要があります。 その場合は、リンクを参照する項目の CLSID が必要です。 [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md)アイテムの適切なクラス ID を自動的に提供します。

*clsidNew*<br/>
対象のクラス ID への参照

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

これはによって自動的に呼び出されます[COleConvertDialog::DoConvert](../../mfc/reference/coleconvertdialog-class.md#doconvert)します。 これは通常は呼び出されません直接。

##  <a name="attachdataobject"></a>  COleClientItem::AttachDataObject

初期化するために、この関数を呼び出して、 [COleDataObject](../../mfc/reference/coledataobject-class.md) OLE 項目内のデータにアクセスするためです。

```
void AttachDataObject(COleDataObject& rDataObject) const;
```

### <a name="parameters"></a>パラメーター

*rDataObject*<br/>
参照を`COleDataObject`OLE 項目のデータへのアクセスを許可する初期化されるオブジェクト。

##  <a name="canactivate"></a>  COleClientItem::CanActivate

ユーザーが OLE 項目のインプレース アクティブ化を要求したときに、フレームワークによって呼び出されますこの関数の戻り値は、インプレース アクティブ化が許可されているかどうかを判断します。

```
virtual BOOL CanActivate();
```

### <a name="return-value"></a>戻り値

埋めこみ先編集ができる場合、0 以外の場合それ以外の場合 0 を返します。

### <a name="remarks"></a>Remarks

既定の実装では、コンテナーに有効なウィンドウがある場合、インプレース アクティブ化ができます。 受け入れるか拒否されてアクティブ化要求の特別なロジックを実装するには、この関数をオーバーライドします。 たとえば、OLE 項目が小さすぎるか、現在表示されていない場合は、アクティブ化の要求を拒否する可能性が。

詳細については、次を参照してください。 [IOleInPlaceSite::CanInPlaceActivate](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-caninplaceactivate) Windows SDK に含まれています。

##  <a name="cancreatefromdata"></a>  COleClientItem::CanCreateFromData

コンテナー アプリケーションの埋め込みオブジェクトを作成できるかどうかを調べます、指定された`COleDataObject`オブジェクト。

```
static BOOL PASCAL CanCreateFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>パラメーター

*pDataObject*<br/>
ポインター、 [COleDataObject](../../mfc/reference/coledataobject-class.md) OLE 項目の作成元のオブジェクト。

### <a name="return-value"></a>戻り値

コンテナーからの埋め込みオブジェクトを作成できる場合、0 以外の場合、`COleDataObject`オブジェクト。 それ以外の場合、0。

### <a name="remarks"></a>Remarks

`COleDataObject`クラスは、ドラッグ アンド ドロップ、クリップボードや OLE 埋め込みアイテムからさまざまな形式でデータを取得するためのデータ転送で使用されます。

コンテナーは、この関数を使用して、有効にするか、貼り付け、編集貼り付けコマンドを無効にすることです。

詳細については、この記事を参照してください。[データ オブジェクトとデータ ソース (OLE)](../../mfc/data-objects-and-data-sources-ole.md)します。

##  <a name="cancreatelinkfromdata"></a>  COleClientItem::CanCreateLinkFromData

コンテナー アプリケーションからのリンクされたオブジェクトを作成できるかどうかを調べます、指定された`COleDataObject`オブジェクト。

```
static BOOL PASCAL CanCreateLinkFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>パラメーター

*pDataObject*<br/>
ポインター、 [COleDataObject](../../mfc/reference/coledataobject-class.md) OLE 項目の作成元のオブジェクト。

### <a name="return-value"></a>戻り値

コンテナーからのリンクされたオブジェクトを作成できる場合、0 以外の場合、`COleDataObject`オブジェクト。

### <a name="remarks"></a>Remarks

`COleDataObject`クラスは、ドラッグ アンド ドロップ、クリップボードや OLE 埋め込みアイテムからさまざまな形式でデータを取得するためのデータ転送で使用されます。

コンテナーは、有効または、特別な貼り付けの編集と編集リンクの貼り付け コマンドを無効にするのにことをこの関数を使用できます。

詳細については、この記事を参照してください。[データ オブジェクトとデータ ソース (OLE)](../../mfc/data-objects-and-data-sources-ole.md)します。

##  <a name="canpaste"></a>  COleClientItem::CanPaste

埋め込み OLE アイテムは、クリップボードから貼り付けができるかどうかを確認するには、この関数を呼び出します。

```
static BOOL PASCAL CanPaste();
```

### <a name="return-value"></a>戻り値

埋め込み OLE アイテムは、クリップボードから貼り付けができる場合は 0 以外それ以外の場合 0 を返します。

### <a name="remarks"></a>Remarks

詳細については、次を参照してください。 [OleGetClipboard](/windows/desktop/api/ole2/nf-ole2-olegetclipboard)と[OleQueryCreateFromData](/windows/desktop/api/ole2/nf-ole2-olequerycreatefromdata) Windows SDK に含まれています。

##  <a name="canpastelink"></a>  COleClientItem::CanPasteLink

この関数では、リンクされている OLE 項目をクリップボードから貼り付けができるかどうかを参照してください。

```
static BOOL PASCAL CanPasteLink();
```

### <a name="return-value"></a>戻り値

リンクされている OLE 項目をクリップボードから貼り付けができる場合は 0 以外それ以外の場合 0 を返します。

### <a name="remarks"></a>Remarks

詳細については、次を参照してください。 [OleGetClipboard](/windows/desktop/api/ole2/nf-ole2-olegetclipboard)と[OleQueryLinkFromData](/windows/desktop/api/ole2/nf-ole2-olequerylinkfromdata) Windows SDK に含まれています。

##  <a name="close"></a>  COleClientItem::Close

メモリ内には、そのハンドラーが実行されていないサーバーに読み込まれて実行中の状態を読み込み済み状態にから OLE 項目の状態を変更するには、この関数を呼び出します。

```
void Close(OLECLOSE dwCloseOption = OLECLOSE_SAVEIFDIRTY);
```

### <a name="parameters"></a>パラメーター

*dwCloseOption*<br/>
読み込み済み状態に戻ったときにどのような状況で OLE 項目が保存されたを指定するフラグ。 次の値のいずれかのことができます。

- OLECLOSE_SAVEIFDIRTY 保存、OLE アイテムです。

- OLECLOSE_NOSAVE OLE 項目を保存しません。

- OLECLOSE_PROMPTSAVE は、OLE 項目を保存するかどうかをユーザーに問い合わせます。

### <a name="remarks"></a>Remarks

OLE 項目が実行されていない場合は、この関数を指定しても影響はありません。

詳細については、次を参照してください。 [IOleObject::Close](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-close) Windows SDK に含まれています。

##  <a name="coleclientitem"></a>  COleClientItem::COleClientItem

構築、`COleClientItem`オブジェクトし、C++ オブジェクトのみを構築し、OLE の初期化は行われませんが、ドキュメントの項目のコンテナー ドキュメントのコレクションに追加します。

```
COleClientItem(COleDocument* pContainerDoc = NULL);
```

### <a name="parameters"></a>パラメーター

*pContainerDoc*<br/>
この項目を格納するコンテナーのドキュメントへのポインター。 いずれかになります[COleDocument](../../mfc/reference/coledocument-class.md)から派生します。

### <a name="remarks"></a>Remarks

NULL ポインターを渡す場合、コンテナーのドキュメントに追加は行われません。 明示的に呼び出す必要がある[COleDocument::AddItem](../../mfc/reference/coledocument-class.md#additem)します。

OLE 項目を使用する前に、次の作成のメンバー関数のいずれかを呼び出す必要があります。

- [一般的に](#createfromclipboard)

- [CreateFromData](#createfromdata)

- [CreateFromFile](#createfromfile)

- [関数](#createstaticfromclipboard)

- [CreateStaticFromData](#createstaticfromdata)

- [CreateLinkFromClipboard](#createlinkfromclipboard)

- [CreateLinkFromData](#createlinkfromdata)

- [CreateLinkFromFile](#createlinkfromfile)

- [CreateNewItem](#createnewitem)

- [CreateCloneFrom](#createclonefrom)

##  <a name="convertto"></a>  COleClientItem::ConvertTo

指定された型に、項目を変換するには、このメンバー関数を呼び出す*clsidNew*します。

```
virtual BOOL ConvertTo(REFCLSID clsidNew);
```

### <a name="parameters"></a>パラメーター

*clsidNew*<br/>
対象の型のクラス ID。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

これはによって自動的に呼び出されます[COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md)します。 メソッドを直接呼び出す必要はありません。

##  <a name="copytoclipboard"></a>  COleClientItem::CopyToClipboard

OLE 項目をクリップボードにコピーするには、この関数を呼び出します。

```
void CopyToClipboard(BOOL bIncludeLink = FALSE);
```

### <a name="parameters"></a>パラメーター

*bIncludeLink*<br/>
リンクの情報は、リンク アイテムを貼り付けられるように、クリップボードにコピーするかは、TRUE を返します。それ以外の場合は FALSE です。

### <a name="remarks"></a>Remarks

通常、[編集] メニューから、コピーまたは切り取りコマンドのメッセージ ハンドラーを記述する場合、この関数を呼び出します。 コピーまたは切り取りのコマンドを実装する場合、コンテナー アプリケーションで項目の選択を実装する必要があります。

詳細については、次を参照してください。 [OleSetClipboard](/windows/desktop/api/ole2/nf-ole2-olesetclipboard) Windows SDK に含まれています。

##  <a name="createclonefrom"></a>  COleClientItem::CreateCloneFrom

指定した OLE 項目のコピーを作成するには、この関数を呼び出します。

```
BOOL CreateCloneFrom(const COleClientItem* pSrcItem);
```

### <a name="parameters"></a>パラメーター

*pSrcItem*<br/>
重複する OLE アイテムへのポインター。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

コピーは、元の項目と同じです。 この関数は、元に戻す操作をサポートするために使用することができます。

##  <a name="createfromclipboard"></a>  COleClientItem::CreateFromClipboard

クリップボードの内容から埋め込みアイテムを作成するには、この関数を呼び出します。

```
BOOL CreateFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>パラメーター

*render*<br/>
サーバーが OLE 項目を表示する方法を指定するフラグ。 有効な値では、次を参照してください。 [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) Windows SDK に含まれています。

*cfFormat*<br/>
OLE 項目を作成するときにキャッシュするクリップボード データ形式を指定します。

*lpFormatEtc*<br/>
ポインターを[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc)場合に使用される構造*レンダリング*OLERENDER_FORMAT OLERENDER_DRAW か。 指定されたクリップボード形式の書式の追加情報を指定する場合にのみ、このパラメーターの値を指定*cfFormat*します。 このパラメーターを省略した場合、既定値は、の他のフィールドの使用は、`FORMATETC`構造体。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

通常の編集 メニューの 貼り付け コマンド メッセージ ハンドラーからこの関数を呼び出します。 (場合に、フレームワークによって貼り付けコマンドが有効になって、 [CanPaste](#canpaste)メンバー関数は 0 以外の値を返します)。

詳細については、次を参照してください。 [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender)と[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) Windows SDK に含まれています。

##  <a name="createfromdata"></a>  COleClientItem::CreateFromData

埋め込みからアイテムを作成するには、この関数を呼び出し、`COleDataObject`オブジェクト。

```
BOOL CreateFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>パラメーター

*pDataObject*<br/>
ポインター、 [COleDataObject](../../mfc/reference/coledataobject-class.md) OLE 項目の作成元のオブジェクト。

*render*<br/>
サーバーが OLE 項目を表示する方法を指定するフラグ。 有効な値では、次を参照してください。 [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) Windows SDK に含まれています。

*cfFormat*<br/>
OLE 項目を作成するときにキャッシュするクリップボード データ形式を指定します。

*lpFormatEtc*<br/>
ポインターを[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc)場合に使用される構造*レンダリング*OLERENDER_FORMAT OLERENDER_DRAW か。 指定されたクリップボード形式の書式の追加情報を指定する場合にのみ、このパラメーターの値を指定*cfFormat*します。 このパラメーターを省略した場合、既定値は、の他のフィールドの使用は、`FORMATETC`構造体。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

データ転送操作では、クリップボードまたはドラッグ アンド ドロップ操作からの貼り付けなどの提供`COleDataObject`サーバー アプリケーションによって提供される情報を含むオブジェクトします。 通常のオーバーライドでは使用[この関数](../../mfc/reference/cview-class.md#ondrop)します。

詳細については、次を参照してください。 [OleCreateFromData](/windows/desktop/api/ole2/nf-ole2-olecreatefromdata)、 [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender)、および[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) Windows SDK に含まれています。

##  <a name="createfromfile"></a>  COleClientItem::CreateFromFile

ファイルから埋め込み OLE アイテムを作成するには、この関数を呼び出します。

```
BOOL CreateFromFile(
    LPCTSTR lpszFileName,
    REFCLSID clsid = CLSID_NULL,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>パラメーター

*lpszFileName*<br/>
OLE 項目の作成元のファイルの名前へのポインター。

*clsid*<br/>
将来使用するために予約されています。

*render*<br/>
サーバーが OLE 項目を表示する方法を指定するフラグ。 有効な値では、次を参照してください。 [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) Windows SDK に含まれています。

*cfFormat*<br/>
OLE 項目を作成するときにキャッシュするクリップボード データ形式を指定します。

*lpFormatEtc*<br/>
ポインターを[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc)場合に使用される構造*レンダリング*OLERENDER_FORMAT OLERENDER_DRAW か。 指定されたクリップボード形式の書式の追加情報を指定する場合にのみ、このパラメーターの値を指定*cfFormat*します。 このパラメーターを省略した場合、既定値は、の他のフィールドの使用は、`FORMATETC`構造体。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>コメント

フレームワークからこの関数を呼び出します[クリック](../../mfc/reference/coleinsertdialog-class.md#createitem)場合は、ファイルから作成 を選択すると、ユーザーがオブジェクトの挿入 ダイアログ ボックスから [ok] を選択します。

詳細については、次を参照してください。 [OleCreateFromFile](/windows/desktop/api/ole/nf-ole-olecreatefromfile)、 [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender)、および[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) Windows SDK に含まれています。

##  <a name="createlinkfromclipboard"></a>  COleClientItem::CreateLinkFromClipboard

クリップボードの内容からリンクされた項目を作成するには、この関数を呼び出します。

```
BOOL CreateLinkFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>パラメーター

*render*<br/>
サーバーが OLE 項目を表示する方法を指定するフラグ。 有効な値では、次を参照してください。 [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) Windows SDK に含まれています。

*cfFormat*<br/>
OLE 項目を作成するときにキャッシュするクリップボード データ形式を指定します。

*lpFormatEtc*<br/>
ポインターを[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc)場合に使用される構造*レンダリング*OLERENDER_FORMAT OLERENDER_DRAW か。 指定されたクリップボード形式の書式の追加情報を指定する場合にのみ、このパラメーターの値を指定*cfFormat*します。 このパラメーターを省略した場合、既定値は、の他のフィールドの使用は、`FORMATETC`構造体。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

通常 編集 メニュー リンク貼り付け コマンドのメッセージ ハンドラーからこの関数を呼び出します。 (リンク貼り付けコマンドがの既定の実装で有効になっている[COleDocument](../../mfc/reference/coledocument-class.md) OLE 項目にリンクできますが、クリップボードに含まれている場合)。

詳細については、次を参照してください。 [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender)と[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) Windows SDK に含まれています。

##  <a name="createlinkfromdata"></a>  COleClientItem::CreateLinkFromData

リンクされた項目を作成するには、この関数を呼び出し、`COleDataObject`オブジェクト。

```
BOOL CreateLinkFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>パラメーター

*pDataObject*<br/>
ポインター、 [COleDataObject](../../mfc/reference/coledataobject-class.md) OLE 項目の作成元のオブジェクト。

*render*<br/>
サーバーが OLE 項目を表示する方法を指定するフラグ。 有効な値では、次を参照してください。 [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) Windows SDK に含まれています。

*cfFormat*<br/>
OLE 項目を作成するときにキャッシュするクリップボード データ形式を指定します。

*lpFormatEtc*<br/>
ポインターを[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc)場合に使用される構造*レンダリング*OLERENDER_FORMAT OLERENDER_DRAW か。 指定されたクリップボード形式の書式の追加情報を指定する場合にのみ、このパラメーターの値を指定*cfFormat*します。 このパラメーターを省略した場合、既定値は、の他のフィールドの使用は、`FORMATETC`構造体。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

呼び出しがこのユーザーにリンクが示されている場合は、ドロップ操作中に作成する必要があります。 これは、貼り付けコマンドを処理するために使用できます。 フレームワークによって呼び出された`COleClientItem::CreateLinkFromClipboard`し、[静的オブジェクト](../../mfc/reference/colepastespecialdialog-class.md#createitem)リンク オプションが選択されています。

詳細については、次を参照してください。 [OleCreateLinkFromData](/windows/desktop/api/ole2/nf-ole2-olecreatelinkfromdata)、 [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender)、および[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) Windows SDK に含まれています。

##  <a name="createlinkfromfile"></a>  COleClientItem::CreateLinkFromFile

ファイルからリンクされている OLE 項目を作成するには、この関数を呼び出します。

```
BOOL CreateLinkFromFile(
    LPCTSTR lpszFileName,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>パラメーター

*lpszFileName*<br/>
OLE 項目の作成元のファイルの名前へのポインター。

*render*<br/>
サーバーが OLE 項目を表示する方法を指定するフラグ。 有効な値では、次を参照してください。 [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) Windows SDK に含まれています。

*cfFormat*<br/>
OLE 項目を作成するときにキャッシュするクリップボード データ形式を指定します。

*lpFormatEtc*<br/>
ポインターを[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc)場合に使用される構造*レンダリング*OLERENDER_FORMAT OLERENDER_DRAW か。 指定されたクリップボード形式の書式の追加情報を指定する場合にのみ、このパラメーターの値を指定*cfFormat*します。 このパラメーターを省略した場合、既定値は、の他のフィールドの使用は、`FORMATETC`構造体。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

フレームワークは、ファイルから作成を選択し、リンク チェック ボックスをオンになって、ユーザーがオブジェクトの挿入 ダイアログ ボックスから ok を選択する場合、この関数を呼び出します。 呼び出された[クリック](../../mfc/reference/coleinsertdialog-class.md#createitem)します。

詳細については、次を参照してください。 [OleCreateLinkToFile](/windows/desktop/api/ole2/nf-ole2-olecreatelinktofile)、 [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender)、および[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) Windows SDK に含まれています。

##  <a name="createnewitem"></a>  COleClientItem::CreateNewItem

埋め込みアイテム; を作成するには、この関数を呼び出すこの関数は、ユーザーが OLE 項目を作成できるサーバー アプリケーションを起動します。

```
BOOL CreateNewItem(
    REFCLSID clsid,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>パラメーター

*clsid*<br/>
作成する OLE 項目の種類を一意に識別する ID です。

*render*<br/>
サーバーが OLE 項目を表示する方法を指定するフラグ。 有効な値では、次を参照してください。 [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) Windows SDK に含まれています。

*cfFormat*<br/>
OLE 項目を作成するときにキャッシュするクリップボード データ形式を指定します。

*lpFormatEtc*<br/>
ポインターを[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc)場合に使用される構造*レンダリング*OLERENDER_FORMAT OLERENDER_DRAW か。 指定されたクリップボード形式の書式の追加情報を指定する場合にのみ、このパラメーターの値を指定*cfFormat*します。 このパラメーターを省略した場合、既定値は、の他のフィールドの使用は、`FORMATETC`構造体。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

フレームワークは、新規作成 ボタンを選択すると、ユーザーがオブジェクトの挿入 ダイアログ ボックスから ok を選択する場合、この関数を呼び出します。

詳細については、次を参照してください。 [OleCreate](/windows/desktop/api/ole/nf-ole-olecreate)、 [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender)、および[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) Windows SDK に含まれています。

##  <a name="createstaticfromclipboard"></a>  COleClientItem::CreateStaticFromClipboard

クリップボードの内容から、静的な項目を作成するには、この関数を呼び出します。

```
BOOL CreateStaticFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>パラメーター

*render*<br/>
サーバーが OLE 項目を表示する方法を指定するフラグ。 有効な値では、次を参照してください。 [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) Windows SDK に含まれています。

*cfFormat*<br/>
OLE 項目を作成するときにキャッシュするクリップボード データ形式を指定します。

*lpFormatEtc*<br/>
ポインターを[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc)場合に使用される構造*レンダリング*OLERENDER_FORMAT OLERENDER_DRAW か。 指定されたクリップボード形式の書式の追加情報を指定する場合にのみ、このパラメーターの値を指定*cfFormat*します。 このパラメーターを省略した場合、既定値は、の他のフィールドの使用は、`FORMATETC`構造体。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

静的な項目には、プレゼンテーションのデータがネイティブのデータではなく; が含まれていますそのため編集できません。 場合に通常、この関数が呼び出す、[一般的に](#createfromclipboard)メンバー関数は失敗します。

詳細については、次を参照してください。 [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender)と[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) Windows SDK に含まれています。

##  <a name="createstaticfromdata"></a>  COleClientItem::CreateStaticFromData

静的な項目を作成するには、この関数を呼び出し、`COleDataObject`オブジェクト。

```
BOOL CreateStaticFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>パラメーター

*pDataObject*<br/>
ポインター、 [COleDataObject](../../mfc/reference/coledataobject-class.md) OLE 項目の作成元のオブジェクト。

*render*<br/>
サーバーが OLE 項目を表示する方法を指定するフラグ。 有効な値では、次を参照してください。 [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) Windows SDK に含まれています。

*cfFormat*<br/>
OLE 項目を作成するときにキャッシュするクリップボード データ形式を指定します。

*lpFormatEtc*<br/>
ポインターを[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc)場合に使用される構造*レンダリング*OLERENDER_FORMAT OLERENDER_DRAW か。 指定されたクリップボード形式の書式の追加情報を指定する場合にのみ、このパラメーターの値を指定*cfFormat*します。 このパラメーターを省略した場合、既定値は、の他のフィールドの使用は、`FORMATETC`構造体。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

静的な項目には、プレゼンテーションのデータがネイティブのデータではなく; が含まれていますそのため、編集できません。 同じです。 これは基本的に[関数](#createstaticfromclipboard)する点を除いて、任意の静的な項目を作成できます`COleDataObject`クリップボードからだけでなく、します。

使用される[静的オブジェクト](../../mfc/reference/colepastespecialdialog-class.md#createitem)静的を選択するとします。

詳細については、次を参照してください。 [OleCreateStaticFromData](/windows/desktop/api/ole2/nf-ole2-olecreatestaticfromdata)、 [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender)、および[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) Windows SDK に含まれています。

##  <a name="deactivate"></a>  COleClientItem::Deactivate

OLE 項目を非アクティブ化して、関連付けられているリソースを解放するには、この関数を呼び出します。

```
void Deactivate();
```

### <a name="remarks"></a>Remarks

通常非アクティブ化する、インプレース アクティブ OLE 項目、ユーザーが項目の境界外のクライアント領域上にマウス ポインターをクリックするとします。 OLE 項目を非アクティブ化すると、元に戻す状態を呼び出すことは不可能が破棄されることに注意してください、[ので](#reactivateandundo)メンバー関数。

アプリケーションでは、元に戻すをサポートする場合を呼び出さないで`Deactivate`。 代わりに、呼び出す[DeactivateUI](#deactivateui)します。

詳細については、次を参照してください。 [IOleInPlaceObject::InPlaceDeactivate](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) Windows SDK に含まれています。

##  <a name="deactivateui"></a>  COleClientItem::DeactivateUI

ユーザーは、インプレース アクティブなアイテムを非アクティブ化時に、この関数を呼び出します。

```
void DeactivateUI();
```

### <a name="remarks"></a>Remarks

この関数は、元の状態にメニューやインプレース アクティブ化用に作成されたその他のコントロールを非表示にコンテナー アプリケーションのユーザー インターフェイスを復元します。

この関数は、項目の元に戻す状態情報をフラッシュしません。 情報が保存されているように[ので](#reactivateandundo)アイテムを非アクティブ化の直後に、コンテナーの元に戻すコマンドが選択した場合に後で、サーバー アプリケーションで、元に戻すコマンドを実行するに使用できます。

詳細については、次を参照してください。 [IOleInPlaceObject::InPlaceDeactivate](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) Windows SDK に含まれています。

##  <a name="delete"></a>  COleClientItem::Delete

OLE 項目コンテナーのドキュメントから削除するには、この関数を呼び出します。

```
void Delete(BOOL bAutoDelete = TRUE);
```

### <a name="parameters"></a>パラメーター

*bAutoDelete*<br/>
項目が、ドキュメントから削除するかどうかを指定します。

### <a name="remarks"></a>Remarks

この関数を呼び出して、[リリース](#release)メンバー関数は、さらに、項目、完全に削除する OLE 項目、ドキュメントから C++ オブジェクトを削除します。 OLE 項目が埋め込まれている場合、項目のネイティブのデータは削除されます。 常に、実行中のサーバーが閉じられますそのため、項目がリンクを開く場合、それを閉じます。

##  <a name="dodragdrop"></a>  COleClientItem::DoDragDrop

呼び出す、`DoDragDrop`ドラッグ アンド ドロップ操作を実行するメンバー関数。

```
DROPEFFECT DoDragDrop(
    LPCRECT lpItemRect,
    CPoint ptOffset,
    BOOL bIncludeLink = FALSE,
    DWORD dwEffects = DROPEFFECT_COPY | DROPEFFECT_MOVE,
    LPCRECT lpRectStartDrag = NULL);
```

### <a name="parameters"></a>パラメーター

*lpItemRect*<br/>
クライアント座標 (ピクセル単位) 画面でアイテムの四角形。

*ptOffset*<br/>
オフセット*示す*ドラッグ時に、マウスの位置があった場所。

*bIncludeLink*<br/>
この場合に TRUE に、リンク設定データをクリップボードにコピーする必要があります。 サーバー アプリケーションがリンクをサポートしていない場合は FALSE に設定します。

*dwEffects*<br/>
ドラッグ元がドラッグ操作で許可する効果を決定します。

*lpRectStartDrag*<br/>
実際には、ドラッグの開始位置を定義する四角形を指すポインター。 詳細については、「解説」を参照してください。

### <a name="return-value"></a>戻り値

DROPEFFECT 値。 行った場合は、元のデータを削除する必要があります。

### <a name="remarks"></a>Remarks

ドラッグ アンド ドロップ操作はすぐに開始されません。 指定された四角形をマウス カーソルが離れる待機*lpRectStartDrag*または指定したミリ秒数が経過するまでです。 場合*lpRectStartDrag*が null の場合、四角形のサイズが 1 ピクセルです。

時刻の遅延は、レジストリ キーの設定によって指定されます。 遅延時間を変更するには呼び出すことによって[CWinApp::WriteProfileString](../../mfc/reference/cwinapp-class.md#writeprofilestring)または[cwinapp::writeprofileint](../../mfc/reference/cwinapp-class.md#writeprofileint)します。 遅延時間を指定しない場合は、200 ミリ秒の既定値が使用されます。 ドラッグの遅延時間は、次のように格納されます。

- Windows NT ドラッグ遅延時間は、HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\NT\CurrentVersion\IniFileMapping\win.ini\Windows\DragDelay に格納されます。

- Windows 3.x ドラッグの遅延時間は、WIN に格納されます。INI ファイルの [Windows} セクション。

- Windows 95/98 ドラッグ遅延時間は、WIN のキャッシュされたバージョンに格納されます。INI します。

レジストリのいずれかの遅延情報が格納されている方法の詳細についてはドラッグのまたはします。INI ファイルを参照してください[WriteProfileString](/windows/desktop/api/winbase/nf-winbase-writeprofilestringa) Windows SDK に含まれています。

##  <a name="doverb"></a>  COleClientItem::DoVerb

呼び出す`DoVerb`を指定した動詞を実行します。

```
virtual BOOL DoVerb(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>パラメーター

*nVerb*<br/>
実行する動詞を指定します。 次のいずれかを指定できます。

|[値]|説明|シンボル|
|-----------|-------------|------------|
|- 0|主動詞|OLEIVERB_PRIMARY|
|- 1|セカンダリの動詞|(なし)|
|- 1|編集するための表示項目|で|
|- 2|別のウィンドウで項目を編集します。|OLEIVERB_OPEN|
|- 3|アイテムを非表示します。|OLEIVERB_HIDE|

-1 という値は、通常、他の動詞のエイリアスです。 編集のオープンがサポートされていない場合は、-1 と同じ効果が-2。 追加の値を参照してください。 [IOleObject::DoVerb](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-doverb) Windows SDK に含まれています。

*pView*<br/>
表示ウィンドウへのポインターこれは、インプレース アクティブ化のサーバーによって使用されます。 コンテナー アプリケーションは、インプレース アクティブ化を許可していない場合、このパラメーターは NULL を指定する必要があります。

*lpMsg*<br/>
アクティブ化する項目を原因となったメッセージへのポインター。

### <a name="return-value"></a>戻り値

動詞が正常に実行された場合、0 以外の場合それ以外の場合 0 を返します。

### <a name="remarks"></a>Remarks

この関数を呼び出して、 [Activate](#activate)動詞を実行するメンバー関数。 例外をキャッチし、スローされた場合、ユーザーにメッセージ ボックスを表示します。

主動詞し、で 0 が指定された場合、 *nVerb* OLE 項目の編集を許可するパラメーター、サーバー アプリケーションを起動します。 コンテナー アプリケーションでは、インプレース アクティブ化をサポートする場合は、インプレース編集を実行できます。 場合は、コンテナーは、インプレース アクティブ化 (または Open 動詞が指定されているかどうか) をサポートしていない、別のウィンドウで、サーバーを起動し、編集しが実行できます。 通常、コンテナー アプリケーションのユーザーが主動詞の値である OLE 項目をダブルクリックときに、 *nVerb*パラメーターは、ユーザーが実行できるアクションを決定します。 ただし、サーバーは、1 つのみのアクションをサポートする場合は、その操作が、関係なく、値がで指定された、 *nVerb*パラメーター。

##  <a name="draw"></a>  COleClientItem::Draw

指定したデバイス コンテキストを使用して、指定した外接する四角形に OLE 項目を描画するには、この関数を呼び出します。

```
BOOL Draw(
    CDC* pDC,
    LPCRECT lpBounds,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
ポインターを[CDC](../../mfc/reference/cdc-class.md) OLE 項目を描画するために使用されるオブジェクト。

*lpBounds*<br/>
ポインターを[CRect](../../atl-mfc-shared/reference/crect-class.md)オブジェクトまたは`RECT`(論理単位で、デバイス コンテキストから判別) で OLE 項目を描画するための外接する四角形を定義する構造体。

*nDrawAspect*<br/>
OLE の部分を表す項目は、表示方法を指定します。 場合*nDrawAspect* -1 で、最後の側面を使用して設定[外観](#setdrawaspect)使用されます。 このフラグに指定できる値の詳細については、[外観](#setdrawaspect)を参照してください。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

関数によって作成された OLE 項目のメタファイル形式を使用可能性があります、 [OnDraw](../../mfc/reference/coleserveritem-class.md#ondraw)のメンバー関数`COleServerItem`します。

通常使用`Draw`画面の表示の場合と画面のデバイス コンテキストを渡す*pDC*します。 この場合、最初の 2 つのパラメーターのみを指定する必要があります。

*LpBounds*パラメーターは、ターゲットのデバイス コンテキスト (現在のマップ モード) の相対で四角形を識別します。 レンダリングは、画像をスケーリングする必要があり、表示されるビューと最終的な印刷されたイメージの拡大/縮小するビューを強制するコンテナー アプリケーションで使用できます。

詳細については、次を参照してください。 [IViewObject::Draw](/windows/desktop/api/oleidl/nf-oleidl-iviewobject-draw) Windows SDK に含まれています。

##  <a name="getactiveview"></a>  COleClientItem::GetActiveView

項目がインプレース アクティブ化するビューを返します。

```
CView* GetActiveView() const;
```

### <a name="return-value"></a>戻り値

ビューへのポインターそれ以外の場合、項目は、インプレース アクティブ化でがない場合は NULL です。

##  <a name="getcachedextent"></a>  COleClientItem::GetCachedExtent

OLE 項目のサイズを取得するには、この関数を呼び出します。

```
BOOL GetCachedExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>パラメーター

*lpSize*<br/>
ポインターを`SIZE`構造または[CSize](../../atl-mfc-shared/reference/csize-class.md)サイズ情報を受け取るオブジェクト。

*nDrawAspect*<br/>
境界を取得する OLE アイテムの外観を指定します。 使用可能な値は、[外観](#setdrawaspect)を参照してください。

### <a name="return-value"></a>戻り値

成功した場合、0 以外の場合OLE 項目が空白の場合は 0 を返します。

### <a name="remarks"></a>Remarks

この関数と同じ情報を提供する[GetExtent](#getextent)します。 ただし、呼び出す`GetCachedExtent`など他の OLE ハンドラーの処理中にエクステントの情報を取得する[OnChange](#onchange)します。 ディメンションは、寸法です。

これは、可能なため、`GetCachedExtent`を使用して、 [IViewObject2](/windows/desktop/api/oleidl/nn-oleidl-iviewobject2)を使用するのではなく、インターフェイス、 [IOleObject](/windows/desktop/api/oleidl/nn-oleidl-ioleobject)この項目の範囲を取得するインターフェイス。 `IViewObject2` COM オブジェクトが前回の呼び出しで使用されるエクステントの情報をキャッシュ[IViewObject::Draw](/windows/desktop/api/oleidl/nf-oleidl-iviewobject-draw)します。

詳細については、次を参照してください。 [IViewObject2::GetExtent](/windows/desktop/api/oleidl/nf-oleidl-iviewobject2-getextent) Windows SDK に含まれています。

##  <a name="getclassid"></a>  COleClientItem::GetClassID

指すメモリにアイテムのクラス ID を返します*pClassID*します。

```
void GetClassID(CLSID* pClassID) const;
```

### <a name="parameters"></a>パラメーター

*pClassID*<br/>
型の識別子にポインター [CLSID](/windows/desktop/com/clsid-key-hklm)クラス ID を取得するには CLSID については、Windows SDK を参照してください。

### <a name="remarks"></a>Remarks

クラス ID は、アイテムを編集するアプリケーションを一意に識別する 128 ビットの数値です。

詳細については、次を参照してください。 [IPersist::GetClassID](/windows/desktop/api/objidl/nf-objidl-ipersist-getclassid) Windows SDK に含まれています。

##  <a name="getclipboarddata"></a>  COleClientItem::GetClipboardData

取得するには、この関数を呼び出す、`COleDataSource`オブジェクトへの呼び出しで、クリップボードに配置がすべてのデータを含む、 [CopyToClipboard](#copytoclipboard)メンバー関数。

```
void GetClipboardData(
    COleDataSource* pDataSource,
    BOOL bIncludeLink = FALSE,
    LPPOINT lpOffset = NULL,
    LPSIZE lpSize = NULL);
```

### <a name="parameters"></a>パラメーター

*pDataSource*<br/>
ポインターを[COleDataSource](../../mfc/reference/coledatasource-class.md) OLE アイテム内に含まれるデータを受け取るオブジェクト。

*bIncludeLink*<br/>
データのリンクが含まれる場合は TRUE。それ以外の場合は FALSE です。

*lpOffset*<br/>
マウスのカーソル (ピクセル単位) のオブジェクトの配信元からのオフセット。

*lpSize*<br/>
ピクセル単位でオブジェクトのサイズ。

### <a name="remarks"></a>Remarks

`GetClipboardData` 既定の実装として呼び出される[OnGetClipboardData](#ongetclipboarddata)します。 オーバーライド`OnGetClipboardData`により提供されるだけでなく、データ形式を提供する場合にのみ`CopyToClipboard`します。 配置済みの形式で、`COleDataSource`オブジェクト呼び出しの前後に`CopyToClipboard`、しを渡すと、`COleDataSource`オブジェクトを[COleDataSource::SetClipboard](../../mfc/reference/coledatasource-class.md#setclipboard)関数。 たとえば、クリップボードに付随するコンテナー ドキュメント内の OLE 項目の位置を設定する場合はその情報を渡すための独自の形式を定義し、配置するには`COleDataSource`呼び出す前に`CopyToClipboard`します。

##  <a name="getdocument"></a>  COleClientItem::GetDocument

OLE 項目を含むドキュメントへのポインターを取得するには、この関数を呼び出します。

```
COleDocument* GetDocument() const;
```

### <a name="return-value"></a>戻り値

OLE 項目を含むドキュメントへのポインター。 アイテム、ドキュメントの一部でない場合は NULL です。

### <a name="remarks"></a>Remarks

このポインターへのアクセスを許可する、`COleDocument`への引数として渡されたオブジェクト、`COleClientItem`コンス トラクター。

##  <a name="getdrawaspect"></a>  COleClientItem::GetDrawAspect

呼び出す、`GetDrawAspect`現在の「アスペクト」またはアイテム ビューを調べます。

```
DVASPECT GetDrawAspect() const;
```

### <a name="return-value"></a>戻り値

列挙の型の参照で値が表示されている値[外観](#setdrawaspect)します。

### <a name="remarks"></a>Remarks

縦横比では、アイテムがレンダリングされる方法を指定します。

##  <a name="getextent"></a>  COleClientItem::GetExtent

OLE 項目のサイズを取得するには、この関数を呼び出します。

```
BOOL GetExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)- 1);
```

### <a name="parameters"></a>パラメーター

*lpSize*<br/>
ポインターを`SIZE`構造または`CSize`サイズ情報を受け取るオブジェクト。

*nDrawAspect*<br/>
境界を取得する OLE アイテムの外観を指定します。 使用可能な値は、[外観](#setdrawaspect)を参照してください。

### <a name="return-value"></a>戻り値

成功した場合、0 以外の場合OLE 項目が空白の場合は 0 を返します。

### <a name="remarks"></a>Remarks

この関数は、サーバー アプリケーション、Microsoft Foundation Class ライブラリを使用して記述されていますが場合、 [OnGetExtent](../../mfc/reference/coleserveritem-class.md#ongetextent)メンバー関数は、対応する`COleServerItem`呼び出されるオブジェクト。 最後に設定したサイズから取得したサイズが異なる場合があることに注意してください、 [SetExtent](#setextent)メンバー関数は; で指定されたサイズ`SetExtent`修正候補として扱われます。 ディメンションは、寸法です。

> [!NOTE]
>  呼び出さない`GetExtent`、OLE ハンドラーの処理中になど[OnChange](#onchange)します。 呼び出す[GetCachedExtent](#getcachedextent)代わりにします。

詳細については、次を参照してください。 [IOleObject::GetExtent](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-getextent) Windows SDK に含まれています。

##  <a name="geticonfromregistry"></a>  COleClientItem::GetIconFromRegistry

特定の CLSID のサーバーに関連付けられているアイコン リソースを識別するハンドルを取得するには、このメンバー関数を呼び出します。

```
HICON GetIconFromRegistry() const;

static HICON GetIconFromRegistry(CLSID& clsid);
```

### <a name="parameters"></a>パラメーター

*clsid*<br/>
アイコンに関連付けられているサーバーの CLSID への参照。

### <a name="return-value"></a>戻り値

有効なアイコンのリソースへのハンドルまたはサーバーのアイコン、または既定のアイコンが見つからない場合は NULL です。

### <a name="remarks"></a>Remarks

このメンバー関数は、サーバーを起動したり、サーバーが既に実行されている場合でも、アイコンを動的に取得。 代わりに、このメンバー関数は、サーバーの実行可能イメージが表示され、登録時に、サーバーに関連付けられている静的なアイコンを取得します。

##  <a name="geticonicmetafile"></a>  COleClientItem::GetIconicMetafile

項目のアイコンを描画するために使われるメタファイルを取得します。

```
HGLOBAL GetIconicMetafile();
```

### <a name="return-value"></a>戻り値

成功した場合、メタファイルを識別するハンドルそれ以外の場合は NULL です。

### <a name="remarks"></a>Remarks

現在のアイコンがない場合は、既定のアイコンが返されます。 これにより、MFC/OLE ダイアログ ボックスで自動的に呼び出され、通常直接呼び出されること。

この関数を呼び出しても[SetIconicMetafile](#seticonicmetafile)を後で使用できるメタファイルをキャッシュします。

##  <a name="getinplacewindow"></a>  COleClientItem::GetInPlaceWindow

呼び出す、`GetInPlaceWindow`一括編集するための項目が開かれたウィンドウにポインターを取得するメンバー関数。

```
CWnd* GetInPlaceWindow();
```

### <a name="return-value"></a>戻り値

項目の一括編集ウィンドウへのポインター項目がアクティブでない場合、またはそのサーバーが利用できない場合は NULL です。

### <a name="remarks"></a>Remarks

この関数は、インプレース アクティブである項目に対してのみ呼び出す必要があります。

##  <a name="getitemstate"></a>  COleClientItem::GetItemState

OLE 項目の現在の状態を取得するには、この関数を呼び出します。

```
UINT GetItemState() const;
```

### <a name="return-value"></a>戻り値

A`COleClientItem::ItemState`列挙値で、次のいずれかを指定できます: `emptyState`、 `loadedState`、 `openState`、 `activeState`、`activeUIState`します。 これらの状態については、この記事を参照してください。[コンテナー。クライアント アイテムの状態](../../mfc/containers-client-item-states.md)します。

### <a name="remarks"></a>Remarks

OLE 項目の状態が変更されたときの通知を使用して、 [OnChange](#onchange)メンバー関数。

詳細については、この記事を参照してください。[コンテナー。クライアント アイテムの状態](../../mfc/containers-client-item-states.md)します。

##  <a name="getlaststatus"></a>  COleClientItem::GetLastStatus

OLE の最後の操作のステータス コードを返します。

```
SCODE GetLastStatus() const;
```

### <a name="return-value"></a>戻り値

SCODE 値。

### <a name="remarks"></a>Remarks

FALSE、またはその他のメンバーの BOOL の値が NULL を返す関数を返すメンバー関数の`GetLastStatus`より詳細なエラー情報を返します。 ほとんどの OLE メンバー関数がより重大なエラーに対して例外をスローすることに注意します。 SCODE の解釈の詳細については、最終 SCODE 値が返されましたが、基になる OLE 呼び出しに依存します。

SCODE の詳細については、次を参照してください。 [COM エラー コードの構造](/windows/desktop/com/structure-of-com-error-codes)Windows SDK のドキュメント。

##  <a name="getlinkupdateoptions"></a>  COleClientItem::GetLinkUpdateOptions

OLE 項目のリンクの更新オプションの現在の値を取得するには、この関数を呼び出します。

```
OLEUPDATE GetLinkUpdateOptions();
```

### <a name="return-value"></a>戻り値

次のいずれかの値です。

- OLEUPDATE_ALWAYS では、可能な場合は、リンクされた項目を更新します。 このオプションは、リンク ダイアログ ボックスで、リンクの自動更新のオプション ボタンをサポートします。

- OLEUPDATE_ONCALL コンテナー アプリケーションからの要求でのみリンクされた項目の更新 (ときに、 [UpdateLink](#updatelink)メンバー関数が呼び出されます)。 このオプションは、リンク ダイアログ ボックスで、リンクの手動更新オプション ボタンをサポートします。

### <a name="remarks"></a>Remarks

これは、高度な操作です。

この関数、 [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md)クラス。

詳細については、次を参照してください。 [IOleLink::GetUpdateOptions](/windows/desktop/api/oleidl/nf-oleidl-iolelink-getupdateoptions) Windows SDK に含まれています。

##  <a name="gettype"></a>  COleClientItem::GetType

OLE 項目の埋め込みまたはリンクされているかどうか、または静的に決定するには、この関数を呼び出します。

```
OLE_OBJTYPE GetType() const;
```

### <a name="return-value"></a>戻り値

次の値のいずれかの符号なし整数。

- OT_LINK、OLE アイテムは、リンクです。

- OT_EMBEDDED、OLE 項目が埋め込まれます。

- OT_STATIC、OLE 項目が静的では、つまりネイティブではないデータは、プレゼンテーション データが含まれ、そのため、編集することはできません。

##  <a name="getusertype"></a>  COleClientItem::GetUserType

"Word"などの OLE 項目の型を記述するユーザーに表示される文字列を取得するには、この関数を呼び出す

```
void GetUserType(
    USERCLASSTYPE nUserClassType,
    CString& rString);
```

### <a name="parameters"></a>パラメーター

*nUserClassType*<br/>
OLE 項目の型を記述する文字列の目的のバリエーションを示す値。 次の値の 1 つがあります。

- USERCLASSTYPE_FULL 完全では、ユーザーに表示される名前を入力します。

- USERCLASSTYPE_SHORT A の短い名前 (15 文字以内) ポップアップ メニューとリンクの編集 ダイアログ ボックスで使用します。

- クラスを処理するアプリケーションの USERCLASSTYPE_APPNAME 名前です。

*rString*<br/>
参照を[CString](../../atl-mfc-shared/reference/cstringt-class.md) OLE 項目の型を記述する文字列が返されるオブジェクト。

### <a name="remarks"></a>Remarks

これは、多くの場合、システムの登録情報データベース内のエントリです。

完全な型名が要求されましたが、使用できない場合は、短い名前が代わりに使用されます。 登録情報データベース、OLE 項目の種類のエントリが見つからないか、ユーザーの種類が OLE 項目の種類に登録されていない場合、ユーザーの種類に格納されている場合は、OLE アイテムが使用されます。 そのユーザーの種類名が空の文字列の場合は、「不明なオブジェクト」が使用されます。

詳細については、次を参照してください。 [IOleObject::GetUserType](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-getusertype) Windows SDK に含まれています。

##  <a name="isinplaceactive"></a>  COleClientItem::IsInPlaceActive

OLE 項目がアクティブであるかどうかを確認するには、この関数を呼び出します。

```
BOOL IsInPlaceActive() const;
```

### <a name="return-value"></a>戻り値

OLE 項目が、インプレース アクティブ; である場合、0 以外の場合それ以外の場合 0 を返します。

### <a name="remarks"></a>Remarks

場所に、項目を編集するかどうかに応じて異なるロジックを実行する一般的です。 関数は、現在の項目の状態がいずれかに等しいかどうかを確認します。、`activeState`または`activeUIState`します。

##  <a name="islinkuptodate"></a>  COleClientItem::IsLinkUpToDate

OLE 項目が最新かどうかを確認するには、この関数を呼び出します。

```
BOOL IsLinkUpToDate() const;
```

### <a name="return-value"></a>戻り値

OLE 項目が最新の場合は 0 以外。それ以外の場合 0 を返します。

### <a name="remarks"></a>Remarks

リンクされた項目は期限切れは元のドキュメントが更新されている場合にできます。 内のリンクが含まれる埋め込みアイテム同様に古くなります。 関数は、OLE 項目のチェックを再帰的です。 OLE 項目が古くなっているかどうかを決定できる更新プログラムを実際に実行するコストがかかるに注意してください。

これはによって自動的に呼び出されます、 [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md)実装します。

詳細については、次を参照してください。 [:isuptodate](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-isuptodate) Windows SDK に含まれています。

##  <a name="ismodified"></a>  COleClientItem::IsModified

この関数では、かどうか OLE 項目がダーティ (最後に保存された以降に変更) を参照してください。

```
BOOL IsModified() const;
```

### <a name="return-value"></a>戻り値

OLE 項目がダーティの場合、0 以外の場合それ以外の場合 0 を返します。

### <a name="remarks"></a>Remarks

詳細については、次を参照してください。 [IPersistStorage::IsDirty](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-isdirty) Windows SDK に含まれています。

##  <a name="isopen"></a>  COleClientItem::IsOpen

OLE 項目が開いているかどうかを確認するには、この関数を呼び出すつまり、別のウィンドウで実行されているサーバー アプリケーションのインスタンスで開かれます。

```
BOOL IsOpen() const;
```

### <a name="return-value"></a>戻り値

OLE 項目が開いている場合は 0 以外それ以外の場合 0 を返します。

### <a name="remarks"></a>Remarks

() の陰影パターンを持つオブジェクトを描画する場合の判別に使用されます。 開いているオブジェクト、オブジェクトの上に描画されるハッチ パターンが必要です。 使用することができます、 [CRectTracker](../../mfc/reference/crecttracker-class.md)これを実現するオブジェクト。

##  <a name="isrunning"></a>  COleClientItem::IsRunning

OLE 項目が実行中かどうかを確認するには、この関数を呼び出す今後、項目が読み込まれ、サーバー アプリケーションの実行中かどうかは、します。

```
BOOL IsRunning() const;
```

### <a name="return-value"></a>戻り値

OLE 項目が実行されている以外の場合は 0 以外それ以外の場合 0 を返します。

### <a name="remarks"></a>Remarks

詳細については、次を参照してください。 [OleIsRunning](/windows/desktop/api/ole2/nf-ole2-oleisrunning) Windows SDK に含まれています。

##  <a name="onactivate"></a>  COleClientItem::OnActivate

インプレース アクティブされただけのアイテムを通知するためにフレームワークによって呼び出されます。

```
virtual void OnActivate();
```

### <a name="remarks"></a>Remarks

この関数がコンテナー アプリケーションのユーザー インターフェイスがインストールされたことを示しますが、サーバーを実行することを示すと呼ばれることに注意してください。 この時点で、オブジェクトには、アクティブなユーザー インターフェイスはありません (は`activeUIState`)。 メニューやツールバーが未インストールします。 [入った](#onactivateui)が発生すると、メンバー関数が呼び出されます。

既定の実装、 [OnChange](#onchange)をパラメーターとして OLE_CHANGEDSTATE でメンバー関数。 項目がアクティブになったときに、カスタム処理を実行するには、この関数をオーバーライドします。

##  <a name="onactivateui"></a>  COleClientItem::OnActivateUI

Framework 呼び出し`OnActivateUI`オブジェクトがアクティブの UI 状態になった場合。

```
virtual void OnActivateUI();
```

### <a name="remarks"></a>Remarks

オブジェクトは、ツールバーとメニューにインストールされているようになりましたが。

既定の実装は後で、サーバーの HWND を記憶`GetServerWindow`呼び出し。

##  <a name="onchange"></a>  COleClientItem::OnChange

ユーザーを変更、保存すると、または OLE 項目を終了するときに、フレームワークによって呼び出されます。

```
virtual void OnChange(
    OLE_NOTIFICATION nCode,
    DWORD dwParam);
```

### <a name="parameters"></a>パラメーター

*nCode*<br/>
その理由は、サーバーには、この項目が変更されました。 次の値のいずれかのことができます。

- OLE_CHANGED、OLE 項目の外観が変更されました。

- OLE 項目が保存されました。

- OLE_CLOSED、OLE 項目が閉じられました。

- OLE_CHANGED_STATE、OLE アイテムは、別の 1 つの状態から変更されました。

*dwParam*<br/>
場合*nCode*でまたは OLE_CLOSED は、このパラメーターは使用されません。 場合*nCode* OLE_CHANGED は、このパラメーターが変更された OLE 項目の外観を指定します。 使用可能な値は、、*について*パラメーターの[値](#draw)を参照してください。 場合*nCode* OLE_CHANGED_STATE は、このパラメーターは、`COleClientItem::ItemState`列挙値と、入力されている状態について説明します。 次の値のいずれかのことができます: `emptyState`、 `loadedState`、 `openState`、 `activeState`、または`activeUIState`します。

### <a name="remarks"></a>Remarks

(この関数がへの応答と呼ばれる、Microsoft Foundation Class ライブラリを使用して、サーバー アプリケーションが記述されている場合、`Notify`のメンバー関数`COleServerDoc`または`COleServerItem`)。既定の実装が変更として、コンテナー ドキュメントをマーク*nCode*では。

OLE_CHANGED_STATE の現在の状態が返される[GetItemState](#getitemstate)以前の状態、つまり、この状態の変更の前に現在の状態ができます。

OLE 項目の状態の変更に応答するには、この関数をオーバーライドします。 通常、項目の外観を更新するには、項目を表示する領域を無効にすること。 オーバーライドの先頭には、基本クラスの実装を呼び出します。

##  <a name="onchangeitemposition"></a>  COleClientItem::OnChangeItemPosition

コンテナーに、インプレース アクティブ化中に OLE 項目の範囲が変更されたことを通知するためにフレームワークによって呼び出されます。

```
virtual BOOL OnChangeItemPosition(const CRect& rectPos);
```

### <a name="parameters"></a>パラメーター

*rectPos*<br/>
コンテナー アプリケーションのクライアント領域を基準とする項目の位置を示します。

### <a name="return-value"></a>戻り値

アイテムの位置が正常に変更された場合は 0 以外。それ以外の場合 0 を返します。

### <a name="remarks"></a>Remarks

既定の実装は、OLE アイテムと呼び出しの新しい表示の四角形を決定します。 [SetItemRects](#setitemrects)新しい値を使用します。 既定の実装は、項目の表示の四角形を計算し、その情報をサーバーに渡します。

サイズ変更/移動操作には特別な規則を適用するには、この関数をオーバーライドします。 この呼び出しの結果、サーバーが呼び出されるため、アプリケーションが MFC で書き込まれた場合[から](../../mfc/reference/coleserverdoc-class.md#requestpositionchange)します。

##  <a name="ondeactivate"></a>  COleClientItem::OnDeactivate

OLE 項目が、インプレース アクティブ状態から遷移するときに、フレームワークによって呼び出されます ( `activeState`)、つまり、インプレース アクティブ化の後に非アクティブにする読み込み済み状態にします。

```
virtual void OnDeactivate();
```

### <a name="remarks"></a>Remarks

この関数が OLE 項目が閉じているいないコンテナーのアプリケーションから削除されたユーザー インターフェイスを示すと呼ばれることに注意してください。 その場合、 [OnDeactivateUI](#ondeactivateui)メンバー関数が呼び出されます。

既定の実装、 [OnChange](#onchange)をパラメーターとして OLE_CHANGEDSTATE でメンバー関数。 インプレース アクティブなアイテムが非アクティブ化は、カスタム処理を実行するには、この関数をオーバーライドします。 たとえば、コンテナー アプリケーションで元に戻すコマンドをサポートする場合ことができます関数をオーバーライドするこの元に戻す状態を破棄するアイテムが非アクティブ化したらに OLE 項目に対して実行された最後の操作を元に戻すことはできませんすることを示します。

##  <a name="ondeactivateandundo"></a>  COleClientItem::OnDeactivateAndUndo

ユーザーは、インプレース OLE 項目をアクティブ化した後、元に戻すコマンドを呼び出したときに、フレームワークによって呼び出されます。

```
virtual void OnDeactivateAndUndo();
```

### <a name="remarks"></a>Remarks

既定の実装[DeactivateUI](#deactivateui)サーバーのユーザー インターフェイスを非アクティブ化します。 コンテナー アプリケーションで元に戻すコマンドを実装している場合は、この関数をオーバーライドします。 オーバーライドの中で、関数の基底クラスのバージョンを呼び出すし、最後のコマンドは、アプリケーションで実行を元に戻します。

詳細については、次を参照してください。 [IOleInPlaceSite::DeactivateAndUndo](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-deactivateandundo) Windows SDK に含まれています。

##  <a name="ondeactivateui"></a>  COleClientItem::OnDeactivateUI

ユーザーは、インプレース アクティブなアイテムを非アクティブ化時に呼び出されます。

```
virtual void OnDeactivateUI(BOOL bUndoable);
```

### <a name="parameters"></a>パラメーター

*bUndoable*<br/>
編集に元に戻せるかどうかを指定します。

### <a name="remarks"></a>Remarks

この関数は、元の状態にメニューやインプレース アクティブ化用に作成されたその他のコントロールを非表示にコンテナー アプリケーションのユーザー インターフェイスを復元します。

場合*bUndoable* false で、コンテナーには、破棄することで、コンテナーの元に戻す状態、サーバーによって実行される最後の操作は取り消し可能なことを示すため、元に戻すコマンドが無効にする必要があります。

##  <a name="ondiscardundostate"></a>  COleClientItem::OnDiscardUndoState

ユーザーが OLE 項目の編集中に元に戻す状態を破棄する操作を実行するときに、フレームワークによって呼び出されます。

```
virtual void OnDiscardUndoState();
```

### <a name="remarks"></a>Remarks

既定の実装では、何も行われません。 コンテナー アプリケーションで元に戻すコマンドを実装している場合は、この関数をオーバーライドします。 オーバーライドの中でコンテナー アプリケーションの元に戻す状態を破棄します。

この関数を呼び出すことによって呼び出すことができます、サーバーが発生する場合は、サーバーは、Microsoft Foundation Class ライブラリで書き込まれましたが、 [COleServerDoc::DiscardUndoState](../../mfc/reference/coleserverdoc-class.md#discardundostate)します。

詳細については、次を参照してください。 [IOleInPlaceSite::DiscardUndoState](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-discardundostate) Windows SDK に含まれています。

##  <a name="ongetclipboarddata"></a>  COleClientItem::OnGetClipboardData

取得するためにフレームワークによって呼び出される、`COleDataSource`オブジェクトのいずれかを呼び出して、クリップボードに配置がすべてのデータを格納している、 [CopyToClipboard](#copytoclipboard)または[(dodragdrop を)](#dodragdrop)メンバー関数。

```
virtual COleDataSource* OnGetClipboardData(
    BOOL bIncludeLink,
    LPPOINT lpOffset,
    LPSIZE lpSize);
```

### <a name="parameters"></a>パラメーター

*bIncludeLink*<br/>
この場合に TRUE に設定リンク データをクリップボードにコピーする必要があります。 サーバーの場合は FALSE に設定アプリケーションへのリンクをサポートしません。

*lpOffset*<br/>
ピクセル単位でオブジェクトの配信元からマウス カーソルのオフセットへのポインター。

*lpSize*<br/>
ピクセル単位でオブジェクトのサイズへのポインター。

### <a name="return-value"></a>戻り値

ポインターを[COleDataSource](../../mfc/reference/coledatasource-class.md)クリップボードのデータを格納しているオブジェクト。

### <a name="remarks"></a>Remarks

この関数の既定の実装を呼び出す[GetClipboardData](#getclipboarddata)します。

##  <a name="ongetcliprect"></a>  COleClientItem::OnGetClipRect

フレームワークによって、`OnGetClipRect`インプレース編集されているアイテムのクリッピング四角形の座標を取得します。

```
virtual void OnGetClipRect(CRect& rClipRect);
```

### <a name="parameters"></a>パラメーター

*rClipRect*<br/>
クラスのオブジェクトへのポインター [CRect](../../atl-mfc-shared/reference/crect-class.md)アイテムのクリッピング四角形の座標を保持します。

### <a name="remarks"></a>Remarks

座標は、コンテナー アプリケーション ウィンドウのクライアント領域を基準と (ピクセル単位)。

既定の実装は、単に、項目が、インプレース アクティブ ビューのクライアントの四角形を返します。

##  <a name="ongetitemposition"></a>  COleClientItem::OnGetItemPosition

フレームワークによって、`OnGetItemPosition`インプレース編集されている項目の座標を取得します。

```
virtual void OnGetItemPosition(CRect& rPosition);
```

### <a name="parameters"></a>パラメーター

*rPosition*<br/>
参照、 [CRect](../../atl-mfc-shared/reference/crect-class.md)アイテムの位置座標を格納するオブジェクト。

### <a name="remarks"></a>Remarks

座標は、コンテナー アプリケーション ウィンドウのクライアント領域を基準と (ピクセル単位)。

この関数の既定の実装は、何も行いません。 インプレース編集をサポートするアプリケーションでは、その実装が必要です。

##  <a name="ongetwindowcontext"></a>  COleClientItem::OnGetWindowContext

場所に項目がアクティブになったときに、フレームワークによって呼び出されます。

```
virtual BOOL OnGetWindowContext(
    CFrameWnd** ppMainFrame,
    CFrameWnd** ppDocFrame,
    LPOLEINPLACEFRAMEINFO lpFrameInfo);
```

### <a name="parameters"></a>パラメーター

*ppMainFrame*<br/>
メイン フレーム ウィンドウへのポインターへのポインター。

*ppDocFrame*<br/>
ドキュメント フレーム ウィンドウへのポインターへのポインター。

*lpFrameInfo*<br/>
ポインター、[受け取る](/windows/desktop/api/oleidl/ns-oleidl-tagoifi)フレーム ウィンドウの情報を受け取る構造体。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

この関数は、OLE 項目の親ウィンドウに関する情報の取得に使用されます。

既定の実装がへのポインターを返す場合は、コンテナーでは、MDI アプリケーションは、 [CMDIFrameWnd](../../mfc/reference/cmdiframewnd-class.md)オブジェクト*ときは*とアクティブなへのポインター [CMDIChildWnd](../../mfc/reference/cmdichildwnd-class.md)オブジェクト*き*します。 コンテナーが SDI アプリケーションの場合は、既定の実装がへのポインターを返します、 [CFrameWnd](../../mfc/reference/cframewnd-class.md)オブジェクト*ときは*で NULL を返しますと*き*します。 既定の実装がのメンバーでも塗りつぶします*は*します。

既定の実装がアプリケーションに適合しない場合にのみ、この関数をオーバーライドします。たとえば、次のようにアプリケーションにユーザー インターフェイスのパラダイム SDI または MDI のとは異なる場合です。 これは、高度なオーバーライド可能な。

詳細については、次を参照してください。 [IOleInPlaceSite::GetWindowContext](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-getwindowcontext)と[受け取る](/windows/desktop/api/oleidl/ns-oleidl-tagoifi)Windows SDK の構造体。

##  <a name="oninsertmenus"></a>  COleClientItem::OnInsertMenus

空のメニューに、コンテナー アプリケーションのメニューを挿入する、インプレース アクティブ化時にフレームワークによって呼び出されます。

```
virtual void OnInsertMenus(
    CMenu* pMenuShared,
    LPOLEMENUGROUPWIDTHS lpMenuWidths);
```

### <a name="parameters"></a>パラメーター

*コンテナー*<br/>
空のメニューへのポインター。

*lpMenuWidths*<br/>
次のメニュー グループの各メニューの数を示す 6 つの長い値の配列を指します。ファイルを編集、コンテナー、オブジェクト、ウィンドウのヘルプ。 コンテナー アプリケーションは、ファイル、コンテナー、およびウィンドウ] メニューの [グループの 0、2、および 4 がこの配列の要素に対応します。

### <a name="remarks"></a>Remarks

このメニューは、独自のメニューは、コンポジット メニューの作成を挿入すると、サーバーに渡されます。 この関数は、いくつかのコンポジット メニューを構築する繰り返し呼び出すことができます。

既定の実装を挿入*コンテナー*インプレースでコンテナーのメニュー。 つまり、ファイル、コンテナー、およびウィンドウのメニュー グループ。 [CDocTemplate::SetContainerInfo](../../mfc/reference/cdoctemplate-class.md#setcontainerinfo)このメニュー リソースを設定するために使用します。 また、既定の実装は 0、2、および 4 での要素に適切な値を割り当てます*lpMenuWidths*、メニュー リソースによって異なります。 既定の実装がアプリケーションに適切でない場合は、この関数をオーバーライドします。たとえば、次のように、アプリケーションがリソースをドキュメントの種類に関連付けるためのドキュメント テンプレートを使用しない場合です。 オーバーライドする必要がある場合、この関数をオーバーライドすると、[とき](#onsetmenu)と[OnRemoveMenus](#onremovemenus)します。 これは、高度なオーバーライド可能な。

詳細については、次を参照してください。 [IOleInPlaceFrame::InsertMenus](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceframe-insertmenus) Windows SDK に含まれています。

##  <a name="onremovemenus"></a>  COleClientItem::OnRemoveMenus

埋めこみ先編集が終了すると、指定した複合メニューから、コンテナーのメニューを削除するためにフレームワークによって呼び出されます。

```
virtual void OnRemoveMenus(CMenu* pMenuShared);
```

### <a name="parameters"></a>パラメーター

*コンテナー*<br/>
呼び出しによって構築されるコンポジット メニューを指す、[とき](#oninsertmenus)メンバー関数。

### <a name="remarks"></a>Remarks

既定の実装を削除します*コンテナー*インプレースでコンテナーのメニューは、ファイル、コンテナー、およびウィンドウのメニュー グループ。 既定の実装がアプリケーションに適切でない場合は、この関数をオーバーライドします。たとえば、次のように、アプリケーションがリソースをドキュメントの種類に関連付けるためのドキュメント テンプレートを使用しない場合です。 この関数をオーバーライドする場合はおそらくをオーバーライドする[とき](#oninsertmenus)と[とき](#onsetmenu)もします。 これは、高度なオーバーライド可能な。

サブメニュー*コンテナー*サーバーが繰り返し呼び出された場合は、複数のコンポジット メニューに共有される`OnInsertMenus`します。 そのため削除しないで、サブメニューのオーバーライドで`OnRemoveMenus`; のみ切断する必要があります。

詳細については、次を参照してください。 [IOleInPlaceFrame::RemoveMenus](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceframe-removemenus) Windows SDK に含まれています。

##  <a name="onscrollby"></a>  COleClientItem::OnScrollBy

サーバーからの要求に応答で OLE 項目をスクロールするためにフレームワークによって呼び出されます。

```
virtual BOOL OnScrollBy(CSize sizeExtent);
```

### <a name="parameters"></a>パラメーター

*sizeExtent*<br/>
X および y 方向のスクロールをピクセル単位で距離を指定します。

### <a name="return-value"></a>戻り値

項目がスクロールされた場合は 0 以外項目がスクロールできない場合は 0。

### <a name="remarks"></a>Remarks

たとえば、OLE アイテムは部分的に表示されて、ユーザーが表示領域外で埋め込み先編集を実行中に移動、カーソルを表示したままにこの関数が呼び出されます。 既定の実装では、何も行われません。 指定した量によって、項目をスクロールするには、この関数をオーバーライドします。 スクロールすると、結果として OLE 項目の表示部分を変更できることに注意してください。 呼び出す[SetItemRects](#setitemrects)アイテムの表示の四角形を更新します。

詳細については、次を参照してください。 [IOleInPlaceSite::Scroll](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-scroll) Windows SDK に含まれています。

##  <a name="onsetmenu"></a>  COleClientItem::OnSetMenu

インプレース アクティブ化が開始され、終了は、2 回をフレームワークが呼び出しますコンポジット メニューと、2 回目をインストールする最初の時間 (と*holemenu* null) を削除します。

```
virtual void OnSetMenu(
    CMenu* pMenuShared,
    HOLEMENU holemenu,
    HWND hwndActiveObject);
```

### <a name="parameters"></a>パラメーター

*コンテナー*<br/>
呼び出しによって構築されるコンポジット メニューへのポインター、[とき](#oninsertmenus)メンバー関数および`InsertMenu`関数。

*holemenu*<br/>
によって返されるメニュー記述子へのハンドル、`OleCreateMenuDescriptor`関数、またはディスパッチのコードを削除する場合は NULL です。

*hwndActiveObject*<br/>
OLE 項目の編集ウィンドウへのハンドルします。 これは、OLE から編集コマンドを受信するウィンドウです。

### <a name="remarks"></a>Remarks

既定の実装をインストールまたはコンポジット メニューを削除しを呼び出して、[その](/windows/desktop/api/ole2/nf-ole2-olesetmenudescriptor)インストールまたはディスパッチのコードを削除する関数。 既定の実装がアプリケーションに対して適切でない場合は、この関数をオーバーライドします。 この関数をオーバーライドする場合はおそらくをオーバーライドする[とき](#oninsertmenus)と[OnRemoveMenus](#onremovemenus)もします。 これは、高度なオーバーライド可能な。

詳細については、次を参照してください。 [OleCreateMenuDescriptor](/windows/desktop/api/ole2/nf-ole2-olecreatemenudescriptor)、[その](/windows/desktop/api/ole2/nf-ole2-olesetmenudescriptor)、および[IOleInPlaceFrame::SetMenu](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceframe-setmenu) Windows SDK に含まれています。

##  <a name="onshowcontrolbars"></a>  COleClientItem::OnShowControlBars

コンテナー アプリケーションのコントロール バーを非表示にしたりするためにフレームワークによって呼び出されます。

```
virtual BOOL OnShowControlBars(
    CFrameWnd* pFrameWnd,
    BOOL bShow);
```

### <a name="parameters"></a>パラメーター

*pFrameWnd*<br/>
コンテナー アプリケーションのフレーム ウィンドウへのポインター。 メイン フレーム ウィンドウまたは MDI 子ウィンドウのいずれかを指定できます。

*bShow*<br/>
コントロール バーを表示/非表示にするかどうかを指定します。

### <a name="return-value"></a>戻り値

コントロール バーの状態で関数呼び出しによって変更が生じた場合、0 以外の場合0、呼び出すには、変更がない場合、または場合*pFrameWnd*がコンテナーのフレーム ウィンドウを指していません。

### <a name="remarks"></a>Remarks

この関数は、コントロール バーがで指定された状態で既に場合に 0 を返します*bShow します。* これは、処理は発生、たとえば、コントロール バーが非表示の場合と*bShow*は FALSE です。

既定の実装では、最上位レベルのフレーム ウィンドウから、ツールバーを削除します。

##  <a name="onshowitem"></a>  COleClientItem::OnShowItem

編集中に完全に表示されるように、OLE アイテムを表示するためにフレームワークによって呼び出されます。

```
virtual void OnShowItem();
```

### <a name="remarks"></a>Remarks

コンテナー アプリケーションは、埋め込みアイテムへのリンクをサポートしている場合に使用されます (ドキュメントからクラスを派生する場合は、 [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md))。 この関数は、インプレース アクティブ化または OLE 項目がリンクのソースと、ユーザーがそれを編集する際に呼び出されます。 既定の実装には、コンテナー ドキュメントの最初のビューがアクティブにします。 OLE 項目が表示されるようにドキュメントをスクロールするには、この関数をオーバーライドします。

##  <a name="onupdateframetitle"></a>  COleClientItem::OnUpdateFrameTitle

フレーム ウィンドウのタイトル バーを更新する、インプレース アクティブ化時にフレームワークによって呼び出されます。

```
virtual BOOL OnUpdateFrameTitle();
```

### <a name="return-value"></a>戻り値

この場合は 0 以外の関数は、フレームのタイトルを正常に更新されました、それ以外の場合は 0。

### <a name="remarks"></a>Remarks

既定の実装では、フレーム ウィンドウのタイトルは変更されません。 たとえば、アプリケーションの別のフレームのタイトルを必要する場合は、この関数をオーバーライド"*サーバー アプリ* - *項目*で*docname*"(ように、"MicrosoftExcel - レポートでのスプレッドシートです。DOC")。 これは、高度なオーバーライド可能な。

##  <a name="reactivateandundo"></a>  COleClientItem::ReactivateAndUndo

OLE 項目を再アクティブ化し、インプレース編集中に、ユーザーによって実行される最後の操作を元に戻すには、この関数を呼び出します。

```
BOOL ReactivateAndUndo();
```

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

コンテナー アプリケーションでは、元に戻すコマンドをサポートする場合、ユーザーは、OLE 項目を非アクティブ化の直後に元に戻すコマンドを選択した場合、この関数を呼び出します。

Microsoft Foundation Class ライブラリで、サーバー アプリケーションが書き込まれると、この関数と、サーバーを呼び出す[されて](../../mfc/reference/coleserverdoc-class.md#onreactivateandundo)します。

詳細については、次を参照してください。 [IOleInPlaceObject::ReactivateAndUndo](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-reactivateandundo) Windows SDK に含まれています。

##  <a name="release"></a>  COleClientItem::Release

OLE アイテムによって使用されるリソースをクリーンアップするには、この関数を呼び出します。

```
virtual void Release(OLECLOSE dwCloseOption = OLECLOSE_NOSAVE);
```

### <a name="parameters"></a>パラメーター

*dwCloseOption*<br/>
読み込み済み状態に戻ったときにどのような状況で OLE 項目が保存されたを指定するフラグ。 使用可能な値の一覧は、[COleClientItem::Close](#close)を参照してください。

### <a name="remarks"></a>Remarks

`Release` によって呼び出される、`COleClientItem`デストラクター。

詳細については、次を参照してください。 [:release](/windows/desktop/api/unknwn/nf-unknwn-iunknown-release) Windows SDK に含まれています。

##  <a name="reload"></a>  COleClientItem::Reload

終了し、項目を再読み込みします。

```
BOOL Reload();
```

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

呼び出す、`Reload`関数を呼び出して、別の型の項目として項目をアクティブ化した後[ActivateAs](#activateas)します。

##  <a name="run"></a>  COleClientItem::Run

この項目に関連付けられているアプリケーションを実行します。

```
void Run();
```

### <a name="remarks"></a>Remarks

呼び出す、`Run`メンバー関数は、項目をアクティブ化する前に、サーバー アプリケーションを起動します。 によって自動的にこれは、 [Activate](#activate)と[DoVerb](#doverb)をこの関数を呼び出す必要は通常、します。 項目属性を設定するには、サーバーを実行する必要がある場合は、この関数を呼び出す[SetExtent](#setextent)、実行する前に[DoVerb](#doverb)します。

##  <a name="setdrawaspect"></a>  COleClientItem::SetDrawAspect

呼び出す、 `SetDrawAspect` 「特性」またはアイテムのビューを設定します。

```
virtual void SetDrawAspect(DVASPECT nDrawAspect);
```

### <a name="parameters"></a>パラメーター

*nDrawAspect*<br/>
列挙型の値。 このパラメーターには、次のいずれかの値を指定できます。

- DVASPECT_CONTENT 項目は、そのコンテナー内の埋め込みオブジェクトとして表示されることがこのような方法で表されます。

- DVASPECT_THUMBNAIL アイテムは、参照ツールで表示できるように、「サムネイル」表記で表示されます。

- DVASPECT_ICON 項目がアイコンで表されます。

- [ファイル] メニューから [印刷] コマンドを使用して印刷した場合と、DVASPECT_DOCPRINT 項目が表されます。

### <a name="remarks"></a>Remarks

縦横比は、項目がによってレンダリングされる方法を指定します[描画](#draw)その関数の既定の値と*nDrawAspect*引数を使用します。

この関数は、アイコンの変更 (およびその他のダイアログ ボックス、アイコンの変更 ダイアログ ボックスを直接呼び出すこと) によって自動的に呼び出される、ユーザーによって要求されたときに、アイコンの表示側面を有効にします。

##  <a name="setextent"></a>  COleClientItem::SetExtent

OLE 項目を使用可能領域の量を指定するには、この関数を呼び出します。

```
void SetExtent(
    const CSize& size,
    DVASPECT nDrawAspect = DVASPECT_CONTENT);
```

### <a name="parameters"></a>パラメーター

*size*<br/>
A [CSize](../../atl-mfc-shared/reference/csize-class.md)サイズ情報を含むオブジェクト。

*nDrawAspect*<br/>
境界を設定する OLE アイテムの外観を指定します。 使用可能な値は、[外観](#setdrawaspect)を参照してください。

### <a name="remarks"></a>Remarks

これにより、サーバー アプリケーション、Microsoft Foundation Class ライブラリを使用して記述されていますが場合、 [OnSetExtent](../../mfc/reference/coleserveritem-class.md#onsetextent)メンバー関数は、対応する`COleServerItem`呼び出されるオブジェクト。 OLE 項目は、その表示を適宜調整することができますし。 寸法、ディメンションがあります。 ユーザーが OLE 項目をサイズ変更時に、または何らかの形式のレイアウトのネゴシエーションをサポートしている場合は、この関数を呼び出します。

詳細については、次を参照してください。 [IOleObject::SetExtent](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-setextent) Windows SDK に含まれています。

##  <a name="sethostnames"></a>  COleClientItem::SetHostNames

コンテナー アプリケーションの名前と埋め込み OLE アイテムのコンテナーの名前を指定するには、この関数を呼び出します。

```
void SetHostNames(
    LPCTSTR lpszHost,
    LPCTSTR lpszHostObj);
```

### <a name="parameters"></a>パラメーター

*lpszHost*<br/>
コンテナー アプリケーションのユーザーに表示される名前へのポインター。

*lpszHostObj*<br/>
OLE 項目を含むコンテナーの識別文字列へのポインター。

### <a name="remarks"></a>Remarks

サーバー アプリケーション、Microsoft Foundation Class ライブラリを使用して記述されていますが場合、この関数は、[されていると](../../mfc/reference/coleserverdoc-class.md#onsethostnames)のメンバー関数、 `COleServerDoc` OLE 項目を含むドキュメント。 この情報は、OLE 項目を編集するときに、ウィンドウのタイトルに使用されます。 コンテナーのドキュメントが読み込まれるたびに、フレームワークは、ドキュメント内のすべての OLE 項目のこの関数を呼び出します。 `SetHostNames` 埋め込みアイテムにのみ適用されます。 編集用 OLE 埋め込みアイテムがアクティブになるたびにこの関数を呼び出す必要はありません。

これとも呼ばれます自動的にドキュメント名とアプリケーションの名前でオブジェクトが読み込まれるときに、または別の名前でファイルを保存するとします。 したがって、この関数を直接呼び出す通常必要はありません。

詳細については、次を参照してください。 [IOleObject::SetHostNames](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-sethostnames) Windows SDK に含まれています。

##  <a name="seticonicmetafile"></a>  COleClientItem::SetIconicMetafile

項目のアイコンを描画するために使われるメタファイルをキャッシュします。

```
BOOL SetIconicMetafile(HGLOBAL hMetaPict);
```

### <a name="parameters"></a>パラメーター

*hMetaPict*<br/>
項目のアイコンを描画するために使われるメタファイルのハンドル。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

使用[GetIconicMetafile](#geticonicmetafile)メタファイルを取得します。

*HMetaPict*アイテムにパラメーターのコピーは、そのため、 *hMetaPict*呼び出し元によって解放する必要があります。

##  <a name="setitemrects"></a>  COleClientItem::SetItemRects

外接する四角形または OLE 項目の表示の四角形を設定するには、この関数を呼び出します。

```
BOOL SetItemRects(
    LPCRECT lpPosRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>パラメーター

*lprcPosRect*<br/>
クライアント座標で、その親ウィンドウを基準とした OLE 項目の境界を含む四角形を指すポインター。

*lprcClipRect*<br/>
クライアント座標で、その親ウィンドウを基準とした OLE 項目の表示部分の境界を含む四角形を指すポインター。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

この関数の既定の実装によって、 [:onchangeitemposition](#onchangeitemposition)メンバー関数。 位置または OLE の表示部分の項目の変更されるたびに、この関数を呼び出す必要があります。 ビューから呼び出すことは、通常これは意味[OnSize](../../mfc/reference/cwnd-class.md#onsize)と[OnScrollBy](../../mfc/reference/cview-class.md#onscrollby)メンバー関数。

詳細については、次を参照してください。 [IOleInPlaceObject::SetObjectRects](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects) Windows SDK に含まれています。

##  <a name="setlinkupdateoptions"></a>  COleClientItem::SetLinkUpdateOptions

指定したリンク アイテムの表示のリンクの更新オプションを設定するには、この関数を呼び出します。

```
void SetLinkUpdateOptions(OLEUPDATE dwUpdateOpt);
```

### <a name="parameters"></a>パラメーター

*dwUpdateOpt*<br/>
この項目のリンクの更新オプションの値。 この値は、次のいずれかである必要があります。

- OLEUPDATE_ALWAYS では、可能な場合は、リンクされた項目を更新します。 このオプションは、リンク ダイアログ ボックスで、リンクの自動更新のオプション ボタンをサポートします。

- OLEUPDATE_ONCALL コンテナー アプリケーションからの要求でのみリンクされた項目の更新 (ときに、 [UpdateLink](#updatelink)メンバー関数が呼び出されます)。 このオプションは、リンク ダイアログ ボックスで、リンクの手動更新オプション ボタンをサポートします。

### <a name="remarks"></a>Remarks

通常、リンク ダイアログ ボックスでユーザーが選択した更新オプションを変更する必要がありますできません。

詳細については、次を参照してください。 [IOleLink::SetUpdateOptions](/windows/desktop/api/oleidl/nf-oleidl-iolelink-setupdateoptions) Windows SDK に含まれています。

##  <a name="setprintdevice"></a>  COleClientItem::SetPrintDevice

この項目の出力先のデバイスを変更するには、この関数を呼び出します。

```
BOOL SetPrintDevice(const DVTARGETDEVICE* ptd);
BOOL SetPrintDevice(const PRINTDLG* ppd);
```

### <a name="parameters"></a>パラメーター

*ptd*<br/>
ポインターを[DVTARGETDEVICE](/windows/desktop/api/objidl/ns-objidl-tagdvtargetdevice)データ構造は、新しい印刷対象デバイスに関する情報が含まれます。 NULL にすることができます。

*ppd*<br/>
ポインターを[PRINTDLG](https://msdn.microsoft.com/library/windows/desktop/ms646940)データ構造は、新しい印刷対象デバイスに関する情報が含まれます。 NULL にすることができます。

### <a name="return-value"></a>戻り値

関数が成功した場合、0 以外の場合それ以外の場合 0 を返します。

### <a name="remarks"></a>Remarks

この関数は、項目の出力先のデバイスの更新が、プレゼンテーションのキャッシュは更新しません。 アイテムのプレゼンテーションのキャッシュを更新するには、呼び出す[UpdateLink](#updatelink)します。

この関数の引数には、OLE システムがターゲット デバイスを識別するために使用する情報が含まれています。 `PRINTDLG`構造体には、一般的な印刷 ダイアログ ボックスを初期化するために Windows を使用する情報が含まれます。 ユーザーがダイアログ ボックスを閉じた後、Windows はこの構造体で、ユーザーの選択に関する情報を返します。 `m_pd`のメンバー、 [CPrintDialog](../../mfc/reference/cprintdialog-class.md)オブジェクトが、`PRINTDLG`構造体。

この構造体の詳細については、次を参照してください。 [PRINTDLG](/windows/desktop/api/commdlg/ns-commdlg-tagpda) Windows SDK に含まれています。

詳細については、次を参照してください。 [DVTARGETDEVICE](/windows/desktop/api/objidl/ns-objidl-tagdvtargetdevice) Windows SDK に含まれています。

##  <a name="updatelink"></a>  COleClientItem::UpdateLink

OLE 項目のプレゼンテーション データをすぐに更新するには、この関数を呼び出します。

```
BOOL UpdateLink();
```

### <a name="return-value"></a>戻り値

正常に完了した場合はゼロ以外、それ以外の場合は 0 です。

### <a name="remarks"></a>Remarks

リンクされた項目は、関数は OLE 項目の新しいプレゼンテーションを取得するリンクのソースを検索します。 このプロセスは、時間のかかるである可能性がある、1 つまたは複数のサーバー アプリケーションを実行する必要があります。 埋め込みアイテムは、関数は再帰的に、埋め込み項目が期限切れになる可能性があるリンクを含むかどうかを確認し、更新することは動作します。 ユーザーは、リンク ダイアログ ボックスを使用して個々 のリンクを手動で更新できます。

詳細については、次を参照してください。 [IOleLink::Update](/windows/desktop/api/oleidl/nf-oleidl-iolelink-update) Windows SDK に含まれています。

## <a name="see-also"></a>関連項目

[MFC サンプル MFCBIND](../../overview/visual-cpp-samples.md)<br/>
[MFC サンプルの OCLIENT](../../overview/visual-cpp-samples.md)<br/>
[CDocItem クラス](../../mfc/reference/cdocitem-class.md)<br/>
[階層図](../../mfc/hierarchy-chart.md)<br/>
[COleServerItem クラス](../../mfc/reference/coleserveritem-class.md)
