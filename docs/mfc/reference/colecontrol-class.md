---
title: COleControl クラス
ms.date: 08/27/2018
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
ms.openlocfilehash: 30d73d546ee68a25f1e59776020477d038da65e8
ms.sourcegitcommit: 5cecccba0a96c1b4ccea1f7a1cfd91f259cc5bde
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/01/2019
ms.locfileid: "58771501"
---
# <a name="colecontrol-class"></a>COleControl クラス

OLE コントロールを開発するための強力な基底クラスです。

## <a name="syntax"></a>構文

```
class COleControl : public CWnd
```

## <a name="members"></a>メンバー

### <a name="public-constructors"></a>パブリック コンストラクター

|名前|説明|
|----------|-----------------|
|[COleControl::COleControl](#colecontrol)|`COleControl` オブジェクトを作成します。|

### <a name="public-methods"></a>パブリック メソッド

|名前|説明|
|----------|-----------------|
|[COleControl::AmbientAppearance](#ambientappearance)|コントロールの現在の外観を取得します。|
|[COleControl::AmbientBackColor](#ambientbackcolor)|アンビエント BackColor プロパティの値を返します。|
|[COleControl::AmbientDisplayName](#ambientdisplayname)|コンテナーで指定されたコントロールの名前を返します。|
|[COleControl::AmbientFont](#ambientfont)|アンビエントのフォント プロパティの値を返します。|
|[COleControl::AmbientForeColor](#ambientforecolor)|アンビエント前景色プロパティの値を返します。|
|[COleControl::AmbientLocaleID](#ambientlocaleid)|コンテナーのロケール ID を返します。|
|[COleControl::AmbientScaleUnits](#ambientscaleunits)|コンテナーで使用されるユニットの種類を返します。|
|[COleControl::AmbientShowGrabHandles](#ambientshowgrabhandles)|グラブ ハンドルを表示するかどうかを決定します。|
|[COleControl::AmbientShowHatching](#ambientshowhatching)|陰影を表示するかどうかを決定します。|
|[COleControl::AmbientTextAlign](#ambienttextalign)|コンテナーで指定されたテキストの配置の型を返します。|
|[COleControl::AmbientUIDead](#ambientuidead)|かどうか、コントロールは、ユーザー インターフェイスの動作に応答する必要がありますを決定します。|
|[COleControl::AmbientUserMode](#ambientusermode)|コンテナーのモードを決定します。|
|[COleControl::BoundPropertyChanged](#boundpropertychanged)|バインドされたプロパティが変更されたことをコンテナーに通知します。|
|[COleControl::BoundPropertyRequestEdit](#boundpropertyrequestedit)|プロパティの値を編集するアクセス許可を要求します。|
|[COleControl::ClientToParent](#clienttoparent)|コントロールのコンテナーの原点から点を原点に変換します。|
|[COleControl::ClipCaretRect](#clipcaretrect)|コントロールによって、重なっている場合は、キャレットの四角形を調整します。|
|[COleControl::ControlInfoChanged](#controlinfochanged)|コントロールによって処理されるニーモニックのセットが変更された後は、この関数を呼び出します。|
|[COleControl::DisplayError](#displayerror)|コントロールのユーザーには、ストックのエラー イベントを表示します。|
|[COleControl::DoClick](#doclick)|ストックの実装`DoClick`メソッド。|
|[COleControl::DoPropExchange](#dopropexchange)|プロパティをシリアル化、`COleControl`オブジェクト。|
|[COleControl::DoSuperclassPaint](#dosuperclasspaint)|Windows のコントロールからサブクラスに指定された OLE コントロールを再描画します。|
|[COleControl::EnableSimpleFrame](#enablesimpleframe)|コントロールのシンプルなフレームのサポートを有効にします。|
|[COleControl::ExchangeExtent](#exchangeextent)|コントロールの幅と高さをシリアル化します。|
|[COleControl::ExchangeStockProps](#exchangestockprops)|コントロールのストック プロパティをシリアル化します。|
|[COleControl::ExchangeVersion](#exchangeversion)|コントロールのバージョン番号をシリアル化します。|
|[COleControl::FireClick](#fireclick)|素材が発生した`Click`イベント。|
|[COleControl::FireDblClick](#firedblclick)|素材が発生した`DblClick`イベント。|
|[COleControl::FireError](#fireerror)|素材が発生した`Error`イベント。|
|[COleControl::FireEvent](#fireevent)|カスタム イベントが発生します。|
|[COleControl::FireKeyDown](#firekeydown)|素材が発生した`KeyDown`イベント。|
|[COleControl::FireKeyPress](#firekeypress)|素材が発生した`KeyPress`イベント。|
|[COleControl::FireKeyUp](#firekeyup)|素材が発生した`KeyUp`イベント。|
|[COleControl::FireMouseDown](#firemousedown)|素材が発生した`MouseDown`イベント。|
|[COleControl::FireMouseMove](#firemousemove)|素材が発生した`MouseMove`イベント。|
|[COleControl::FireMouseUp](#firemouseup)|素材が発生した`MouseUp`イベント。|
|[COleControl::FireReadyStateChange](#firereadystatechange)|コントロールの準備完了状態が変更されたときにイベントを発生させます。|
|[COleControl::GetActivationPolicy](#getactivationpolicy)|サポートするコントロールの既定のアクティブ化の動作を変更、`IPointerInactive`インターフェイス。|
|[COleControl::GetAmbientProperty](#getambientproperty)|指定されたアンビエント プロパティの値を返します。|
|[COleControl::GetAppearance](#getappearance)|ストックの外観プロパティの値を返します。|
|[COleControl::GetBackColor](#getbackcolor)|ストックの BackColor プロパティの値を返します。|
|[COleControl::GetBorderStyle](#getborderstyle)|ストック BorderStyle プロパティの値を返します。|
|[COleControl::GetCapture](#getcapture)|アクティブなウィンドウなしコントロール オブジェクトがマウス キャプチャを持つかどうかを判断します。|
|[COleControl::GetClassID](#getclassid)|コントロールの OLE クラス ID を取得します。|
|[COleControl::GetClientOffset](#getclientoffset)|コントロールの四角形領域の左上隅にあると、クライアント領域の左上隅にある間の差を取得します。|
|[COleControl::GetClientRect](#getclientrect)|コントロールのクライアント領域のサイズを取得します。|
|[COleControl::GetClientSite](#getclientsite)|コンテナー内の現在のクライアント サイトへのポインターのオブジェクトを照会します。|
|[COleControl::GetControlFlags](#getcontrolflags)|コントロール フラグの設定を取得します。|
|[COleControl::GetControlSize](#getcontrolsize)|OLE コントロールのサイズと位置を返します。|
|[COleControl::GetDC](#getdc)|ウィンドウなしのコントロールがコンテナーからのデバイス コンテキストを取得するための手段を提供します。|
|[COleControl::GetEnabled](#getenabled)|株式の Enabled プロパティの値を返します。|
|[COleControl::GetExtendedControl](#getextendedcontrol)|コンテナーに属する拡張コントロール オブジェクトへのポインターを取得します。|
|[COleControl::GetFocus](#getfocus)|コントロールにフォーカスがあるかどうかを判断します。|
|[COleControl::GetFont](#getfont)|ストック フォント プロパティの値を返します。|
|[COleControl::GetFontTextMetrics](#getfonttextmetrics)|メトリックを返します、`CFontHolder`オブジェクト。|
|[COleControl::GetForeColor](#getforecolor)|ストックの前景色プロパティの値を返します。|
|[COleControl::GetHwnd](#gethwnd)|HWnd のストック プロパティの値を返します。|
|[COleControl::GetMessageString](#getmessagestring)|メニュー項目のステータス バーのテキストを提供します。|
|[COleControl::GetNotSupported](#getnotsupported)|ユーザーがコントロールのプロパティの値にアクセスできなくなります。|
|[COleControl::GetReadyState](#getreadystate)|コントロールの準備状態を返します。|
|[COleControl::GetRectInContainer](#getrectincontainer)|コンテナーを基準として、コントロールの四角形を返します。|
|[COleControl::GetStockTextMetrics](#getstocktextmetrics)|ストック フォント プロパティのメトリックを返します。|
|[COleControl::GetText](#gettext)|テキストまたはキャプションのストック プロパティの値を返します。|
|[COleControl::GetWindowlessDropTarget](#getwindowlessdroptarget)|ウィンドウなしのコントロールをドラッグのターゲットにして、ドロップ操作をオーバーライドします。|
|[COleControl::InitializeIIDs](#initializeiids)|コントロールが使用する Iid の基本クラスを通知します。|
|[COleControl::InternalGetFont](#internalgetfont)|返します、`CFontHolder`ストック フォント プロパティのオブジェクト。|
|[COleControl::InternalGetText](#internalgettext)|ストックのキャプションまたはテキストのプロパティを取得します。|
|[COleControl::InternalSetReadyState](#internalsetreadystate)|コントロールの準備状態を設定し、準備完了状態変更イベントが発生します。|
|[COleControl::InvalidateControl](#invalidatecontrol)|再描画され、表示されているコントロールの領域を無効にします。|
|[COleControl::InvalidateRgn](#invalidatergn)|特定のリージョン内のコンテナーのウィンドウのクライアント領域を無効にします。 ウィンドウなしのコントロールが再描画領域で使用できます。|
|[COleControl::IsConvertingVBX](#isconvertingvbx)|OLE コントロールの特別な読み込みを許可します。|
|[COleControl::IsModified](#ismodified)|コントロールの状態が変更されたかどうかを決定します。|
|[COleControl::IsOptimizedDraw](#isoptimizeddraw)|コンテナーが現在の描画操作の最適化された描画をサポートするかどうかを示します。|
|[COleControl::IsSubclassedControl](#issubclassedcontrol)|かどうか、Windows コントロールをサブクラス化制御を判断するには、呼び出されます。|
|[COleControl::Load](#load)|以前の非同期データをリセットし、コントロールの非同期のプロパティの新しい読み込みを開始します。|
|[COleControl::LockInPlaceActive](#lockinplaceactive)|かどうか、コントロールがコンテナーによって非アクティブ化できるかを決定します。|
|[COleControl::OnAmbientPropertyChange](#onambientpropertychange)|アンビエント プロパティが変更されたときに呼び出されます。|
|[COleControl::OnAppearanceChanged](#onappearancechanged)|ストックの外観プロパティが変更されたときに呼び出されます。|
|[COleControl::OnBackColorChanged](#onbackcolorchanged)|ストックの BackColor プロパティが変更されたときに呼び出されます。|
|[COleControl::OnBorderStyleChanged](#onborderstylechanged)|ストック BorderStyle プロパティが変更されたときに呼び出されます。|
|[COleControl::OnClick](#onclick)|在庫をクリックしてを起動すると呼ばれるイベント。|
|[COleControl::OnClose](#onclose)|コントロールに通知する`IOleControl::Close`が呼び出されました。|
|[COleControl::OnDoVerb](#ondoverb)|コントロールの動詞が実行された後に呼び出されます。|
|[COleControl::OnDraw](#ondraw)|自動的に再描画するコントロールが要求されたときに呼び出されます。|
|[COleControl::OnDrawMetafile](#ondrawmetafile)|メタファイル デバイス コンテキストを使用して自身を再描画するコントロールが要求されたときに、コンテナーによって呼び出されます。|
|[COleControl::OnEdit](#onedit)|OLE コントロールの UI がアクティブ化するコンテナーによって呼び出されます。|
|[COleControl::OnEnabledChanged](#onenabledchanged)|在庫の Enabled プロパティが変更されたときに呼び出されます。|
|[COleControl::OnEnumVerbs](#onenumverbs)|コントロールの動詞を列挙するために、コンテナーによって呼び出されます。|
|[COleControl::OnEventAdvise](#oneventadvise)|イベント ハンドラーが接続されているまたはコントロールから切断されているときに呼び出されます。|
|[COleControl::OnFontChanged](#onfontchanged)|ストック フォント プロパティが変更されたときに呼び出されます。|
|[COleControl::OnForeColorChanged](#onforecolorchanged)|ストックの前景色プロパティが変更されたときに呼び出されます。|
|[COleControl::OnFreezeEvents](#onfreezeevents)|コントロールのイベントが固定されているまたはマスクされていないときに呼び出されます。|
|[COleControl::OnGetColorSet](#ongetcolorset)|コントロールに通知する`IOleObject::GetColorSet`が呼び出されました。|
|[COleControl::OnGetControlInfo](#ongetcontrolinfo)|コンテナーにニーモニックの情報を提供します。|
|[COleControl::OnGetDisplayString](#ongetdisplaystring)|プロパティ値を表す文字列を取得するには、呼び出されます。|
|[COleControl::OnGetInPlaceMenu](#ongetinplacemenu)|コンテナーのメニューにマージされるコントロールのメニューのハンドルを要求します。|
|[COleControl::OnGetNaturalExtent](#ongetnaturalextent)|オーバーライドすると、提案されたサイズと拡張モードに最も近いコントロールの表示のサイズを取得します。|
|[COleControl::OnGetPredefinedStrings](#ongetpredefinedstrings)|プロパティの使用可能な値を表す文字列を返します。|
|[COleControl::OnGetPredefinedValue](#ongetpredefinedvalue)|定義済みの文字列に対応する値を返します。|
|[COleControl::OnGetViewExtent](#ongetviewextent)|オーバーライドすると、(2 パスの描画を有効にするを使用できます)、コントロールの表示領域のサイズを取得します。|
|[COleControl::OnGetViewRect](#ongetviewrect)|コントロールのサイズを特定の位置以降にある四角形に変換をオーバーライドします。|
|[COleControl::OnGetViewStatus](#ongetviewstatus)|オーバーライドすると、コントロールのビュー状態を取得します。|
|[COleControl::OnHideToolBars](#onhidetoolbars)|コントロールが UI で非アクティブのときに、コンテナーによって呼び出されます。|
|[COleControl::OnInactiveMouseMove](#oninactivemousemove)|コントロールにマウス ポインターのディスパッチ WM_MOUSEMOVE メッセージ 非アクティブなコントロールのコンテナーを持つをオーバーライドします。|
|[COleControl::OnInactiveSetCursor](#oninactivesetcursor)|コントロールにマウス ポインターのディスパッチ WM_SETCURSOR メッセージ 非アクティブなコントロールのコンテナーを持つをオーバーライドします。|
|[COleControl::OnKeyDownEvent](#onkeydownevent)|ストックの KeyDown イベントが発生した後に呼び出されます。|
|[COleControl::OnKeyPressEvent](#onkeypressevent)|株価 KeyPress イベントが発生した後に呼び出されます。|
|[COleControl::OnKeyUpEvent](#onkeyupevent)|ストックの KeyUp イベントが発生した後に呼び出されます。|
|[COleControl::OnMapPropertyToPage](#onmappropertytopage)|プロパティの編集に使用するプロパティ ページを示します。|
|[COleControl::OnMnemonic](#onmnemonic)|コントロールのニーモニック キーが押されたときに呼び出されます。|
|[COleControl::OnProperties](#onproperties)|コントロールの"Properties"動詞が呼び出されたときに呼び出されます。|
|[COleControl::OnQueryHitPoint](#onqueryhitpoint)|コントロールの表示には特定の時点が重なっているかどうかは、クエリをオーバーライドします。|
|[COleControl::OnQueryHitRect](#onqueryhitrect)|コントロールの表示には任意の時点で指定した四角形が重なっているかどうかは、クエリをオーバーライドします。|
|[COleControl::OnRenderData](#onrenderdata)|指定された形式でデータを取得するためにフレームワークによって呼び出されます。|
|[COleControl::OnRenderFileData](#onrenderfiledata)|指定した形式でファイルからデータを取得するためにフレームワークによって呼び出されます。|
|[COleControl::OnRenderGlobalData](#onrenderglobaldata)|指定された形式でのグローバル メモリからデータを取得するためにフレームワークによって呼び出されます。|
|[COleControl::OnResetState](#onresetstate)|コントロールのプロパティを既定値にリセットします。|
|[COleControl::OnSetClientSite](#onsetclientsite)|コントロールに通知する`IOleControl::SetClientSite`が呼び出されました。|
|[COleControl::OnSetData](#onsetdata)|コントロールのデータを別の値に置き換えます。|
|[COleControl::OnSetExtent](#onsetextent)|コントロールの範囲が変更された後に呼び出されます。|
|[COleControl::OnSetObjectRects](#onsetobjectrects)|コントロールのサイズが変更された後に呼び出されます。|
|[COleControl::OnShowToolBars](#onshowtoolbars)|コントロールの UI がアクティブになったときに呼び出されます。|
|[COleControl::OnTextChanged](#ontextchanged)|在庫テキストまたはキャプション プロパティが変更されたときに呼び出されます。|
|[COleControl::OnWindowlessMessage](#onwindowlessmessage)|ウィンドウなしのコントロール (マウスとキーボード メッセージ) 以外のウィンドウ メッセージを処理します。|
|[COleControl::ParentToClient](#parenttoclient)|コントロールの原点のポイントには、コンテナーの原点に変換します。|
|[COleControl::PostModalDialog](#postmodaldialog)|モーダル ダイアログ ボックスが閉じられたことをコンテナーに通知します。|
|[COleControl::PreModalDialog](#premodaldialog)|モーダル ダイアログ ボックスが表示されるコンテナーに通知します。|
|[COleControl::RecreateControlWindow](#recreatecontrolwindow)|破棄し、コントロールのウィンドウを再作成します。|
|[COleControl::Refresh](#refresh)|強制的にコントロールの外観の再描画をします。|
|[COleControl::ReleaseCapture](#releasecapture)|マウスのキャプチャを解放します。|
|[COleControl::ReleaseDC](#releasedc)|ウィンドウなしのコントロールのコンテナーのディスプレイ デバイス コンテキストを解放します。|
|[COleControl::ReparentControlWindow](#reparentcontrolwindow)|コントロール ウィンドウの親をリセットします。|
|[COleControl::ResetStockProps](#resetstockprops)|初期化します`COleControl`ストック プロパティを既定値。|
|[COleControl::ResetVersion](#resetversion)|特定の値にバージョン番号を初期化します。|
|[COleControl::ScrollWindow](#scrollwindow)|により、表示、インプレース アクティブ イメージ内の領域をスクロール ウィンドウなしのコントロールできます。|
|[COleControl::SelectFontObject](#selectfontobject)|デバイス コンテキストには、カスタムのフォント プロパティを選択します。|
|[COleControl::SelectStockFont](#selectstockfont)|デバイス コンテキストには、ストック フォント プロパティを選択します。|
|[COleControl::SerializeExtent](#serializeextent)|シリアル化またはコントロールの表示領域を初期化します。|
|[COleControl::SerializeStockProps](#serializestockprops)|シリアル化または初期化、`COleControl`ストック プロパティ。|
|[COleControl::SerializeVersion](#serializeversion)|シリアル化またはコントロールのバージョン情報を初期化します。|
|[COleControl::SetAppearance](#setappearance)|ストックの外観プロパティの値を設定します。|
|[COleControl::SetBackColor](#setbackcolor)|ストックの BackColor プロパティの値を設定します。|
|[COleControl::SetBorderStyle](#setborderstyle)|ストック BorderStyle プロパティの値を設定します。|
|[COleControl::SetCapture](#setcapture)|コントロールの代わりに、マウス キャプチャを所有しているを実行するコントロールのコンテナーのウィンドウをによりします。|
|[COleControl::SetControlSize](#setcontrolsize)|OLE コントロールのサイズと位置を設定します。|
|[COleControl::SetEnabled](#setenabled)|株式の Enabled プロパティの値を設定します。|
|[COleControl::SetFocus](#setfocus)|コントロールの代わりに入力フォーカスを所有しているを実行するコントロールのコンテナーのウィンドウをによりします。|
|[COleControl::SetFont](#setfont)|ストック フォント プロパティの値を設定します。|
|[COleControl::SetForeColor](#setforecolor)|ストックの前景色プロパティの値を設定します。|
|[COleControl::SetInitialSize](#setinitialsize)|コンテナーで最初に表示されるときの OLE コントロールのサイズを設定します。|
|[COleControl::SetModifiedFlag](#setmodifiedflag)|コントロールの変更の状態を変更します。|
|[COleControl::SetNotPermitted](#setnotpermitted)|編集要求が失敗したことを示します。|
|[COleControl::SetNotSupported](#setnotsupported)|ユーザーがコントロールのプロパティの値を変更できないようにします。|
|[COleControl::SetRectInContainer](#setrectincontainer)|コンテナーを基準として、コントロールの四角形を設定します。|
|[COleControl::SetText](#settext)|テキストまたはキャプションのストック プロパティの値を設定します。|
|[COleControl::ThrowError](#throwerror)|OLE コントロールでエラーが発生したことを通知します。|
|[COleControl::TransformCoords](#transformcoords)|変換では、コンテナーとコントロールの間の値を調整します。|
|[COleControl::TranslateColor](#translatecolor)|COLORREF 値、OLE_COLOR 値に変換します。|
|[COleControl::WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|かどうかアンビエントできるプロパティは、次回、コントロールが読み込まれるを決定します。|
|[COleControl::WindowProc](#windowproc)|Windows の手順を説明する`COleControl`オブジェクト。|

### <a name="protected-methods"></a>プロテクト メソッド

|名前|説明|
|----------|-----------------|
|[COleControl::DrawContent](#drawcontent)|コントロールの外観を更新する必要がある場合に、フレームワークによって呼び出されます。|
|[COleControl::DrawMetafile](#drawmetafile)|メタファイル デバイス コンテキストを使用しているときに、フレームワークによって呼び出されます。|
|[COleControl::IsInvokeAllowed](#isinvokeallowed)|オートメーション メソッドの呼び出しを有効にします。|
|[COleControl::SetInitialDataFormats](#setinitialdataformats)|コントロールによってサポートされるデータ形式のリストを初期化するためにフレームワークによって呼び出されます。|

## <a name="remarks"></a>Remarks

派生した`CWnd`、このクラスは、Windows のウィンドウ オブジェクトのすべての機能、およびイベントの発生からメソッドとプロパティをサポートする機能などの ole に固有の追加機能を継承します。

OLE コントロールは、OLE コンテナー アプリケーションを挿入し、イベントの発生と公開するメソッドおよびプロパティをコンテナーの双方向のシステムを使用して、コンテナーと通信します。 標準の OLE コンテナーでは OLE コントロールの基本機能のみをサポートに注意してください。 OLE コントロールの拡張機能をサポートするためにできていません。 イベントの発生からでは、コントロールで発生している特定のアクションの結果として、コンテナーにイベントが送信されるときに発生します。 さらに、コンテナーは、公開されているメソッドとプロパティのメンバー関数に似ていますのセットと、C++ クラスのデータ メンバーを使用して、コントロールと通信します。 このアプローチは、開発者は、コントロールの外観を制御し、特定のアクションが発生した場合、コンテナーに通知できます。

## <a name="windowless-controls"></a>ウィンドウなしのコントロール

OLE コントロールはウィンドウなしに使用される、インプレース アクティブにできます。 ウィンドウなしのコントロールには、利点があります。

- ウィンドウなしのコントロールが透過的かつ四角形以外にすることができます。

- ウィンドウなしのコントロールは、オブジェクトのインスタンス サイズと作成の時間を短縮します。

コントロールでは、ウィンドウは必要ありません。 ウィンドウが提供するサービスは、1 つの共有ウィンドウ (通常は、コンテナーの) と少しのディスパッチのコードを使用して簡単に提供できます。 ウィンドウは、ほとんどの場合、オブジェクトで不必要に複雑です。

ウィンドウなしのアクティベーションを使用すると、コンテナー (これには、ウィンドウが) は、コントロールのウィンドウで提供されてそれ以外の場合はサービスを提供する責任を負います。 たとえばをコントロールがキーボード フォーカスを照会、マウスのキャプチャのクエリ、またはデバイス コンテキストを取得する必要がある場合は、これらの操作がコンテナーによって管理されます。 `COleControl`操作ウィンドウなしのメンバー関数は、コンテナーでこれらの操作を呼び出します。

コンテナーのデリゲートをコントロールのメッセージの入力ウィンドウなしのアクティベーションを有効にすると、`IOleInPlaceObjectWindowless`インターフェイス (拡張機能の[IOleInPlaceObject](/windows/desktop/api/oleidl/nn-oleidl-ioleinplaceobject)ウィンドウなしのサポート)。 `COleControl`このインターフェイスの実装は、マウスの調整を適切に調整した後、コントロールのメッセージ マップを通じてこれらのメッセージはディスパッチします。 通常のウィンドウのメッセージと同様に、これらのメッセージを処理するには、メッセージ マップに対応するエントリを追加します。

ウィンドウなしのコントロールでは、常に使用して、`COleControl`メンバー関数、対応するのではなく`CWnd`メンバー関数またはその関連する Windows API 関数。

OLE コントロール オブジェクトは、ウィンドウをアクティブになったが、非アクティブ/アクティブの移行に必要な作業量が上がるし、移行の速度がダウンした場合にのみ作成もできます。 この問題が発生する場合: たとえば、テキスト ボックスのグリッドを検討してください。 ときに列をカーソルを上下、各コントロールがあります、インプレース アクティブ化され、非アクティブ化します。 非アクティブ/アクティブの移行の速度は、スクロール速度に直接影響します。

OLE の制御フレームワークの開発に関する詳細については、記事をご覧ください。 [MFC ActiveX コントロール](../../mfc/mfc-activex-controls.md)と[概要。MFC ActiveX コントロール プログラムを作成する](../../mfc/reference/mfc-activex-control-wizard.md)します。 OLE コントロール、およびちらつきなしのコントロールなどの最適化については、次を参照してください。 [MFC ActiveX コントロール。最適化](../../mfc/mfc-activex-controls-optimization.md)します。

## <a name="inheritance-hierarchy"></a>継承階層

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`COleControl`

## <a name="requirements"></a>必要条件

**ヘッダー:** afxctl.h

##  <a name="ambientbackcolor"></a>  COleControl::AmbientBackColor

アンビエント BackColor プロパティの値を返します。

```
OLE_COLOR AmbientBackColor();
```

### <a name="return-value"></a>戻り値

コンテナーのアンビエント背景色をプロパティ、存在する場合の現在の値。 プロパティがサポートされていない場合、この関数は、Windows の背景のシステム定義色を返します。

### <a name="remarks"></a>Remarks

アンビエント BackColor プロパティは、すべてのコントロールに使用可能なコンテナーによって定義されます。 このプロパティをサポートするために、コンテナーが必要ないことに注意してください。

##  <a name="ambientdisplayname"></a>  COleControl::AmbientDisplayName

コンテナーがコントロールに割り当てられている名前は、ユーザーに表示されるエラー メッセージで使用できます。

```
CString AmbientDisplayName();
```

### <a name="return-value"></a>戻り値

OLE コントロールの名前。 既定では長さ 0 の文字列です。

### <a name="remarks"></a>Remarks

このプロパティをサポートするために、コンテナーが必要ないことに注意してください。

##  <a name="ambientfont"></a>  COleControl::AmbientFont

アンビエントのフォント プロパティの値を返します。

```
LPFONTDISP AmbientFont();
```

### <a name="return-value"></a>戻り値

コンテナーのアンビエント フォント ディスパッチ インターフェイスへのポインター。 既定値は、NULL です。 呼び出すことによって、フォントを解放する戻り値が null と等しくない場合は、その[:release](/windows/desktop/api/unknwn/nf-unknwn-iunknown-release)メンバー関数。

### <a name="remarks"></a>Remarks

アンビエント フォント プロパティは、コンテナーによって定義されたすべてのコントロールに使用できます。このプロパティをサポートするために、コンテナーが必要ないことに注意してください。

##  <a name="ambientforecolor"></a>  COleControl::AmbientForeColor

アンビエント前景色プロパティの値を返します。

```
OLE_COLOR AmbientForeColor();
```

### <a name="return-value"></a>戻り値

コンテナーのアンビエント前景色プロパティ、存在する場合の現在の値。 サポートされていない場合、この関数は、Windows のテキストのシステム定義色を返します。

### <a name="remarks"></a>Remarks

アンビエント前景色プロパティは、すべてのコントロールに使用可能なコンテナーによって定義されます。 このプロパティをサポートするために、コンテナーが必要ないことに注意してください。

##  <a name="ambientlocaleid"></a>  COleControl::AmbientLocaleID

コンテナーのロケール ID を返します。

```
LCID AmbientLocaleID();
```

### <a name="return-value"></a>戻り値

存在する場合に、コンテナーの LocaleID プロパティの値。 このプロパティがサポートされていない場合、この関数は 0 を返します。

### <a name="remarks"></a>Remarks

コントロールは、特定のロケールのユーザー インターフェイスを調整するのにロケール Id を使用できます。 このプロパティをサポートするために、コンテナーが必要ないことに注意してください。

##  <a name="ambientappearance"></a>  COleControl::AmbientAppearance

コントロール オブジェクトの現在の外観の設定を取得します。

```
short AmbientAppearance();
```

### <a name="return-value"></a>戻り値

コントロールの外観。

- **0**外観がフラット

- **1** 3D の外観

### <a name="remarks"></a>Remarks

コントロールを示すプロパティの現在の値を取得するには、この関数を呼び出します。

##  <a name="ambientscaleunits"></a>  COleControl::AmbientScaleUnits

コンテナーで使用されるユニットの種類を返します。

```
CString AmbientScaleUnits();
```

### <a name="return-value"></a>戻り値

コンテナーのアンビエント ScaleUnits を含む文字列。 このプロパティがサポートされていない場合、この関数は長さ 0 の文字列を返します。

### <a name="remarks"></a>Remarks

位置または twip かセンチメートルなど、選択された単位ラベルが付いたディメンションを表示するコンテナーのアンビエント ScaleUnits プロパティを使用できます。 このプロパティをサポートするために、コンテナーが必要ないことに注意してください。

##  <a name="ambientshowgrabhandles"></a>  COleControl::AmbientShowGrabHandles

コンテナーがアクティブなときにハンドルを表示するコントロールをできるかどうかを判断します。

```
BOOL AmbientShowGrabHandles();
```

### <a name="return-value"></a>戻り値

グラブ ハンドルを表示する場合は 0 以外それ以外の場合 0 を返します。 このプロパティがサポートされていない場合、この関数が 0 以外の場合に返します。

### <a name="remarks"></a>Remarks

このプロパティをサポートするために、コンテナーが必要ないことに注意してください。

##  <a name="ambientshowhatching"></a>  COleControl::AmbientShowHatching

コンテナーが自体のハッチを表示するコントロールを許可するかどうかを決定場合に、パターン UI がアクティブな。

```
BOOL AmbientShowHatching();
```

### <a name="return-value"></a>戻り値

ハッチ パターンを表示する場合は 0 以外それ以外の場合 0 を返します。 このプロパティがサポートされていない場合、この関数が 0 以外の場合に返します。

### <a name="remarks"></a>Remarks

このプロパティをサポートするために、コンテナーが必要ないことに注意してください。

##  <a name="ambienttextalign"></a>  COleControl::AmbientTextAlign

コントロールのコンテナーで優先されるアンビエント テキストの配置を決定します。

```
short AmbientTextAlign();
```

### <a name="return-value"></a>戻り値

コンテナーのアンビエント プロパティの状態。 このプロパティがサポートされていない場合、この関数は 0 を返します。

有効な戻り値の一覧を次には。

|戻り値|説明|
|------------------|-------------|
|0|[全般] (数値、テキストを左に) の配置。|
|1|左揃え|
|2|中央揃え|
|3|右揃え|

### <a name="remarks"></a>Remarks

このプロパティは、埋め込まれたすべてのコントロールに使用可能なコンテナーによって定義されます。 このプロパティをサポートするために、コンテナーが必要ないことに注意してください。

##  <a name="ambientuidead"></a>  COleControl::AmbientUIDead

コンテナーが、コントロール ユーザー インターフェイスの操作に応答する必要があるかどうかを決定します。

```
BOOL AmbientUIDead();
```

### <a name="return-value"></a>戻り値

以外の場合は、コントロールがユーザー インターフェイスの動作に応答する必要があります。それ以外の場合 0 を返します。 このプロパティがサポートされていない場合、この関数は 0 を返します。

### <a name="remarks"></a>Remarks

たとえば、コンテナーが設定をデザイン モードで TRUE にします。

##  <a name="ambientusermode"></a>  COleControl::AmbientUserMode

コンテナーがデザイン モードまたはユーザー モードを決定します。

```
BOOL AmbientUserMode();
```

### <a name="return-value"></a>戻り値

コンテナーがユーザー モードである場合は 0 以外(デザイン モード) の場合は 0 を返します。 このプロパティがサポートされていない場合、この関数は TRUE を返します。

### <a name="remarks"></a>Remarks

たとえば、コンテナーが設定をデザイン モードで FALSE にします。

##  <a name="boundpropertychanged"></a>  COleControl::BoundPropertyChanged

バインドされたプロパティ値が変更されたことを通知します。

```
void BoundPropertyChanged(DISPID dispid);
```

### <a name="parameters"></a>パラメーター

*dispid*<br/>
コントロールのバインド プロパティのディスパッチ ID。

### <a name="remarks"></a>Remarks

これは、変更をしないプロパティを通じて行われた場合でも、プロパティの変更の値は、メソッドを設定するたびに呼び出す必要があります。 メンバー変数にマップされているバインドされたプロパティに特に注意します。 このようなメンバー、変数の変更をいつ`BoundPropertyChanged`呼び出す必要があります。

##  <a name="boundpropertyrequestedit"></a>  COleControl::BoundPropertyRequestEdit

アクセス許可を要求、`IPropertyNotifySink`コントロールによって提供されるバインドされたプロパティ値を変更するインターフェイス。

```
BOOL BoundPropertyRequestEdit(DISPID dispid);
```

### <a name="parameters"></a>パラメーター

*dispid*<br/>
コントロールのバインド プロパティのディスパッチ ID。

### <a name="return-value"></a>戻り値

変更は許可されている場合は 0 以外それ以外の場合 0 を返します。 既定値は 0 以外の値です。

### <a name="remarks"></a>Remarks

アクセス許可が拒否された場合、コントロールする必要がありますプロパティの変更の値が、できません。 これは、大文字かどうか、プロパティ値を変更しようとする操作の失敗によって実行できます。

##  <a name="clienttoparent"></a>  COleControl::ClientToParent

座標を変換*pPoint*に親の座標。

```
virtual void ClientToParent(
    LPCRECT lprcBounds,
    LPPOINT pPoint) const;
```

### <a name="parameters"></a>パラメーター

*lprcBounds*<br/>
コンテナー内の OLE コントロールの境界へのポインター。 クライアント領域ではありませんが、領域の境界線とスクロール バーを含むコントロール全体。

*pPoint*<br/>
親 (コンテナー) の座標に変換する OLE クライアント領域のポイントへのポインター。

### <a name="remarks"></a>Remarks

入力に*pPoint* (コントロールのクライアント領域の左上隅) の OLE コントロールのクライアント領域の原点に対する相対パスです。 出力で*pPoint*親 (コンテナーの左上隅) の配信元に対する相対パスです。

##  <a name="clipcaretrect"></a>  COleControl::ClipCaretRect

完全または部分的にカバーされて不透明オブジェクトによって場合は、キャレットの四角形を調整します。

```
BOOL ClipCaretRect(LPRECT lpRect);
```

### <a name="parameters"></a>パラメーター

*lpRect*<br/>
入力へのポインターを[RECT](/windows/desktop/api/windef/ns-windef-tagrect)調整されるカレット領域を含む構造体。 調整済みのキャレットの領域を出力します。 または、キャレットの四角形が完全に網羅されている場合は NULL。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

キャレットは、点滅行、ブロック、またはを通常のテキストまたはグラフィックを挿入する位置を示すビットマップです。

ウィンドウなしのオブジェクトが最初に確認キャレットを安全に表示できないかどうか、部分的または全体的にカレットがオブジェクトを重複しています。 考えられるようにするために、オブジェクトを使用して`ClipCaretRect`カレットを調整する (減少) クリッピング領域に適合するようにします。

キャレットを作成するオブジェクトは、キャレットの四角形を送信する必要があります`ClipCaretRect`キャレットの調整済みの四角形を使用します。 かどうか、まったくカレットが、このメソッドは FALSE を返します、カレットを表示しないすべてのここでします。

##  <a name="colecontrol"></a>  COleControl::COleControl

`COleControl` オブジェクトを構築します。

```
COleControl();
```

### <a name="remarks"></a>Remarks

この関数は直接呼び出される通常はありません。 代わりに OLE コントロールは通常、そのクラスのファクトリによって作成します。

##  <a name="controlinfochanged"></a>  COleControl::ControlInfoChanged

コントロールでサポートされているニーモニックのセットが変更されたときに、この関数を呼び出します。

```
void ControlInfoChanged();
```

### <a name="remarks"></a>Remarks

この通知を受信すると、コントロールのコンテナーは、呼び出すことによってニーモニックの新しいセットを取得します[IOleControl::GetControlInfo](/windows/desktop/api/ocidl/nf-ocidl-iolecontrol-getcontrolinfo)します。 この通知に応答する、コンテナーが必要ないことに注意してください。

##  <a name="displayerror"></a>  COleControl::DisplayError

(イベント ハンドラーは、エラーの表示を抑制が) しない限り、株価のエラー イベントが処理された後に、フレームワークによって呼び出されます。

```
virtual void DisplayError(
    SCODE scode,
    LPCTSTR lpszDescription,
    LPCTSTR lpszSource,
    LPCTSTR lpszHelpFile,
    UINT nHelpID);
```

### <a name="parameters"></a>パラメーター

*scode*<br/>
報告されるステータス コード値。 可能なコードの完全な一覧は、記事を参照してください。 [ActiveX コントロール。トピックを advanced](../../mfc/mfc-activex-controls-advanced-topics.md)します。

*lpszDescription*<br/>
報告されるエラーの説明です。

*lpszSource*<br/>
エラー (通常は、OLE コントロール モジュールの名前) を生成するモジュールの名前。

*lpszHelpFile*<br/>
エラーの説明を含むヘルプ ファイルの名前。

*nHelpID*<br/>
報告されるエラーのヘルプ コンテキスト ID。

### <a name="remarks"></a>Remarks

既定の動作に含まれている、エラーの説明を含むメッセージ ボックスが表示されます。 *lpszDescription*します。

エラーの表示方法をカスタマイズするには、この関数をオーバーライドします。

##  <a name="doclick"></a>  COleControl::DoClick

マウスをシミュレートするコントロールに対するアクションをクリックします。

```
void DoClick();
```

### <a name="remarks"></a>Remarks

オーバーライド可能な`COleControl::OnClick`メンバー関数を呼び出す、および在庫コントロールによってサポートされている場合、イベントが発生されます をクリックします。

この関数はサポート、`COleControl`という DoClick ストック メソッドとして基本クラス。 詳細については、この記事を参照してください。 [ActiveX コントロール。メソッド](../../mfc/mfc-activex-controls-methods.md)します。

##  <a name="dopropexchange"></a>  COleControl::DoPropExchange

読み込みや、ストリーム、またはプロパティのセットなどの永続的なストレージ表現からのコントロールを格納するときにフレームワークによって呼び出されます。

```
virtual void DoPropExchange(CPropExchange* pPX);
```

### <a name="parameters"></a>パラメーター

*pPX*<br/>
`CPropExchange` オブジェクトへのポインター。 フレームワークは、方向など、プロパティの exchange のコンテキストを確立するには、このオブジェクトを提供します。

### <a name="remarks"></a>Remarks

この関数での呼び出しは通常、 **px _** ファミリの読み込みまたは OLE コントロールの特定のユーザー定義プロパティを格納する関数。

OLE コントロール プロジェクトを作成するコントロールのウィザードを使用して、この関数のオーバーライドされたバージョンがシリアル化でサポートされているストック プロパティ`COleControl`基底クラスの関数を呼び出して`COleControl::DoPropExchange`します。 OLE コントロールにユーザー定義のプロパティを追加すると、新しいプロパティをシリアル化するには、この関数を変更する必要があります。 シリアル化の詳細については、記事を参照してください。 [ActiveX コントロール。シリアル化する](../../mfc/mfc-activex-controls-serializing.md)します。

##  <a name="dosuperclasspaint"></a>  COleControl::DoSuperclassPaint

Windows のコントロールからサブクラスに指定された OLE コントロールを再描画します。

```
void DoSuperclassPaint(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
コントロールのコンテナーのデバイス コンテキストへのポインター。

*rcBounds*<br/>
コントロールが描画される領域。

### <a name="remarks"></a>Remarks

アクティブでない OLE コントロールの描画を適切に処理するには、この関数を呼び出します。 この関数は、OLE コントロールでは、Windows コントロールをサブクラス化と呼び出す必要がある場合にのみ使用する必要があります、`OnDraw`コントロールの関数。

この関数は、Windows コントロールをサブクラス化する方法の詳細については、記事を参照してください。 [ActiveX コントロール。Windows コントロールをサブクラス化](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md)します。

##  <a name="drawcontent"></a>  COleControl::DrawContent

コントロールの外観を更新する必要がある場合に、フレームワークによって呼び出されます。

```
void DrawContent(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
デバイス コンテキストへのポインター。

*rc*<br/>
描画する四角形領域。

### <a name="remarks"></a>Remarks

この関数を直接呼び出す、オーバーライド可能な`OnDraw`関数。

##  <a name="drawmetafile"></a>  COleControl::DrawMetafile

メタファイル デバイス コンテキストを使用しているときに、フレームワークによって呼び出されます。

```
void DrawMetafile(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
メタファイル デバイス コンテキストへのポインター。

*rc*<br/>
描画する四角形領域。

##  <a name="enablesimpleframe"></a>  COleControl::EnableSimpleFrame

OLE コントロールのシンプルなフレームの特性を有効にします。

```
void EnableSimpleFrame();
```

### <a name="remarks"></a>Remarks

このような特性では、他のコントロールのビジュアルのコンテインメントが true でない OLE 包含をサポートするためにコントロールできるようにします。 例をいくつかのコントロール内でのグループ ボックスとなります。 これらのコントロールが含まれている場合、OLE ではありませんが、同じグループ ボックスでは。

##  <a name="exchangeextent"></a>  COleControl::ExchangeExtent

シリアル化またはコントロールの範囲 (HIMETRIC 単位でのサイズ) の状態を初期化します。

```
BOOL ExchangeExtent(CPropExchange* pPX);
```

### <a name="parameters"></a>パラメーター

*pPX*<br/>
ポインターを[CPropExchange](../../mfc/reference/cpropexchange-class.md)オブジェクト。 フレームワークは、方向など、プロパティの exchange のコンテキストを確立するには、このオブジェクトを提供します。

### <a name="return-value"></a>戻り値

関数が成功した場合、0 以外の場合それ以外の場合は 0 です。

### <a name="remarks"></a>Remarks

この関数は通常の既定の実装によって呼び出されます。`COleControl::DoPropExchange`します。

##  <a name="exchangestockprops"></a>  COleControl::ExchangeStockProps

シリアル化またはコントロールのストック プロパティの状態を初期化します。

```
void ExchangeStockProps(CPropExchange* pPX);
```

### <a name="parameters"></a>パラメーター

*pPX*<br/>
ポインターを[CPropExchange](../../mfc/reference/cpropexchange-class.md)オブジェクト。 フレームワークは、方向など、プロパティの exchange のコンテキストを確立するには、このオブジェクトを提供します。

### <a name="remarks"></a>Remarks

この関数は通常の既定の実装によって呼び出されます。`COleControl::DoPropExchange`します。

##  <a name="exchangeversion"></a>  COleControl::ExchangeVersion

シリアル化またはコントロールのバージョン情報の状態を初期化します。

```
BOOL ExchangeVersion(
    CPropExchange* pPX,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>パラメーター

*pPX*<br/>
`CPropExchange` オブジェクトへのポインター。 フレームワークは、方向など、プロパティの exchange のコンテキストを確立するには、このオブジェクトを提供します。

*dwVersionDefault*<br/>
コントロールの現在のバージョン番号。

*bConvert*<br/>
永続的なデータを保存すると、または読み込まれているのと同じ形式で保持される場合は、最新の形式に変換する必要があるかどうかを示します。

### <a name="return-value"></a>戻り値

成功した関数の 0 以外の場合それ以外の場合は 0 です。

### <a name="remarks"></a>Remarks

一般に、コントロールのオーバーライドによって呼び出される最初の関数には`COleControl::DoPropExchange`します。 この関数は、永続的なデータのバージョン番号を読み取るしの version 属性を設定を読み込むときに、 [CPropExchange](../../mfc/reference/cpropexchange-class.md)適宜オブジェクトします。 保存すると、この関数は、永続的なデータのバージョン番号を書き込みます。

永続化とバージョン管理する方法の詳細については、記事を参照してください。 [ActiveX コントロール。シリアル化する](../../mfc/mfc-activex-controls-serializing.md)します。

##  <a name="fireclick"></a>  COleControl::FireClick

アクティブなコントロール上でマウスがクリックされたときに、フレームワークによって呼び出されます。

```
void FireClick();
```

### <a name="remarks"></a>Remarks

このイベントは、カスタム イベントとして定義される場合は、イベントが発生したときに決定します。

クリック イベントが発生する自動発生させるには、コントロールのイベント マップの株をクリックして必要がありますイベントを定義します。

##  <a name="firedblclick"></a>  COleControl::FireDblClick

アクティブなコントロール上にマウスがダブルクリックされたときに、フレームワークによって呼び出されます。

```
void FireDblClick();
```

### <a name="remarks"></a>Remarks

このイベントは、カスタム イベントとして定義される場合は、イベントが発生したときに決定します。

発生する離す自動発生させるには、コントロールのイベントのマップを行うには定義されているストック離す必要があります。

##  <a name="fireerror"></a>  COleControl::FireError

ストックのエラー イベントが発生します。

```
void FireError(
    SCODE scode,
    LPCTSTR lpszDescription,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>パラメーター

*scode*<br/>
報告されるステータス コード値。 可能なコードの完全な一覧は、記事を参照してください。 [ActiveX コントロール。トピックを advanced](../../mfc/mfc-activex-controls-advanced-topics.md)します。

*lpszDescription*<br/>
報告されるエラーの説明です。

*nHelpID*<br/>
報告されるエラーのヘルプ ID。

### <a name="remarks"></a>Remarks

このイベントは、コントロール内でエラーが発生したことをコードで、適切な場所で通知する方法を提供します。 をクリックまたは MouseMove などの他のストック イベントとは異なり、フレームワークによってエラーが発生しません。

プロパティの get 関数、プロパティ セット関数、またはオートメーション メソッドの中に発生するエラーを報告するには、呼び出す[COleControl::ThrowError](#throwerror)します。

OLE コントロールの株式のエラー イベントの実装では、SCODE 値を使用します。 場合は、コントロールは、このイベントを使用し、4.0 の Visual Basic で使用するものでは、Visual Basic では、SCODE 値はサポートされていないためにエラーを受け取ります。

これを解決するには、コントロールの SCODE パラメーターを手動で変更します。ODL ファイルを**長い**します。 さらに、任意のカスタム イベント、メソッド、または SCODE パラメーターを使用するプロパティも、同じ問題が発生します。

##  <a name="fireevent"></a>  COleControl::FireEvent

コントロールからの省略可能な引数は、任意の数、ユーザー定義のイベントが発生します。

```
void AFX_CDECL FireEvent(
    DISPID dispid,
    BYTE* pbParams,
...);
```

### <a name="parameters"></a>パラメーター

*dispid*<br/>
発生するイベントのディスパッチ ID。

*pbParams*<br/>
イベントのパラメーターの型の記述子。

### <a name="remarks"></a>Remarks

通常、この関数が直接呼び出されませんする必要があります。 代わりには、コントロールのクラス宣言のイベントのマップのセクションでは、イベント発生関数を呼び出します。

*PbParams*引数は、スペースで区切られたリストの**vts _** します。 スペース (コンマではない) で区切られるこれらの値の 1 つ以上は、関数のパラメーター リストを指定します。 次の値を指定できます。

|シンボル|パラメーターの型|
|------------|--------------------|
|VTS_COLOR|OLE_COLOR|
|VTS_FONT|`IFontDisp*`|
|VTS_HANDLE|HWND|
|VTS_PICTURE|`IPictureDisp*`|
|VTS_OPTEXCLUSIVE|OLE_OPTEXCLUSIVE *|
|VTS_TRISTATE|OLE_TRISTATE|
|VTS_XPOS_HIMETRIC|OLE_XPOS_HIMETRIC|
|VTS_YPOS_HIMETRIC|OLE_YPOS_HIMETRIC|
|VTS_XPOS_PIXELS|OLE_XPOS_PIXELS|
|VTS_YPOS_PIXELS|OLE_YPOS_PIXELS|
|VTS_XSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_YSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_XSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|
|VTS_YSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|

> [!NOTE]
>  追加のバリアント型定数は、すべてのバリアント型を除く VTS_FONT と VTS_PICTURE、variant データ定数へのポインターを提供する定義されています。 使用してこれらの定数の名前は、**付け**`constantname`規則。 たとえば、VTS_PCOLOR、VTS_COLOR 定数ポインターです。

##  <a name="firekeydown"></a>  COleControl::FireKeyDown

コントロールの UI のアクティブなときに、キーが押されたときに、フレームワークによって呼び出されます。

```
void FireKeyDown(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>パラメーター

*pnChar*<br/>
押されたキーの仮想キー コード値へのポインター。 標準の仮想キー コードの一覧は、Winuser.h を参照してください。

*nShiftState*<br/>
次のフラグの組み合わせが含まれます。

- 操作中に SHIFT_MASK、SHIFT キーが押されました。

- 操作中に CTRL_MASK、CTRL キーが押されました。

- 操作中に ALT_MASK、ALT キーが押されました。

### <a name="remarks"></a>Remarks

このイベントは、カスタム イベントとして定義される場合は、イベントが発生したときに決定します。

KeyDown イベントが発生する自動発生させるには、コントロールのイベントのマップに株価の KeyDown イベントが定義されている必要があります。

##  <a name="firekeypress"></a>  COleControl::FireKeyPress

キーを押したときし、コンテナー内でカスタム コントロールの UI のアクティブなときにリリースされたときに、フレームワークによって呼び出されます。

```
void FireKeyPress(USHORT* pnChar);
```

### <a name="parameters"></a>パラメーター

*pnChar*<br/>
押されたキーの文字の値へのポインター。

### <a name="remarks"></a>Remarks

このイベントは、カスタム イベントとして定義される場合は、イベントが発生したときに決定します。

イベントの受信者を変更*pnChar*、たとえば、すべての小文字を大文字に変換します。 変更された文字を確認する場合は、オーバーライド`OnKeyPressEvent`します。

KeyPress イベントが発生する自動発生させるには、コントロールのイベントのマップに株価の KeyPress イベントが定義されている必要があります。

##  <a name="firekeyup"></a>  COleControl::FireKeyUp

コンテナー内でカスタム コントロールの UI のアクティブなときに、キーが離されたときに、フレームワークによって呼び出されます。

```
void FireKeyUp(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>パラメーター

*pnChar*<br/>
リリースのキーの仮想キー コード値へのポインター。 標準の仮想キー コードの一覧は、Winuser.h を参照してください。

*nShiftState*<br/>
次のフラグの組み合わせが含まれます。

- 操作中に SHIFT_MASK、SHIFT キーが押されました。

- 操作中に CTRL_MASK、CTRL キーが押されました。

- 操作中に ALT_MASK、ALT キーが押されました。

### <a name="remarks"></a>Remarks

このイベントは、カスタム イベントとして定義される場合は、イベントが発生したときに決定します。

KeyUp イベントが発生する自動発生させるには、コントロールのイベント マップ ストック KeyUp イベントが定義されている必要があります。

##  <a name="firemousedown"></a>  COleControl::FireMouseDown

アクティブなカスタム コントロール上でマウス ボタンが押されたときに、フレームワークによって呼び出されます。

```
void FireMouseDown(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>パラメーター

*n ボタン*<br/>
押されたマウス ボタンの数値。 次の値のいずれかを含めることができます。

- LEFT_BUTTON マウスの左ボタンが押されています。

- MIDDLE_BUTTON マウスの中央ボタンが押されています。

- RIGHT_BUTTON マウスの右ボタンが押されています。

*nShiftState*<br/>
次のフラグの組み合わせが含まれます。

- 操作中に SHIFT_MASK、SHIFT キーが押されました。

- 操作中に CTRL_MASK、CTRL キーが押されました。

- 操作中に ALT_MASK、ALT キーが押されました。

*x*<br/>
マウス ボタンが押されたときに、カーソルの x 座標。 座標は、コントロール ウィンドウの左上隅に対して相対的です。

*y*<br/>
マウス ボタンが押されたときに、カーソルの y 座標。 座標は、コントロール ウィンドウの左上隅に対して相対的です。

### <a name="remarks"></a>Remarks

このイベントは、カスタム イベントとして定義される場合は、イベントが発生したときに決定します。

MouseDown イベントが発生する自動発生させるには、コントロールのイベント マップ ストック MouseDown イベントが定義されている必要があります。

##  <a name="firemousemove"></a>  COleControl::FireMouseMove

アクティブなカスタム コントロール上でカーソルが移動したときに、フレームワークによって呼び出されます。

```
void FireMouseMove(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>パラメーター

*n ボタン*<br/>
押されたマウス ボタンの数値。 次の値の組み合わせが含まれます。

- 操作中に、ダウン LEFT_BUTTON マウスの左ボタンが押されました。

- 操作中に、ダウン MIDDLE_BUTTON マウスの中央ボタンが押されました。

- 操作中に、ダウン RIGHT_BUTTON マウスの右ボタンが押されました。

*nShiftState*<br/>
次のフラグの組み合わせが含まれます。

- 操作中に SHIFT_MASK、SHIFT キーが押されました。

- 操作中に CTRL_MASK、CTRL キーが押されました。

- 操作中に ALT_MASK、ALT キーが押されました。

*x*<br/>
カーソルの x 座標。 座標は、コントロール ウィンドウの左上隅に対して相対的です。

*y*<br/>
カーソルの y 座標。 座標は、コントロール ウィンドウの左上隅に対して相対的です。

### <a name="remarks"></a>Remarks

このイベントは、カスタム イベントとして定義される場合は、イベントが発生したときに決定します。

MouseMove イベントが発生する自動発生させるには、コントロールのイベントのマップを行うには株式 MouseMove イベントが定義されている必要があります。

##  <a name="firemouseup"></a>  COleControl::FireMouseUp

アクティブなカスタム コントロール上でマウス ボタンが離されたときに、フレームワークによって呼び出されます。

```
void FireMouseUp(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>パラメーター

*n ボタン*<br/>
マウス ボタンが解放されたの数値。 次の値のいずれかのことができます。

- マウスの左ボタンが離された LEFT_BUTTON します。

- マウスの中央ボタンが離された MIDDLE_BUTTON します。

- マウスの右ボタンが離された RIGHT_BUTTON します。

*nShiftState*<br/>
次のフラグの組み合わせが含まれます。

- 操作中に SHIFT_MASK、SHIFT キーが押されました。

- 操作中に CTRL_MASK、CTRL キーが押されました。

- 操作中に ALT_MASK、ALT キーが押されました。

*x*<br/>
マウス ボタンが離されたときのカーソルの x 座標。 座標は、コントロール ウィンドウの左上隅に対して相対的です。

*y*<br/>
マウス ボタンが離されたときのカーソルの y 座標。 座標は、コントロール ウィンドウの左上隅に対して相対的です。

### <a name="remarks"></a>Remarks

このイベントは、カスタム イベントとして定義される場合は、イベントが発生したときに決定します。

MouseUp イベントが発生する自動発生させるには、コントロールのイベント マップ ストック MouseUp イベントが定義されている必要があります。

##  <a name="firereadystatechange"></a>  COleControl::FireReadyStateChange

コントロールの準備完了状態の現在の値を持つイベントを発生させます。

```
void FireReadyStateChange();
```

### <a name="remarks"></a>Remarks

準備完了状態には、次の値のいずれかを指定できます。

|||
|-|-|
|READYSTATE_UNINITIALIZED|既定の初期化状態|
|READYSTATE_LOADING|コントロールがそのプロパティを現在読み込んでください。|
|READYSTATE_LOADED|コントロールが初期化されています。|
|READYSTATE_INTERACTIVE|コントロールが対話型にするための十分なデータが、非同期データがまだ読み込まれています。|
|READYSTATE_COMPLETE|コントロールがそのすべてのデータ|

使用[GetReadyState](#getreadystate)コントロールの現在の対応状況を判断します。

[InternalSetReadyState](#internalsetreadystate)準備完了状態を指定した値に変更し、呼び出す`FireReadyStateChange`します。

##  <a name="getactivationpolicy"></a>  COleControl::GetActivationPolicy

サポートするコントロールの既定のアクティブ化の動作を変更、`IPointerInactive`インターフェイス。

```
virtual DWORD GetActivationPolicy();
```

### <a name="return-value"></a>戻り値

POINTERINACTIVE 列挙フラグの組み合わせ。 使用できるフラグは次のとおりです。

|||
|-|-|
|POINTERINACTIVE_ACTIVATEONENTRY|オブジェクトには、インプレース、マウスがマウスの移動操作中になったときにアクティブ化される必要があります。|
|POINTERINACTIVE_DEACTIVATEONLEAVE|オブジェクトは、マウスの移動操作中に、オブジェクトからマウスが離れるときに、非アクティブ化する必要があります。|
|POINTERINACTIVE_ACTIVATEONDRAG|オブジェクトは、インプレース アクティブ化されますドラッグ中に上にマウスをドラッグするアンド ドロップ操作する必要があります。|

### <a name="remarks"></a>Remarks

ときに、`IPointerInactive`インターフェイスが有効になっている、コンテナーは、WM_SETCURSOR および WM_MOUSEMOVE メッセージを委任します。 `COleControl`このインターフェイスの実装は、マウスの調整を適切に調整した後、コントロールのメッセージ マップを通じてこれらのメッセージはディスパッチします。

コンテナーが、非アクティブなオブジェクトをサポート経由でマウス ポインターを WM_SETCURSOR か WM_MOUSEMOVE メッセージを受信するたびに`IPointerInactive`を呼び出す必要がある`GetActivationPolicy`インターフェイスと POINTERINACTIVE 列挙体からの戻り値のフラグ。

通常のウィンドウのメッセージと同様、これらのメッセージを処理するには、メッセージ マップに対応するエントリを追加します。 ハンドラーでは、使用しないように、`m_hWnd`メンバー変数 (またはそれを使用する任意のメンバー関数) 最初にその値が NULL 以外であることを確認します。

任意のオブジェクトは複数のマウス カーソルを設定またはなど、マウス移動イベントを起動するためのものは現在特別な視覚的フィードバック、POINTERINACTIVE_ACTIVATEONENTRY フラグを返す、およびアクティブな場合にのみ、フィードバックを描画する必要があります。 コンテナーが埋め込み先ですぐにアクティブ化しへの呼び出しをトリガーしたのと同じメッセージを転送場合は、オブジェクトは、このフラグを返します、`GetActivationPolicy`します。

POINTERINACTIVE_ACTIVATEONENTRY と POINTERINACTIVE_DEACTIVATEONLEAVE の両方のフラグが返された場合、オブジェクトの上にマウスとし、オブジェクトはアクティブのみです。 POINTERINACTIVE_ACTIVATEONENTRY フラグが返されます、のみの場合と、マウスが最初に、オブジェクトに入るときとし、オブジェクトはアクティブのみ。

OLE のドラッグのターゲットにして、ドロップ操作の非アクティブなコントロールをすることもできます。 これは、コントロールのウィンドウは、ドロップ先として登録できるように、ユーザーがそれにオブジェクトをドラッグする時点でコントロールをアクティブ化する必要があります。 ドラッグ中に発生するアクティブ化には、POINTERINACTIVE_ACTIVATEONDRAG フラグが返されます。

[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]

によって、情報がやり取りされる`GetActivationPolicy`コンテナーによってキャッシュされないようにする必要があります。 代わりに、マウスが非アクティブなオブジェクトを入力するたびに、このメソッドを呼び出す必要があります。

コンテナーが呼び出すことによってこのオブジェクトを後続の WM_SETCURSOR メッセージをディスパッチする必要がありますか所で、マウスで入力したときにアクティブ化できるようにする非アクティブなオブジェクトを要求しない場合[OnInactiveSetCursor](#oninactivesetcursor)限りマウス ポインターオブジェクトの上に留まります。

有効にすると、`IPointerInactive`通常インターフェイスでは常にマウス メッセージの処理に対応しているコントロールをすることを意味します。 サポートされていないコンテナーにこの動作を取得する、`IPointerInactive`コントロールが常に表示される場合、アクティブにする必要があるインターフェイスでは、その他のフラグ間されてフラグがありますので、コントロール。 ただしからには、このフラグを防ぐために、コンテナー内の効果を取得はサポート`IPointerInactive`、OLEMISC_IGNOREACTIVATEWHENVISIBLE フラグを指定することもできます。

[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]

##  <a name="getambientproperty"></a>  COleControl::GetAmbientProperty

コンテナーのアンビエント プロパティの値を取得します。

```
BOOL GetAmbientProperty(
    DISPID dispid,
    VARTYPE vtProp,
    void* pvProp);
```

### <a name="parameters"></a>パラメーター

*dwDispid*<br/>
目的のアンビエント プロパティのディスパッチ ID。

*vtProp*<br/>
返される値の型を示すバリアント型タグ*pvProp*します。

*pvProp*<br/>
戻り値またはプロパティの値を受け取る変数のアドレスへのポインター。 このポインターの実際の型がで指定された型と一致する必要があります*vtProp*します。

|vtProp|PvProp の種類|
|------------|--------------------|
|VT_BOOL|`BOOL*`|
|VT_BSTR|`CString*`|
|VT_I2|`short*`|
|VT_I4|`long*`|
|VT_R4|`float*`|
|VT_R8|`double*`|
|VT_CY|`CY*`|
|VT_COLOR|`OLE_COLOR*`|
|VT_DISPATCH|`LPDISPATCH*`|
|VT_FONT|`LPFONTDISP*`|

### <a name="return-value"></a>戻り値

以外の場合は、アンビエント プロパティがサポートされています。それ以外の場合 0 を返します。

### <a name="remarks"></a>Remarks

使用する場合`GetAmbientProperty`アンビエント DisplayName と ScaleUnits プロパティを取得するには、次のように設定します。 *vtProp*を VT_BSTR と*pvProp*に`CString*`します。 アンビエントのフォント プロパティを取得する場合は、設定*vtProp* VT_FONT と*pvProp* LPFONTDISP * にします。

関数が既に用意されたことに共通のアンビエント プロパティのなどに注意してください。 [AmbientBackColor](#ambientbackcolor)と[AmbientFont](#ambientfont)します。

##  <a name="getappearance"></a>  COleControl::GetAppearance

コントロールの外観のストック プロパティの Get 機能を実装します。

```
short GetAppearance ();
```

### <a name="return-value"></a>戻り値

戻り値として現在の外観の設定を指定します、**短い**(VT_I2) 値、成功した場合。 コントロールの外観が 3D の場合、コントロールの外観がフラットと 1 の場合、この値が 0 です。

##  <a name="getbackcolor"></a>  COleControl::GetBackColor

コントロールの株価 BackColor プロパティの Get 機能を実装します。

```
OLE_COLOR GetBackColor();
```

### <a name="return-value"></a>戻り値

成功した場合、戻り値は、OLE_COLOR 値として現在の背景色を指定します。 この値への呼び出しで COLORREF 値に変換できる`TranslateColor`します。

##  <a name="getborderstyle"></a>  COleControl::GetBorderStyle

コントロールの株価 BorderStyle プロパティの Get 機能を実装します。

```
short GetBorderStyle();
```

### <a name="return-value"></a>戻り値

コントロールに通常の境界線がある場合は 1コントロールに境界線があるない場合は 0。

##  <a name="getcapture"></a>  COleControl::GetCapture

決定かどうか、`COleControl`マウス キャプチャを持つオブジェクト。

```
CWnd* GetCapture();
```

### <a name="return-value"></a>戻り値

コントロールがアクティブ化およびウィンドウなしの場合は、返す**この**コントロールが現在、マウス (コントロールのコンテナーによって決定) としてキャプチャ、またはキャプチャがあるない場合は NULL がかどうか。

それを返します、`CWnd`マウス キャプチャを持つオブジェクト (と同じ`CWnd::GetCapture`)。

### <a name="remarks"></a>Remarks

アクティブなウィンドウなしのコントロールがマウスを受け取るときにキャプチャ[SetCapture](#setcapture)が呼び出されます。

##  <a name="getclassid"></a>  COleControl::GetClassID

コントロールの OLE クラス ID を取得するためにフレームワークによって呼び出されます。

```
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;
```

### <a name="parameters"></a>パラメーター

*pclsid*<br/>
クラス ID の場所へのポインター

### <a name="return-value"></a>戻り値

呼び出しが成功した場合は 0 以外それ以外の場合 0 を返します。

### <a name="remarks"></a>Remarks

通常はによって実装される、 [IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex)します。

##  <a name="getclientoffset"></a>  COleControl::GetClientOffset

コントロールの四角形領域の左上隅にあると、クライアント領域の左上隅にある間の差を取得します。

```
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;
```

### <a name="parameters"></a>パラメーター

*pdxOffset*<br/>
OLE コントロールのクライアント領域の水平オフセットへのポインター。

*pdyOffset*<br/>
OLE コントロールのクライアント領域の垂直オフセットへのポインター。

### <a name="remarks"></a>Remarks

OLE コントロールには、そのコンテナー内の四角形の領域があります。 コントロールのクライアント領域は、境界線とスクロール バーを除くコントロール領域です。 オフセットを取得して`GetClientOffset`コントロールの四角形領域の左上隅にあると、クライアント領域の左上隅の違いです。 コントロールに標準的な境界線とスクロール バー以外の非クライアント要素がある場合は、オフセットを指定するには、このメンバー関数をオーバーライドします。

##  <a name="getclientrect"></a>  COleControl::GetClientRect

コントロールのクライアント領域のサイズを取得します。

```
virtual void GetClientRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>パラメーター

*lpRect*<br/>
ポインターを`RECT`ウィンドウなしのコントロールのクライアント領域の寸法を含む構造体。 つまり、ウィンドウの縁、フレーム、スクロール バー、およびにマイナスのコントロールのサイズ。 *LpRect*パラメーターがコントロールのクライアントの四角形の位置のサイズを示します。

##  <a name="getclientsite"></a>  COleControl::GetClientSite

コンテナー内の現在のクライアント サイトへのポインターのオブジェクトを照会します。

```
LPOLECLIENTSITE GetClientSite();
```

### <a name="return-value"></a>戻り値

そのコンテナー内で、コントロールの現在のクライアント サイトへのポインター。

### <a name="remarks"></a>Remarks

インスタンスに返されるポインターが指す`IOleClientSite`します。 `IOleClientSite` 、コンテナーによって実装されるインターフェイスは、そのコンテキストのオブジェクトのビュー: その記憶域、ユーザー インターフェイス、およびその他のリソースを取得、ドキュメントで固定されています。

##  <a name="getcontrolflags"></a>  COleControl::GetControlFlags

コントロール フラグの設定を取得します。

```
virtual DWORD GetControlFlags();
```

### <a name="return-value"></a>戻り値

ControlFlags 列挙体のフラグの論理和の組み合わせです。

```
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };
```

### <a name="remarks"></a>Remarks

既定では、`GetControlFlags`返します`fastBeginPaint | clipPaintDC`します。

|||
|-|-|
|`fastBeginPaint`|かどうか設定すると、関数を使用して begin ペイントに合わせた OLE コントロールの代わりに、 [BeginPaint](/windows/desktop/api/winuser/nf-winuser-beginpaint) API (既定で設定)。|
|`clipPaintDC`|設定されていない場合への呼び出しを無効にします`IntersectClipRect`によって行われた`COleControl`が処理速度を多少向上とします。 ウィンドウなしのアクティベーションを使用している場合、フラグの効力はありません。|
|`pointerInactive`|場合設定を有効にすると、コントロールがアクティブな間は、マウスとの対話を提供します`COleControl`の実装、`IPointerInactive`インターフェイスで、既定で無効にします。|
|`noFlickerActivate`|場合設定、余分な描画操作とちらつきがなくなります。 コントロールを非アクティブとアクティブ状態で同じ描画自体に使用します。 ウィンドウなしのアクティベーションを使用している場合、フラグの効力はありません。|
|`windowlessActivate`|場合設定、コントロール ウィンドウなしのアクティベーションを使用することを示します。|
|`canOptimizeDraw`|場合設定、コンテナーがサポートされている場合、コントロールが最適化された描画を実行することを示します。|

詳細については`GetControlFlags`OLE コントロールの他の最適化を参照してくださいと[ActiveX コントロール。最適化](../../mfc/mfc-activex-controls-optimization.md)します。

##  <a name="getcontrolsize"></a>  COleControl::GetControlSize

OLE コントロール ウィンドウのサイズを取得します。

```
void GetControlSize(
    int* pcx,
    int* pcy);
```

### <a name="parameters"></a>パラメーター

*pcx*<br/>
コントロールの幅をピクセル単位で指定します。

*pcy*<br/>
コントロールの高さをピクセル単位で指定します。

### <a name="remarks"></a>Remarks

Windows のコントロールのすべての座標は、コントロールの左上隅に対して相対的ことに注意してください。

##  <a name="getdc"></a>  COleControl::GetDC

コンテナーからウィンドウなしのオブジェクトの get 画面 (または互換性のある) デバイス コンテキストを提供します。

```
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```

### <a name="parameters"></a>パラメーター

*lprcRect*<br/>
四角形のウィンドウなしのコントロールへのポインターがコントロールのクライアント座標で再描画しようとするとします。 NULL では、オブジェクト全体を意味します。

*dwFlags*<br/>
デバイス コンテキストの属性を描画します。 選択肢があります。

- OLEDC_NODRAW では、オブジェクトは、だけでは、ディスプレイ デバイスに関する情報を取得する描画をすべて実行するデバイス コンテキストを使用しないことを示します。 コンテナーは、さらに処理することがなく、ウィンドウの DC を渡す必要がありますだけです。

- OLEDC_PAINTBKGND 要求は、コンテナーが DC を返す前に背景を描画します。 オブジェクトは、背景が透明な領域を再描画 DC を要求している場合、このフラグを使用する必要があります。

- オブジェクトを画面にコピーする必要がありますオフスクリーン ビットマップにレンダリングすることを希望するコンテナーを OLEDC_OFFSCREEN に通知します。 オブジェクトは、描画操作を実行しようとしているが、多くのちらつきを生成するときに、このフラグを使用する必要があります。 コンテナーは、自由にかこの要求が受け付けられます。 ただし、このフラグが設定されていない場合、コンテナーする必要があります手戻り、画面上の DC です。 これにより、選択範囲を表示するなどの直接画面操作を実行するオブジェクト (を使用して、 **XOR**操作)。

### <a name="return-value"></a>戻り値

コンテナーのディスプレイ デバイス コンテキストへのポインター`CWnd`クライアント領域かどうか成功、それ以外の戻り値は NULL です。 ディスプレイ デバイス コンテキストは、コンテナーのウィンドウのクライアント領域内に描画するために、後続の GDI 関数で使用できます。

### <a name="remarks"></a>Remarks

[ReleaseDC](#releasedc)描画後に、コンテキストを解放するメンバー関数を呼び出す必要があります。 呼び出すときに`GetDC`オブジェクトが、独自のクライアント座標に描画する四角形を渡します。 `GetDC` これらのコンテナーのクライアント領域の座標に変換します。 オブジェクトを要求する必要があります、必要な描画する四角形でのサイズを取得できます、独自のクライアント領域四角を超える[GetClientRect](#getclientrect)します。 これはオブジェクトが不用意に許可されていない場所に描画することを防ぎます。

##  <a name="getenabled"></a>  COleControl::GetEnabled

コントロールの在庫 Enabled プロパティの Get 機能を実装します。

```
BOOL GetEnabled();
```

### <a name="return-value"></a>戻り値

0 以外の場合は、コントロールが有効な場合それ以外の場合 0 を返します。

##  <a name="getextendedcontrol"></a>  COleControl::GetExtendedControl

拡張プロパティのセットを持つコントロールを表すコンテナーによって管理されるオブジェクトへのポインターを取得します。

```
LPDISPATCH GetExtendedControl();
```

### <a name="return-value"></a>戻り値

コンテナーへのポインターには、コントロール オブジェクトを拡張します。 オブジェクトがないの場合、値は NULL です。

このオブジェクトを使って操作がその`IDispatch`インターフェイス。 使用することも`QueryInterface`オブジェクトによって提供されるその他の使用可能なインターフェイスを取得します。 ただし、オブジェクトは、特定の一連のインターフェイスをサポートする必要はありません。 他の任意のコンテナー コントロールの移植性に制限するコンテナーの拡張コントロール オブジェクトの特定の機能に依存することに注意してください。

### <a name="remarks"></a>Remarks

この関数を呼び出す関数は、オブジェクトが終了したら、ポインターを解放する責任を負います。 このオブジェクトをサポートするために、コンテナーが必要ないことに注意してください。

##  <a name="getfocus"></a>  COleControl::GetFocus

決定かどうか、`COleControl`オブジェクトにフォーカスがあります。

```
CWnd* GetFocus();
```

### <a name="return-value"></a>戻り値

コントロールがアクティブ化およびウィンドウなしの場合は、返す**この**コントロールが現在キーボード フォーカス (によって決定されるコントロールのコンテナー) に、またはフォーカスがあるない場合は NULL がかどうか。

それを返します、`CWnd`フォーカスのあるオブジェクト (と同じ`CWnd::GetFocus`)。

### <a name="remarks"></a>Remarks

アクティブなウィンドウなしのコントロールがフォーカスを受け取るときに[SetFocus](#setfocus)が呼び出されます。

##  <a name="getfont"></a>  COleControl::GetFont

ストック フォント プロパティの Get 機能を実装します。

```
LPFONTDISP GetFont();
```

### <a name="return-value"></a>戻り値

コントロールのストック フォント プロパティのフォントのディスパッチ インターフェイスへのポインター。

### <a name="remarks"></a>Remarks

呼び出し元が完了すると、オブジェクトを解放する必要がありますに注意してください。 コントロールの実装内で使用して`InternalGetFont`コントロールのストックのフォント オブジェクトにアクセスします。 コントロールでのフォントの使用に関する詳細については、記事を参照してください。 [ActiveX コントロール。ActiveX コントロールのフォントを使用して](../../mfc/mfc-activex-controls-using-fonts.md)します。

##  <a name="getfonttextmetrics"></a>  COleControl::GetFontTextMetrics

いずれかのテキストのメトリックを測定`CFontHolder`コントロールが所有するオブジェクト。

```
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>パラメーター

*lptm*<br/>
ポインターを[受け取る](/windows/desktop/api/wingdi/ns-wingdi-tagtextmetrica)構造体。

*fontHolder*<br/>
参照を[CFontHolder](../../mfc/reference/cfontholder-class.md)オブジェクト。

### <a name="remarks"></a>Remarks

このようなフォントを選択できる、 [COleControl::SelectFontObject](#selectfontobject)関数。 `GetFontTextMetrics` 初期化は、`TEXTMETRIC`によって示される構造*lptm*の有効なメトリックについて`fontHolder`のフォントが成功した場合、または成功しなかった場合は 0 で構造体に格納します。 代わりに、この関数を使用する必要があります[GetTextMetrics](/windows/desktop/api/wingdi/nf-wingdi-gettextmetrics)メタファイルに描画するときに必要な埋め込み OLE オブジェクトなどのコントロールがあるので、コントロールを描画します。

`TEXTMETRIC`構造の既定のフォントは更新されたときに、 [SelectFontObject](#selectfontobject)関数が呼び出されます。 呼び出す必要があります`GetFontTextMetrics`が有効では提供情報を保証するために、ストック フォント プロパティを選択後にのみです。

##  <a name="getforecolor"></a>  COleControl::GetForeColor

ストックの前景色プロパティの Get 機能を実装します。

```
OLE_COLOR GetForeColor();
```

### <a name="return-value"></a>戻り値

成功した場合、戻り値は、OLE_COLOR 値として現在前景色を指定します。 この値に変換できる、 [COLORREF](/windows/desktop/gdi/colorref)への呼び出しで値`TranslateColor`します。

##  <a name="gethwnd"></a>  COleControl::GetHwnd

HWnd のストック プロパティの Get 関数を実装します。

```
OLE_HANDLE GetHwnd();
```

### <a name="return-value"></a>戻り値

OLE コントロールのウィンドウのハンドルが存在する場合それ以外の場合は NULL です。

##  <a name="getmessagestring"></a>  COleControl::GetMessageString

識別されるメニュー項目の目的を説明する短い文字列を取得するためにフレームワークによって呼び出される*nID*します。

```
virtual void GetMessageString(
    UINT nID,
    CString& rMessage) const;
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
メニュー項目の id。

*rMessage*<br/>
参照を[CString](../../atl-mfc-shared/reference/cstringt-class.md)文字列を返されるオブジェクトします。

### <a name="remarks"></a>Remarks

メニュー項目が強調表示された状態、ステータス バーに表示するメッセージを取得するために使用できます。 既定の実装で識別される文字列リソースを読み込もうと*nID*します。

##  <a name="getnotsupported"></a>  COleControl::GetNotSupported

ユーザーがコントロールのプロパティの値にアクセスできなくなります。

```
void GetNotSupported();
```

### <a name="remarks"></a>Remarks

コントロールのユーザーによってプロパティの取得はサポートされていない任意のプロパティの Get 関数の代わりに、この関数を呼び出します。 1 つの例には、書き込み専用であるプロパティがあります。

##  <a name="getreadystate"></a>  COleControl::GetReadyState

コントロールの準備状態を返します。

```
long GetReadyState();
```

### <a name="return-value"></a>戻り値

次の値のいずれかと、コントロールの準備状態:

|||
|-|-|
|READYSTATE_UNINITIALIZED|既定の初期化状態|
|READYSTATE_LOADING|コントロールがそのプロパティを現在読み込んでください。|
|READYSTATE_LOADED|コントロールが初期化されています。|
|READYSTATE_INTERACTIVE|コントロールが対話型にするための十分なデータが、非同期データがまだ読み込まれています。|
|READYSTATE_COMPLETE|コントロールがそのすべてのデータ|

### <a name="remarks"></a>Remarks

ほとんどの単純なコントロールは、LOADED および対話型を区別する必要はありません。 ただし、データ パスのプロパティをサポートするコントロールは、少なくとも一部のデータが非同期的に受信されるまでに対話形式にする準備ができていない可能性があります。 コントロールは必要があります、できるだけ早く対話型になるしようとしています。

##  <a name="getrectincontainer"></a>  COleControl::GetRectInContainer

デバイス単位で表される、コンテナーを基準として、コントロールの四角形の座標を取得します。

```
BOOL GetRectInContainer(LPRECT lpRect);
```

### <a name="parameters"></a>パラメーター

*lpRect*<br/>
コントロールの座標のコピー先の四角形構造体へのポインター。

### <a name="return-value"></a>戻り値

コントロールが、インプレース アクティブ; 場合は 0 以外。それ以外の場合 0 を返します。

### <a name="remarks"></a>Remarks

四角形では、有効なは、コントロールがアクティブである場合のみです。

##  <a name="getstocktextmetrics"></a>  COleControl::GetStockTextMetrics

コントロールのストック フォント プロパティで選択された状態のテキストのメトリックを測定、 [SelectStockFont](#selectstockfont)関数。

```
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```

### <a name="parameters"></a>パラメーター

*lptm*<br/>
ポインターを[受け取る](/windows/desktop/api/wingdi/ns-wingdi-tagtextmetrica)構造体。

### <a name="remarks"></a>Remarks

`GetStockTextMetrics`関数が初期化されます、`TEXTMETRIC`によって示される構造*lptm*の有効なメトリックについては、成功した場合、または塗りを 0 以外の場合で構造体。 代わりに、この関数を使用して[GetTextMetrics](/windows/desktop/api/wingdi/nf-wingdi-gettextmetrics)メタファイルに描画するときに必要な埋め込み OLE オブジェクトなどのコントロールがあるので、コントロールを描画します。

`TEXTMETRIC`構造の既定のフォントは更新されたときに、`SelectStockFont`関数が呼び出されます。 有効では提供情報を保証するために、ストックのフォントを選択した後にのみ、この関数を呼び出す必要があります。

##  <a name="gettext"></a>  COleControl::GetText

ストックのテキストまたはキャプション プロパティの Get 機能を実装します。

```
BSTR GetText();
```

### <a name="return-value"></a>戻り値

コントロールのテキスト文字列または文字列が存在しない場合は、長さ 0 の文字列の現在の値。

> [!NOTE]
>  BSTR データ型の詳細については、次を参照してください。[データ型](../../mfc/reference/data-types-mfc.md)マクロとグローバルのセクションでします。

### <a name="remarks"></a>Remarks

この関数の呼び出し元が呼び出す必要がありますので注意`SysFreeString`文字列が返されるため、無料リソース。 コントロールの実装内で使用して`InternalGetText`コントロールのテキストまたはキャプション ストック プロパティにアクセスします。

##  <a name="getwindowlessdroptarget"></a>  COleControl::GetWindowlessDropTarget

オーバーライド`GetWindowlessDropTarget`OLE の対象となるウィンドウなしのコントロールの場合、ドラッグ アンド ドロップ操作。

```
virtual IDropTarget* GetWindowlessDropTarget();
```

### <a name="return-value"></a>戻り値

オブジェクトへのポインター`IDropTarget`インターフェイス。 ウィンドウなしのオブジェクトを登録することはできません、ウィンドウがないため、`IDropTarget`インターフェイス。 ただし、ドラッグ アンド ドロップに参加するにウィンドウなしのオブジェクトはまだインターフェイスを実装してでそれを返す`GetWindowlessDropTarget`します。

### <a name="remarks"></a>Remarks

通常、このコントロールのウィンドウは、ドロップ先として登録する必要があります。 コンテナーは、ドロップ先として、独自のウィンドウを使用して、コントロールに、独自のウィンドウがあるないためです。 コントロールは、の実装を提供する必要があるだけ、`IDropTarget`インターフェイスをコンテナーは、適切な時点の呼び出しを委任できます。 例:

[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]

##  <a name="initializeiids"></a>  COleControl::InitializeIIDs

コントロールが使用する Iid の基本クラスを通知します。

```
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```

### <a name="parameters"></a>パラメーター

*piidPrimary*<br/>
コントロールのプライマリ ディスパッチ インターフェイスのインターフェイス ID へのポインター。

*piidEvents*<br/>
コントロールのイベント インターフェイスのインターフェイス ID へのポインター。

### <a name="remarks"></a>Remarks

あるインターフェイスのコントロールを使用する Id の基本クラスを通知するために、コントロールのコンス トラクターでは、この関数を呼び出します。

##  <a name="internalgetfont"></a>  COleControl::InternalGetFont

コントロールのストック フォント プロパティにアクセスします。

```
CFontHolder& InternalGetFont();
```

### <a name="return-value"></a>戻り値

参照を[CFontHolder](../../mfc/reference/cfontholder-class.md)ストックのフォント オブジェクトを格納しているオブジェクト。

##  <a name="internalgettext"></a>  COleControl::InternalGetText

コントロールの株価のテキストまたはキャプション プロパティにアクセスします。

```
const CString& InternalGetText();
```

### <a name="return-value"></a>戻り値

コントロールのテキスト文字列への参照。

##  <a name="internalsetreadystate"></a>  COleControl::InternalSetReadyState

コントロールの準備状態を設定します。

```
void InternalSetReadyState(long lNewReadyState);
```

### <a name="parameters"></a>パラメーター

*lNewReadyState*<br/>
コントロールの場合、次の値のいずれかを設定する準備の状態:

|||
|-|-|
|READYSTATE_UNINITIALIZED|既定の初期化状態|
|READYSTATE_LOADING|コントロールがそのプロパティを現在読み込んでください。|
|READYSTATE_LOADED|コントロールが初期化されています。|
|READYSTATE_INTERACTIVE|コントロールが対話型にするための十分なデータが、非同期データがまだ読み込まれています。|
|READYSTATE_COMPLETE|コントロールがそのすべてのデータ|

### <a name="remarks"></a>Remarks

ほとんどの単純なコントロールは、LOADED および対話型を区別する必要はありません。 ただし、データ パスのプロパティをサポートするコントロールは、少なくとも一部のデータが非同期的に受信されるまでに対話形式にする準備ができていない可能性があります。 コントロールは必要があります、できるだけ早く対話型になるしようとしています。

##  <a name="invalidatecontrol"></a>  COleControl::InvalidateControl

強制的にコントロールの再描画します。

```
void InvalidateControl(
    LPCRECT lpRect = NULL,
    BOOL bErase = TRUE);
```

### <a name="parameters"></a>パラメーター

*lpRect*<br/>
無効にするコントロールの領域へのポインター。

*あらゆる*<br/>
更新領域内でバック グラウンドの更新領域の処理時に消去するかどうかを指定します。

### <a name="remarks"></a>Remarks

場合*lpRect* NULL 値を持つコントロール全体が再描画されます。 場合*lpRect*が NULL でない無効にするコントロールの四角形の部分を示します。 場合、コントロールは、ウィンドウがないか、現在アクティブになっていない、四角形は無視され、呼び出しをクライアント サイトの[IAdviseSink::OnViewChange](/windows/desktop/api/objidl/nf-objidl-iadvisesink-onviewchange)メンバー関数。 代わりに、この関数を使用して`CWnd::InvalidateRect`または`InvalidateRect`します。

##  <a name="invalidatergn"></a>  COleControl::InvalidateRgn

特定のリージョン内のコンテナーのウィンドウのクライアント領域を無効にします。

```
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```

### <a name="parameters"></a>パラメーター

*pRgn*<br/>
ポインターを[CRgn](../../mfc/reference/crgn-class.md)格納先ウィンドウのクライアント座標で、無効にする OLE オブジェクトの表示領域を識別するオブジェクト。 このパラメーターが NULL の場合、エクステント、全体のオブジェクトです。

*あらゆる*<br/>
無効化された領域の背景を消去するかどうかを指定します。 TRUE の場合、バック グラウンドが消去されます。 FALSE の場合、バック グラウンドは変更されません。

### <a name="remarks"></a>Remarks

これは、コンテナー内のウィンドウなしのコントロールを再描画を使用できます。 描画するときに、更新領域内の他のすべての領域と、無効化されたリージョンがマークされている次[WM_PAINT](/windows/desktop/gdi/wm-paint)メッセージを送信します。

場合*あらゆる*TRUE は、特定の部分だけでなく、リージョン全体でバック グラウンド更新領域の任意の部分は消去されます。

##  <a name="isconvertingvbx"></a>  COleControl::IsConvertingVBX

OLE コントロールの特別な読み込みを許可します。

```
BOOL IsConvertingVBX();
```

### <a name="return-value"></a>戻り値

コントロールが変換された場合は 0 以外それ以外の場合 0 を返します。

### <a name="remarks"></a>Remarks

コントロールを OLE コントロールを使用する 1 つに、VBX を使用するフォームに変換する際に特別な読み込み OLE コントロールのコードが必要な場合があります。 たとえば、OLE コントロールのインスタンスをロードする場合への呼び出しを必要があります[PX_Font](persistence-of-ole-controls.md#px_font)で、 `DoPropExchange`:

[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]

ただし、VBX コントロールがありませんでした。 フォント オブジェクトフォントの各プロパティは、個別に保存されました。 この場合は、用途`IsConvertingVBX`これら 2 つのケースを区別します。

[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]

OLE コントロールが別の形式でバイナリ データを保存し、VBX コントロール (その VBM_SAVEPROPERTY メッセージ ハンドラー) の専用のバイナリ データを保存する別のケースとなります。 OLE コントロールの場合との下位互換性 VBX コントロールを使用して古いマスター_キーと新しい形式の両方を読み取る、 `IsConvertingVBX` VBX コントロールまたは OLE コントロールが読み込まれているかどうかを区別することによって機能します。

コントロールの`DoPropExchange`関数の場合、この条件を確認し、true の場合は、(前の例では) など、この変換に固有の読み込みコードを実行できます。 コントロールが変換されないとき場合、は、通常の負荷のコードを実行できます。 この機能は vbx から変換対象のコントロールに適用されるだけです。

##  <a name="isinvokeallowed"></a>  COleControl::IsInvokeAllowed

オートメーション メソッドの呼び出しを有効にします。

```
BOOL IsInvokeAllowed(DISPID dispid);
```

### <a name="return-value"></a>戻り値

コントロールが初期化されている場合は 0 以外それ以外の場合 0 を返します。

### <a name="remarks"></a>Remarks

フレームワークの実装の`IDispatch::Invoke`呼び出し`IsInvokeAllowed`場合は、特定の関数を判断する (で識別される`dispid`) 呼び出すことができます。 OLE コントロールの既定の動作は、コントロールが初期化されている場合にのみ呼び出されるメソッドをオートメーションを許可するにはただし、`IsInvokeAllowed`は仮想関数であり (たとえば、コントロールは、オートメーション サーバーとして使用されている) 場合、必要に応じてオーバーライドされる可能性があります。

##  <a name="ismodified"></a>  COleControl::IsModified

コントロールの状態が変更されたかどうかを決定します。

```
BOOL IsModified();
```

### <a name="return-value"></a>戻り値

最後の保存のため、コントロールの状態が変更された場合、0 以外の場合それ以外の場合 0 を返します。

### <a name="remarks"></a>Remarks

プロパティ値が変更されたときに、コントロールの状態が変更されます。

##  <a name="isoptimizeddraw"></a>  COleControl::IsOptimizedDraw

コンテナーが現在の描画操作の最適化された描画をサポートするかどうかを判断します。

```
BOOL IsOptimizedDraw();
```

### <a name="return-value"></a>戻り値

コンテナーは、現在の描画操作の最適化された描画をサポートしている場合は TRUE。それ以外の場合は FALSE です。

### <a name="remarks"></a>Remarks

最適化された描画がサポートされている場合、コントロール必要がありますいないを選び (ペン、ブラシ、フォントなど)、古いオブジェクト デバイス コンテキストに描画が完了するとします。

##  <a name="issubclassedcontrol"></a>  COleControl::IsSubclassedControl

かどうか、Windows コントロールをサブクラス化制御を決定するために、フレームワークによって呼び出されます。

```
virtual BOOL IsSubclassedControl();
```

### <a name="return-value"></a>戻り値

コントロールをサブクラス化された場合は 0 以外それ以外の場合 0 を返します。

### <a name="remarks"></a>Remarks

この関数をオーバーライドして、OLE コントロールを Windows コントロールをサブクラス化する場合は TRUE を返します。

##  <a name="load"></a>  COleControl::Load

以前の非同期的に読み込まれたデータをリセットし、コントロールの非同期のプロパティの新しい読み込みを開始します。

```
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```

### <a name="parameters"></a>パラメーター

*strNewPath*<br/>
非同期のコントロール プロパティの絶対位置を参照するパスを含む文字列へのポインター。

*prop*<br/>
A [CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md)非同期コントロールを実装するオブジェクト。

##  <a name="lockinplaceactive"></a>  COleControl::LockInPlaceActive

コンテナーが、コントロールを非アクティブ化するを防ぎます。

```
BOOL LockInPlaceActive(BOOL bLock);
```

### <a name="parameters"></a>パラメーター

*bLock*<br/>
コントロールのインプレース アクティブな状態が; ロックされる場合は TRUE。ロックを解除するのには、その場合は FALSE。

### <a name="return-value"></a>戻り値

ロックが成功した場合、0 以外の場合それ以外の場合 0 を返します。

### <a name="remarks"></a>Remarks

終了時にコントロールのロック解除と、コントロールのすべてのロックをペアリングする必要があることに注意してください。 イベントを発生させるときに、短期間のなど、コントロールをロックする必要がありますのみ。

##  <a name="onambientpropertychange"></a>  COleControl::OnAmbientPropertyChange

コンテナーのアンビエント プロパティの値が変更されたときに、フレームワークによって呼び出されます。

```
virtual void OnAmbientPropertyChange(DISPID dispid);
```

### <a name="parameters"></a>パラメーター

*dispID*<br/>
変更されたアンビエント プロパティのディスパッチ ID または DISPID_UNKNOWN 複数のプロパティが変更された場合。

##  <a name="onappearancechanged"></a>  COleControl::OnAppearanceChanged

ストックの外観プロパティの値が変更されたときに、フレームワークによって呼び出されます。

```
virtual void OnAppearanceChanged ();
```

### <a name="remarks"></a>Remarks

このプロパティの変更後の通知を使用する場合は、この関数をオーバーライドします。 既定の実装`InvalidateControl`します。

##  <a name="onbackcolorchanged"></a>  COleControl::OnBackColorChanged

株価 BackColor プロパティの値が変更されたときに、フレームワークによって呼び出されます。

```
virtual void OnBackColorChanged();
```

### <a name="remarks"></a>Remarks

このプロパティの変更後の通知を使用する場合は、この関数をオーバーライドします。 既定の実装`InvalidateControl`します。

##  <a name="onborderstylechanged"></a>  COleControl::OnBorderStyleChanged

ストック BorderStyle プロパティの値が変更されたときに、フレームワークによって呼び出されます。

```
virtual void OnBorderStyleChanged();
```

### <a name="remarks"></a>Remarks

既定の実装`InvalidateControl`します。

このプロパティの変更後の通知を使用する場合は、この関数をオーバーライドします。

##  <a name="onclick"></a>  COleControl::OnClick

マウス ボタンがクリックしてされたか DoClick ストック メソッドが呼び出されたときに、フレームワークによって呼び出されます。

```
virtual void OnClick(USHORT iButton);
```

### <a name="parameters"></a>パラメーター

*iButton*<br/>
マウス ボタンのインデックス。 次の値のいずれかを設定できます。

- LEFT_BUTTON マウスの左ボタンがクリックしてされました。

- MIDDLE_BUTTON マウスの中央ボタンがクリックしてされました。

- RIGHT_BUTTON マウスの右ボタンがクリックしてされました。

### <a name="remarks"></a>Remarks

既定の実装`COleControl::FireClick`します。

変更または既定の処理を拡張するには、このメンバー関数をオーバーライドします。

##  <a name="onclose"></a>  COleControl::OnClose

コンテナーには、コントロールが呼び出されたときにフレームワークによって呼び出さ`IOleControl::Close`関数。

```
virtual void OnClose(DWORD dwSaveOption);
```

### <a name="parameters"></a>パラメーター

*dwSaveOption*<br/>
読み込み前に、オブジェクトを保存するかどうかを示すフラグ。 次の値を指定できます。

- OLECLOSE_SAVEIFDIRTY

- OLECLOSE_NOSAVE

- OLECLOSE_PROMPTSAVE

### <a name="remarks"></a>Remarks

既定では、`OnClose`が変更された場合は、コントロール オブジェクトを保存し、 *dwSaveOption* OLECLOSE_SAVEIFDIRTY か OLECLOSE_PROMPTSAVE します。

##  <a name="ondoverb"></a>  COleControl::OnDoVerb

コンテナーを呼び出すときに、フレームワークによって呼び出されます、`IOleObject::DoVerb`メンバー関数。

```
virtual BOOL OnDoVerb(
    LONG iVerb,
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>パラメーター

*iVerb*<br/>
呼び出すコントロール動詞のインデックス。

*lpMsg*<br/>
呼び出す動詞を原因となった Windows メッセージへのポインター。

*hWndParent*<br/>
コントロールの親ウィンドウへのハンドル。 動詞の実行が作成ウィンドウ (または windows) *hWndParent*親として使用する必要があります。

*lpRect*<br/>
RECT 構造体が、コンテナーを基準として、コントロールの座標のコピー先へのポインター。

### <a name="return-value"></a>戻り値

呼び出しが成功した場合、0 以外の場合それ以外の場合 0 を返します。

### <a name="remarks"></a>Remarks

既定の実装では、ON_OLEVERB と ON_STDOLEVERB メッセージ マップ エントリを使用して、呼び出す適切な関数を調べます。

動詞の既定の処理を変更するには、この関数をオーバーライドします。

##  <a name="ondraw"></a>  COleControl::OnDraw

指定したデバイス コンテキストを使用して、指定した外接する四角形の OLE コントロールを描画するためにフレームワークによって呼び出されます。

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rcBounds,
    const CRect& rcInvalid);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
デバイス コンテキストは、図面に発生します。

*rcBounds*<br/>
境界線を含む、コントロールの四角形領域。

*rcInvalid*<br/>
無効なコントロールの四角形領域。

### <a name="remarks"></a>Remarks

`OnDraw` 通常として画面デバイス コンテキストを渡すことの画面表示のために呼び出されます*pDC*します。 *RcBounds*パラメーターは、ターゲットのデバイス コンテキスト (現在のマップ モード) の相対で四角形を識別します。 *RcInvalid*パラメーターが有効でない実際の四角形。 場合によってはこれより小さな領域になります*rcBounds*します。

##  <a name="ondrawmetafile"></a>  COleControl::OnDrawMetafile

指定されたメタファイル デバイス コンテキストを使用して、指定した外接する四角形の OLE コントロールを描画するためにフレームワークによって呼び出されます。

```
virtual void OnDrawMetafile(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
デバイス コンテキストは、図面に発生します。

*rcBounds*<br/>
境界線を含む、コントロールの四角形領域。

### <a name="remarks"></a>Remarks

既定の実装、 [OnDraw](#ondraw)関数。

##  <a name="onedit"></a>  COleControl::OnEdit

Ui をアクティブにするコントロールがされます。

```
virtual BOOL OnEdit(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>パラメーター

*lpMsg*<br/>
動詞を呼び出した Windows メッセージへのポインター。

*hWndParent*<br/>
コントロールの親ウィンドウへのハンドル。

*lpRect*<br/>
コンテナー内のコントロールによって使用される四角形へのポインター。

### <a name="return-value"></a>戻り値

呼び出しが成功した場合、0 以外の場合それ以外の場合 0 を返します。

### <a name="remarks"></a>Remarks

これは、コントロールの OLEIVERB_UIACTIVATE 動詞を呼び出すのと同じ効果です。

この関数は、通常は ON_OLEVERB メッセージ マップ エントリのハンドラー関数として使用します。 これにより、メニューのコントロールの「オブジェクト」、"Edit"動詞が使用可能なにします。 例:

[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]

##  <a name="onenabledchanged"></a>  COleControl::OnEnabledChanged

在庫の Enabled プロパティの値が変更されたときに、フレームワークによって呼び出されます。

```
virtual void OnEnabledChanged();
```

### <a name="remarks"></a>Remarks

このプロパティの変更後の通知を使用する場合は、この関数をオーバーライドします。 既定の実装[InvalidateControl](#invalidatecontrol)します。

##  <a name="onenumverbs"></a>  COleControl::OnEnumVerbs

コンテナーを呼び出すときに、フレームワークによって呼び出されます、`IOleObject::EnumVerbs`メンバー関数。

```
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```

### <a name="parameters"></a>パラメーター

*ppenumOleVerb*<br/>
ポインター、`IEnumOLEVERB`コントロールの動詞を列挙するオブジェクト。

### <a name="return-value"></a>戻り値

動詞が使用可能な場合は 0 以外。それ以外の場合 0 を返します。

### <a name="remarks"></a>Remarks

既定の実装では、メッセージ マップで ON_OLEVERB エントリを列挙します。

動詞の列挙の既定の方法を変更するには、この関数をオーバーライドします。

##  <a name="oneventadvise"></a>  COleControl::OnEventAdvise

イベント ハンドラーに接続されている、または OLE コントロールから切断されているときに、フレームワークによって呼び出されます。

```
virtual void OnEventAdvise(BOOL bAdvise);
```

### <a name="parameters"></a>パラメーター

*bAdvise*<br/>
TRUE は、イベント ハンドラーがコントロールに接続されたことを示します。 FALSE は、イベント ハンドラーがコントロールから切り離されていることを示します。

##  <a name="onfontchanged"></a>  COleControl::OnFontChanged

ストック フォント プロパティの値が変更されたときに、フレームワークによって呼び出されます。

```
virtual void OnFontChanged();
```

### <a name="remarks"></a>Remarks

既定の実装`COleControl::InvalidateControl`します。 コントロールは、Windows コントロールをサブクラス化は、コントロールのウィンドウを WM_SETFONT メッセージは、既定の実装によっても送信します。

このプロパティの変更後の通知を使用する場合は、この関数をオーバーライドします。

### <a name="example"></a>例

[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]

##  <a name="onforecolorchanged"></a>  COleControl::OnForeColorChanged

ストックの前景色プロパティ値が変更されたときに、フレームワークによって呼び出されます。

```
virtual void OnForeColorChanged();
```

### <a name="remarks"></a>Remarks

既定の実装`InvalidateControl`します。

このプロパティの変更後の通知を使用する場合は、この関数をオーバーライドします。

##  <a name="onfreezeevents"></a>  COleControl::OnFreezeEvents

コンテナーの呼び出し後に、フレームワークによって呼び出されます`IOleControl::FreezeEvents`します。

```
virtual void OnFreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>パラメーター

*bFreeze*<br/>
TRUE の場合、コントロールのイベント処理が固定されています。それ以外の場合は FALSE です。

### <a name="remarks"></a>Remarks

既定の実装では、何も行われません。

イベント処理がフリーズまたはマスクされていないときにその他の動作が必要な場合は、この関数をオーバーライドします。

##  <a name="ongetcolorset"></a>  COleControl::OnGetColorSet

コンテナーを呼び出すときに、フレームワークによって呼び出されます、`IViewObject::GetColorSet`メンバー関数。

```
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    LPLOGPALETTE* ppColorSet);
```

### <a name="parameters"></a>パラメーター

*ptd*<br/>
画像を表示するターゲット デバイスを指します。 この値が NULL の場合は、ディスプレイ デバイスでは、通常は、既定のターゲット デバイスの画像を表示するか。

*hicTargetDev*<br/>
指定されたターゲット デバイスの情報コンテキストを指定します。 *ptd*します。 このパラメーターは、デバイス コンテキストを指定できますが、必ずしもが 1 つ。 場合*ptd*が null の場合、 *hicTargetDev*は NULL にもなります。

*ppColorSet*<br/>
使用される色のセットのコピー先の場所へのポインター。 関数が色セットを返さない場合は、NULL が返されます。

### <a name="return-value"></a>戻り値

以外の場合は有効な色のセットが返されます。それ以外の場合 0 を返します。

### <a name="remarks"></a>Remarks

コンテナーは、OLE コントロールを描画するために必要なすべての色を取得するには、この関数を呼び出します。 コンテナーは、全体的なカラー パレットを設定する必要がある色と組み合わせて取得される色のセットを使用できます。 既定の実装では、FALSE を返します。

この要求の特別な処理を行うには、この関数をオーバーライドします。

##  <a name="ongetcontrolinfo"></a>  COleControl::OnGetControlInfo

コントロールのコンテナーは、コントロールに関する情報を要求したときに、フレームワークによって呼び出されます。

```
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```

### <a name="parameters"></a>パラメーター

*pControlInfo*<br/>
ポインターを[CONTROLINFO](/windows/desktop/api/ocidl/ns-ocidl-tagcontrolinfo)情報を格納する構造体。

### <a name="remarks"></a>Remarks

この情報は、コントロールのニーモニック キーの説明は、主にで構成されます。 既定の実装の塗りつぶし*pControlInfo*に既定の情報。

コントロールは、アクセス キーを処理する必要がある場合は、この関数をオーバーライドします。

##  <a name="ongetdisplaystring"></a>  COleControl::OnGetDisplayString

によって識別されたプロパティの現在の値を表す文字列を取得するためにフレームワークによって呼び出される*dispid*します。

```
virtual BOOL OnGetDisplayString(
    DISPID dispid,
    CString& strValue);
```

### <a name="parameters"></a>パラメーター

*dispid*<br/>
コントロールのプロパティのディスパッチ ID。

*strValue*<br/>
参照を[CString](../../atl-mfc-shared/reference/cstringt-class.md)文字列を返されるオブジェクトします。

### <a name="return-value"></a>戻り値

文字列が返された場合は 0 以外*strValue;* 0 それ以外の場合。

### <a name="remarks"></a>Remarks

コントロールが、プロパティの値を文字列に直接変換ことはできませんし、コンテナーが指定したプロパティ ブラウザーに表示されるプロパティの値にする場合は、この関数をオーバーライドします。

##  <a name="ongetinplacemenu"></a>  COleControl::OnGetInPlaceMenu

コントロールが UI で、コンテナーの既存のメニューにマージするメニューをアクティブ化されるときに、フレームワークによって呼び出されます。

```
virtual HMENU OnGetInPlaceMenu();
```

### <a name="return-value"></a>戻り値

コントロールのメニューのまたはコントロールに [なし] がある場合は NULL のハンドル。 既定の実装では、NULL を返します。

### <a name="remarks"></a>Remarks

OLE のリソースをマージする方法の詳細については、この記事を参照してください。[メニューとリソース (OLE)](../../mfc/menus-and-resources-ole.md)します。

##  <a name="ongetnaturalextent"></a>  COleControl::OnGetNaturalExtent

コンテナーの応答にフレームワークによって呼び出されます`IViewObjectEx::GetNaturalExtent`要求。

```
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```

### <a name="parameters"></a>パラメーター

*dwAspect*<br/>
オブジェクトがどのように表示されるかを指定します。 表現には、コンテンツ、アイコン、縮小表示または印刷したドキュメントが含まれます。 有効な値は、列挙体から取得[型](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect)または DVASPECT2 します。

*lindex*<br/>
関心のあるオブジェクトの部分。 現在は-1 は有効です。

*ptd*<br/>
指す、 [DVTARGETDEVICE](/windows/desktop/api/objidl/ns-objidl-tagdvtargetdevice)オブジェクトのサイズが返される、ターゲット デバイスを定義する構造体。

*hicTargetDev*<br/>
指定されたターゲット デバイスの情報コンテキストを指定します、 *ptd*パラメーターから、オブジェクトはデバイス メトリックを抽出し、デバイスの機能をテストします。 場合*ptd*が null の場合、オブジェクトの値は無視する必要があります、 *hicTargetDev*パラメーター。

*pExtentInfo*<br/>
指す、`DVEXTENTINFO`サイズ設定データを指定する構造体。 `DVEXTENTINFO`構造体は。

```cpp
typedef struct tagExtentInfo
{
    UINT cb;
    DWORD dwExtentMode;
    SIZEL sizelProposed;
}   DVEXTENTINFO;
```

構造体メンバー `dwExtentMode` 2 つの値のいずれかを実行できます。

- 大きさはそのコントロールがコンテンツ (スナップのサイズ) に正確に合わせて DVEXTENT_CONTENT の照会します。

- DVEXTENT_INTEGRAL、サイズ変更時に、コントロールに提案されたサイズを渡す

*psizel*<br/>
コントロールによって返されるデータのサイズを設定するポイント。 返されたサイズ設定データは、調整されていないすべてのディメンションの場合は-1 に設定されます。

### <a name="return-value"></a>戻り値

以外の場合は、正常に取得およびサイズの調整それ以外の場合 0 を返します。

### <a name="remarks"></a>Remarks

提案されたサイズと拡張モードに最も近いオブジェクトの表示サイズを返すには、この関数をオーバーライド、`DVEXTENTINFO`構造体。 既定の実装では、FALSE を返しますをサイズ調整は行われません。

##  <a name="ongetpredefinedstrings"></a>  COleControl::OnGetPredefinedStrings

プロパティの値を表す定義済みの文字列のセットを取得するためにフレームワークによって呼び出されます。

```
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,
    CStringArray* pStringArray,
    CDWordArray* pCookieArray);
```

### <a name="parameters"></a>パラメーター

*dispid*<br/>
コントロールのプロパティのディスパッチ ID。

*pStringArray*<br/>
格納する文字列配列には、値が返されます。

*pCookieArray*<br/>
格納する DWORD 配列では、値を返します。

### <a name="return-value"></a>戻り値

要素に追加された場合は 0 以外*pStringArray*と*pCookieArray*します。

### <a name="remarks"></a>Remarks

コントロールに一連の文字列で表すことができる使用可能な値のプロパティが設定されている場合は、この関数をオーバーライドします。 追加の各要素に対して*pStringArray*に対応する「クッキー」要素を追加する必要があります*pCookieArray します。* これらの「クッキー」値は、ためにフレームワークによって後で渡される、`COleControl::OnGetPredefinedValue`関数。

##  <a name="ongetpredefinedvalue"></a>  COleControl::OnGetPredefinedValue

以前のオーバーライドによって返される定義済みの文字列のいずれかに対応する値を取得するためにフレームワークによって呼び出される`COleControl::OnGetPredefinedStrings`します。

```
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,
    DWORD dwCookie,
    VARIANT* lpvarOut);
```

### <a name="parameters"></a>パラメーター

*dispid*<br/>
コントロールのプロパティのディスパッチ ID。

*dwCookie*<br/>
クッキー値のオーバーライドによって以前返さ`COleControl::OnGetPredefinedStrings`します。

*lpvarOut*<br/>
ポインターを`VARIANT`を通じてプロパティの値を返される構造体します。

### <a name="return-value"></a>戻り値

値が返された場合は 0 以外*lpvarOut*。 それ以外の場合に 0 です。

##  <a name="ongetviewextent"></a>  COleControl::OnGetViewExtent

コンテナーの応答にフレームワークによって呼び出されます[IViewObject2::GetExtent](/windows/desktop/api/oleidl/nf-oleidl-iviewobject2-getextent)要求。

```
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```

### <a name="parameters"></a>パラメーター

*dwDrawAspect*<br/>
フォームまたはオブジェクトの範囲を示す DWORD では、表示されます。 有効な値は、列挙体から取得[型](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect)または DVASPECT2 します。

*lindex*<br/>
関心のあるオブジェクトの部分。 現在は-1 は有効です。

*ptd*<br/>
指す、 [DVTARGETDEVICE](/windows/desktop/api/objidl/ns-objidl-tagdvtargetdevice)オブジェクトのサイズが返される、ターゲット デバイスを定義する構造体。

*lpsizel*<br/>
オブジェクトのサイズが返される場所を指します。

### <a name="return-value"></a>戻り値

以外の場合、エクステントの情報が正常に返されます。それ以外の場合 0 を返します。

### <a name="remarks"></a>Remarks

コントロールで 2 つのパスの描画を使用し、その不透明な直線および透明な部分がさまざまな次元を持つ場合は、この関数をオーバーライドします。

##  <a name="ongetviewrect"></a>  COleControl::OnGetViewRect

コンテナーの応答にフレームワークによって呼び出されます`IViewObjectEx::GetRect`要求。

```
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```

### <a name="parameters"></a>パラメーター

*dwAspect*<br/>
フォームまたはオブジェクトの範囲を示す DWORD では、表示されます。 有効な値は、列挙体から取得[型](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect)または DVASPECT2:

- オブジェクト全体の DVASPECT_CONTENT 外接する四角形 左上隅で、オブジェクトの原点とサイズによって返される程度に等しい`GetViewExtent`*します。*

- 四角形の不透明な領域で DVASPECT_OPAQUE オブジェクトは、その四角形を返します。 他のユーザーが失敗します。

- すべての透過的なまたは不定期的な部分をカバーする DVASPECT_TRANSPARENT 四角形。

*pRect*<br/>
指す、 [RECTL](https://msdn.microsoft.com/library/windows/desktop/dd162907)オブジェクトを描画する四角形を指定する構造体。 このパラメーターは、移動とオブジェクトの拡大を制御します。

### <a name="return-value"></a>戻り値

以外の場合は、四角形のサイズは、オブジェクトが正常に返されます。それ以外の場合 0 を返します。

### <a name="remarks"></a>Remarks

オブジェクトのサイズは変換`OnGetViewRect`(既定では、ディスプレイの左上隅にある) 特定の位置以降にある四角形にします。 コントロールで 2 つのパスの描画を使用し、その不透明な直線および透明な部分がさまざまな次元を持つ場合は、この関数をオーバーライドします。

##  <a name="ongetviewstatus"></a>  COleControl::OnGetViewStatus

コンテナーの応答にフレームワークによって呼び出されます`IViewObjectEx::GetViewStatus`要求。

```
virtual DWORD OnGetViewStatus();
```

### <a name="return-value"></a>戻り値

成功した場合は、な VIEWSTATUS 列挙の値のいずれかそれ以外の場合 0 を返します。 値には、次の任意の組み合わせがあります。

|||
|-|-|
|VIEWSTATUS_OPAQUE|オブジェクトは、完全に不透明です。 このビットが設定されていない場合、オブジェクトには、透明な部分が含まれています。 このビットには、コンテンツに関連する側面にのみ、DVASPECT_ICON または DVASPECT_DOCPRINT が適用されます。|
|VIEWSTATUS_SOLIDBKGND|オブジェクトには、純色の背景 (単色のブラシ パターンではないので構成される) があります。 このビットは、VIEWSTATUS_OPAQUE が設定されていて、DVASPECT_ICON または DVASPECT_DOCPRINT およびコンテンツに関連する側面にのみ適用される場合にのみ有効です。|
|VIEWSTATUS_DVASPECTOPAQUE|オブジェクトは、DVASPECT_OPAQUE をサポートします。 パラメーターは、この側面で呼び出すことができます、描画範囲を受け取るすべての IViewObjectEx メソッド。|
|VIEWSTATUS_DVASPECTTRANSPARENT|オブジェクトは、DVASPECT_TRANSPARENT をサポートします。 すべて`IViewObjectEx`パラメーターは、この側面で呼び出すことができます、描画の外観を取るメソッド。|

### <a name="remarks"></a>Remarks

コントロールが 2 つのパスの描画を使用している場合は、この関数をオーバーライドします。 既定の実装では、VIEWSTATUS_OPAQUE を返します。

##  <a name="onhidetoolbars"></a>  COleControl::OnHideToolBars

コントロールが UI で非アクティブのときに、フレームワークによって呼び出されます。

```
virtual void OnHideToolBars();
```

### <a name="remarks"></a>Remarks

実装には、によって表示されるすべてのツールバーが非表示にする必要があります`OnShowToolbars`します。

##  <a name="oninactivemousemove"></a>  COleControl::OnInactiveMouseMove

WM_MOUSEMOVE メッセージの受信時にマウス ポインターの下の非アクティブなオブジェクトのコンテナーによって呼び出されます。

```
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```

### <a name="parameters"></a>パラメーター

*lprcBounds*<br/>
外接する四角形の外側のウィンドウのクライアント座標で、オブジェクト。 オブジェクトの正確な位置とサイズ画面上の通知が WM_MOUSEMOVE メッセージを受け取ったとき。

*x*<br/>
マウスの位置を含むウィンドウのクライアント座標の x 座標。

*y*<br/>
マウスの位置を含むウィンドウのクライアント座標の y 座標。

*dwKeyState*<br/>
キーボードのキーボードの修飾子キーの現在の状態を識別します。 有効な値は、MK_CONTROL、MK_SHIFT、MK_ALT、MK_BUTTON、MK_LBUTTON、MK_MBUTTON、および MK_RBUTTON フラグのいずれかの組み合わせを指定できます。

### <a name="remarks"></a>Remarks

ウィンドウのクライアント座標 (ピクセル単位) を使用すると、マウス カーソルの位置を渡すことに注意してください。 これは同じ座標系でオブジェクトの外接する四角形も渡すことによって実現されます。

##  <a name="oninactivesetcursor"></a>  COleControl::OnInactiveSetCursor

WM_SETCURSOR メッセージの受信時にマウス ポインターの下の非アクティブなオブジェクトのコンテナーによって呼び出されます。

```
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```

### <a name="parameters"></a>パラメーター

*lprcBounds*<br/>
外接する四角形の外側のウィンドウのクライアント座標で、オブジェクト。 オブジェクトの正確な位置とサイズ画面上の通知 WM_SETCURSOR メッセージを受信したときにします。

*x*<br/>
マウスの位置を含むウィンドウのクライアント座標の x 座標。

*y*<br/>
マウスの位置を含むウィンドウのクライアント座標の y 座標。

*dwMouseMsg*<br/>
WM_SETCURSOR が発生したマウス メッセージの識別子。

*bSetAlways*<br/>
オブジェクトが、カーソルを設定する必要があるかどうかを指定します。 TRUE の場合、オブジェクトは、カーソルを設定する必要があります。FALSE の場合、カーソル、カーソルを設定する義務はありませんし、その場合は S_FALSE を返す必要があります。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

ウィンドウのクライアント座標 (ピクセル単位) を使用すると、マウス カーソルの位置を渡すことに注意してください。 これは同じ座標系でオブジェクトの外接する四角形も渡すことによって実現されます。

##  <a name="onkeydownevent"></a>  COleControl::OnKeyDownEvent

ストックの KeyDown イベントが処理された後に、フレームワークによって呼び出されます。

```
virtual void OnKeyDownEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>パラメーター

*NChar*<br/>
押されたキーの仮想キー コード値。 標準の仮想キー コードの一覧は、Winuser.h を参照してください。

*nShiftState*<br/>
次のフラグの組み合わせが含まれます。

- 操作中に SHIFT_MASK、SHIFT キーが押されました。

- 操作中に CTRL_MASK、CTRL キーが押されました。

- 操作中に ALT_MASK、ALT キーが押されました。

### <a name="remarks"></a>Remarks

イベントが発生した後、コントロールにキー情報にアクセスする必要がある場合は、この関数をオーバーライドします。

##  <a name="onkeypressevent"></a>  COleControl::OnKeyPressEvent

KeyPress イベントが発生した株式の後に、フレームワークによって呼び出されます。

```
virtual void OnKeyPressEvent(USHORT nChar);
```

### <a name="parameters"></a>パラメーター

*NChar*<br/>
押されたキーの仮想キー コード値が含まれています。 標準の仮想キー コードの一覧は、Winuser.h を参照してください。

### <a name="remarks"></a>Remarks

なお、 *nChar*コンテナーによって値が変更されている可能性があります。

このイベントの発生後に通知する場合は、この関数をオーバーライドします。

##  <a name="onkeyupevent"></a>  COleControl::OnKeyUpEvent

ストックの KeyDown イベントが処理された後に、フレームワークによって呼び出されます。

```
virtual void OnKeyUpEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>パラメーター

*NChar*<br/>
押されたキーの仮想キー コード値。 標準の仮想キー コードの一覧は、Winuser.h を参照してください。

*nShiftState*<br/>
次のフラグの組み合わせが含まれます。

- 操作中に SHIFT_MASK、SHIFT キーが押されました。

- 操作中に CTRL_MASK、CTRL キーが押されました。

- 操作中に ALT_MASK、ALT キーが押されました。

### <a name="remarks"></a>Remarks

イベントが発生した後、コントロールにキー情報にアクセスする必要がある場合は、この関数をオーバーライドします。

##  <a name="onmappropertytopage"></a>  COleControl::OnMapPropertyToPage

指定したプロパティの編集を実装するプロパティ ページのクラス ID を取得するためにフレームワークによって呼び出されます。

```
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,
    LPCLSID lpclsid,
    BOOL* pbPageOptional);
```

### <a name="parameters"></a>パラメーター

*dispid*<br/>
コントロールのプロパティのディスパッチ ID。

*lpclsid*<br/>
ポインターを`CLSID`を通じてクラス ID を返される構造体します。

*pbPageOptional*<br/>
指定したプロパティ ページの使用は省略可能かどうかを示すインジケーターを返します。

### <a name="return-value"></a>戻り値

クラス ID が返された場合は 0 以外*lpclsid*。 それ以外の場合に 0 です。

### <a name="remarks"></a>Remarks

コンテナーのプロパティ ブラウザーからのコントロールのプロパティ ページを呼び出す方法を提供するには、この関数をオーバーライドします。

##  <a name="onmnemonic"></a>  COleControl::OnMnemonic

OLE コントロールのニーモニック キーが押されたことをコンテナーが検出されたときに、フレームワークによって呼び出されます。

```
virtual void OnMnemonic(LPMSG pMsg);
```

### <a name="parameters"></a>パラメーター

*pMsg*<br/>
ニーモニック キーの押下時に生成された Windows メッセージへのポインター。

##  <a name="onproperties"></a>  COleControl::OnProperties

コントロールのプロパティの動詞がコンテナーによって呼び出されたときに、フレームワークによって呼び出されます。

```
virtual BOOL OnProperties(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>パラメーター

*lpMsg*<br/>
動詞を呼び出した Windows メッセージへのポインター。

*hWndParent*<br/>
コントロールの親ウィンドウへのハンドル。

*lpRect*<br/>
コンテナー内のコントロールによって使用される四角形へのポインター。

### <a name="return-value"></a>戻り値

呼び出しが成功した場合、0 以外の場合それ以外の場合 0 を返します。

### <a name="remarks"></a>Remarks

既定の実装では、モーダル プロパティ ダイアログ ボックスが表示されます。

コントロールのプロパティ ページの表示が、この関数を使用することもできます。 呼び出す、`OnProperties`のコントロールの親のハンドルを渡して、関数、 *hWndParent*パラメーター。 ここでの値、 *lpMsg*と*lpRect*パラメーターは無視されます。

##  <a name="onqueryhitpoint"></a>  COleControl::OnQueryHitPoint

コンテナーの応答にフレームワークによって呼び出されます`IViewObjectEx::QueryHitPoint`要求。

```
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>パラメーター

*dwAspect*<br/>
オブジェクトの表現方法を指定します。 有効な値は、列挙体から取得[型](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect)または DVASPECT2 します。

*pRectBounds*<br/>
ポインター、 `RECT` OLE コントロールのクライアント領域の外接する四角形を指定する構造体。

*ptlLoc*<br/>
ポインター、`POINT`ヒットをチェックするポイントを指定する構造体。 ポイントは、OLE クライアント領域の座標で指定されます。

*lCloseHint*<br/>
[閉じる] をポイントにヒットがチェックを定義する距離。

*し*<br/>
ヒットのクエリの結果へのポインター。 次のいずれかの値です。

- 値*ptlLoc*は外部 OLE オブジェクトし、閉じることができません。

- 中心*ptlLoc*画像の近くにいないが、OLE オブジェクトの境界内にあります。 たとえば、透過的な円の中央にある点には、中心可能性があります。

- HITRESULT_CLOSE *ptlLoc*は内側または外側 OLE オブジェクトが、オブジェクトの内部と見なされるに十分近い。 小さな、細枠、または詳細なオブジェクトは、この値を使用して可能性があります。 その場合でも、オブジェクトの四角形に近い状態、ポイントが境界の外側にある場合でも (これは小さなオブジェクトをヒットするため必要)。

- この*ptlLoc*オブジェクトのイメージ内にあります。

### <a name="return-value"></a>戻り値

以外の場合は、ヒット テストの結果が正常に返されます。それ以外の場合 0 を返します。 ヒットは、OLE コントロールの表示領域に重なりです。

### <a name="remarks"></a>Remarks

オブジェクトの表示の四角形に指定したポイントが重なっているかどうかを照会する (ポイントをヒット)。 `QueryHitPoint` 四角形以外のオブジェクトに対するヒット テストをオーバーライドできます。

##  <a name="onqueryhitrect"></a>  COleControl::OnQueryHitRect

コンテナーの応答にフレームワークによって呼び出されます`IViewObjectEx::QueryHitRect`要求。

```
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    LPCRECT prcLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>パラメーター

*dwAspect*<br/>
オブジェクトがどのように表示されるかを指定します。 有効な値は、列挙体から取得[型](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect)または DVASPECT2 します。

*pRectBounds*<br/>
ポインター、 `RECT` OLE コントロールのクライアント領域の外接する四角形を指定する構造体。

*prcLoc*<br/>
ポインター、`RECT`オブジェクトの左上隅を基準とヒット (オブジェクトを示す四角形の重複) をチェックする四角形を指定する構造体。

*lCloseHint*<br/>
使用しません。

*し*<br/>
ヒットのクエリの結果へのポインター。 次のいずれかの値です。

- 値が OLE オブジェクトを四角形内ポイントがヒットしません。

- この四角形内の少なくとも 1 つのポイントは、オブジェクトのヒットになります。

### <a name="return-value"></a>戻り値

以外の場合は、ヒット テストの結果が正常に返されます。それ以外の場合 0 を返します。

### <a name="remarks"></a>Remarks

オブジェクトの表示の四角形に (四角形をヒット) の指定した四角形の任意の時点が重なっているかどうかを照会します。 `QueryHitRect` 四角形以外のオブジェクトに対するヒット テストをオーバーライドできます。

##  <a name="onrenderdata"></a>  COleControl::OnRenderData

指定された形式でデータを取得するためにフレームワークによって呼び出されます。

```
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium);
```

### <a name="parameters"></a>パラメーター

*lpFormatEtc*<br/>
指す、 [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc)情報が要求された形式を指定します。

*lpStgMedium*<br/>
指す、 [STGMEDIUM](/windows/desktop/api/objidl/ns-objidl-tagstgmedium)データが返される構造体。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

指定の形式は、コントロールを使用してオブジェクトに既に配置、[に](../../mfc/reference/coledatasource-class.md#delayrenderdata)または[DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata)メンバー関数のレンダリングを遅延します。 この関数の既定の実装を呼び出す`OnRenderFileData`または`OnRenderGlobalData`、それぞれに、指定のストレージ メディアは、ファイルまたはメモリがある場合。 要求の形式が CF_METAFILEPICT または永続的なプロパティ セットの形式の場合は、既定の実装は適切なデータを表示し、0 以外の値を返します。 それ以外の場合、0 を返し、何も行われません。

場合*lpStgMedium tymed]-> [* TYMED_NULL には、STGMEDIUM を割り当てられで指定したとおりに入力する必要があります*lpFormatEtc tymed]-> [* します。 存在しない場合に、データが配置 TYMED_NULL、STGMEDIUM を入力する必要があります。

要求された形式および中規模のデータを提供するには、この関数をオーバーライドします。 データによっては、代わりにこの関数の他のバージョンの 1 つをオーバーライドすることがあります。 データが小さく、固定サイズの場合は、オーバーライド`OnRenderGlobalData`します。 データは、ファイルでは、または可変サイズは、オーバーライド`OnRenderFileData`します。

詳細については、次を参照してください。、`FORMATETC`と`STGMEDIUM`Windows SDK 内の構造体。

##  <a name="onrenderfiledata"></a>  COleControl::OnRenderFileData

ファイルのストレージ メディアは、指定された形式でデータを取得するためにフレームワークによって呼び出されます。

```
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,
    CFile* pFile);
```

### <a name="parameters"></a>パラメーター

*lpFormatEtc*<br/>
指す、 [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc)情報が要求された形式を指定します。

*pFile*<br/>
指す、 [CFile](../../mfc/reference/cfile-class.md)データがレンダリングされるオブジェクト。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

指定の形式は、コントロールを使用してオブジェクトに既に配置、[に](../../mfc/reference/coledatasource-class.md#delayrenderdata)遅延レンダリングするためのメンバー関数。 この関数の既定の実装は、単に FALSE を返します。

要求された形式および中規模のデータを提供するには、この関数をオーバーライドします。 データによっては、代わりにこの関数の他のバージョンの 1 つをオーバーライドする可能性があります。 複数のストレージ メディアを処理する場合は、オーバーライド`OnRenderData`します。 データは、ファイルでは、または可変サイズは、オーバーライド`OnRenderFileData`します。

詳細については、次を参照してください。、 `FORMATETC` Windows SDK の構造体。

##  <a name="onrenderglobaldata"></a>  COleControl::OnRenderGlobalData

指定したストレージ メディアがグローバル メモリに指定された形式でデータを取得するためにフレームワークによって呼び出されます。

```
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,
    HGLOBAL* phGlobal);
```

### <a name="parameters"></a>パラメーター

*lpFormatEtc*<br/>
指す、 [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc)情報が要求された形式を指定します。

*phGlobal*<br/>
データが返されるグローバル メモリ ハンドルへのポインター。 メモリが割り当てられていない場合、このパラメーターは NULL を指定できます。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

指定の形式は、コントロールを使用してオブジェクトに既に配置、[に](../../mfc/reference/coledatasource-class.md#delayrenderdata)遅延レンダリングするためのメンバー関数。 この関数の既定の実装は、単に FALSE を返します。

場合*phGlobal*新しい HGLOBAL を割り当てられで返される必要がありますし、NULL の場合は、 *phGlobal*します。 指定された、HGLOBAL のそれ以外の場合、 *phGlobal*データが格納される必要があります。 HGLOBAL で配置されるデータ量は、メモリ ブロックの現在のサイズを超えない必要があります。 また、ブロックより大きなサイズに再割り当てできることはできません。

要求された形式および中規模のデータを提供するには、この関数をオーバーライドします。 データによっては、代わりにこの関数の他のバージョンの 1 つをオーバーライドすることがあります。 複数のストレージ メディアを処理する場合は、オーバーライド`OnRenderData`します。 データは、ファイルでは、または可変サイズは、オーバーライド`OnRenderFileData`します。

詳細については、次を参照してください。、 `FORMATETC` Windows SDK の構造体。

##  <a name="onresetstate"></a>  COleControl::OnResetState

コントロールのプロパティは、既定値に設定する必要があるときに、フレームワークによって呼び出されます。

```
virtual void OnResetState();
```

### <a name="remarks"></a>Remarks

既定の実装[DoPropExchange](#dopropexchange)を渡して、`CPropExchange`プロパティの既定値に設定するオブジェクト。

コントロールのライターがこの OLE コントロールの初期化コードを挿入できますオーバーライド可能な。 この関数が呼び出されます[IPersistStream::Load](/windows/desktop/api/objidl/nf-objidl-ipersiststream-load)または[機能として](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-load)失敗した場合、または[IPersistStreamInit::InitNew](/windows/desktop/api/ocidl/nf-ocidl-ipersiststreaminit-initnew)または[IPersistStorage:: れます](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-initnew)が呼び出されると、いずれかの最初を呼び出さずに`IPersistStream::Load`または`IPersistStorage::Load`します。

##  <a name="onsetclientsite"></a>  COleControl::OnSetClientSite

コンテナーには、コントロールが呼び出されたときにフレームワークによって呼び出さ`IOleControl::SetClientSite`関数。

```
virtual void OnSetClientSite();
```

### <a name="remarks"></a>Remarks

既定では、`OnSetClientSite`データ パスのプロパティを読み込むかどうかをチェックし、呼び出しの場合は、`DoDataPathPropExchange`します。

この通知の特別な処理を行うには、この関数をオーバーライドします。 具体的には、この関数のオーバーライドは基本クラスを呼び出す必要があります。

##  <a name="onsetdata"></a>  COleControl::OnSetData

データを指定して、コントロールのデータを交換するためにフレームワークによって呼び出されます。

```
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```

### <a name="parameters"></a>パラメーター

*lpFormatEtc*<br/>
ポインターを[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc)データの形式を指定します。

*lpStgMedium*<br/>
ポインターを[STGMEDIUM](/windows/desktop/api/objidl/ns-objidl-tagstgmedium)データが存在する構造体します。

*bRelease*<br/>
TRUE の場合は、コントロールがストレージ メディアを解放する必要があります。FALSE の場合は、コントロールがストレージ メディアを解放する必要があります。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

場合は、データは永続的なプロパティの形式を設定、既定の実装は、コントロールの状態を適宜変更します。 それ以外の場合、既定の実装では、何も行われません。 場合*bRelease*が true の場合、呼び出しを`ReleaseStgMedium`を加えるいません。

コントロールのデータを指定されたデータに置き換えるには、この関数をオーバーライドします。

詳細については、次を参照してください。、`FORMATETC`と`STGMEDIUM`Windows SDK 内の構造体。

##  <a name="onsetextent"></a>  COleControl::OnSetExtent

コントロールの範囲は、呼び出しの結果として、変更する必要がある場合に、フレームワークによって呼び出されます[IOleObject::SetExtent](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-setextent)します。

```
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```

### <a name="parameters"></a>パラメーター

*lpSizeL*<br/>
ポインター、 `SIZEL` HIMETRIC 単位で表される、コントロールの高さと幅を表す長整数を使用する構造体。

### <a name="return-value"></a>戻り値

サイズの変更が受け入れられた場合、0 以外の場合それ以外の場合 0 を返します。

### <a name="remarks"></a>Remarks

既定の実装では、コントロールの範囲のサイズ変更を処理します。 コントロールが、インプレース アクティブ、コンテナーへの呼び出しの場合`OnPosRectChanged`が行われます。

コントロールの既定のサイズ変更を変更するには、この関数をオーバーライドします。

##  <a name="onsetobjectrects"></a>  COleControl::OnSetObjectRects

呼び出しを実装するためにフレームワークによって呼び出されます[IOleInPlaceObject::SetObjectRects](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects)します。

```
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,
    LPCRECT lpRectClip);
```

### <a name="parameters"></a>パラメーター

*lpRectPos*<br/>
ポインターを`RECT`コントロールの新しい位置と、コンテナーとの相対サイズを示す構造体。

*lpRectClip*<br/>
ポインターを`RECT`コントロールのクリッピング四角形の領域を示す構造体。

### <a name="return-value"></a>戻り値

位置変更が受け入れられた場合、0 以外の場合それ以外の場合 0 を返します。

### <a name="remarks"></a>Remarks

既定の実装が自動的に再配置とコントロール ウィンドウのサイズ変更を処理し、TRUE を返します。

この関数の既定の動作を変更するには、この関数をオーバーライドします。

##  <a name="onshowtoolbars"></a>  COleControl::OnShowToolBars

コントロールの UI がアクティブになったときに、フレームワークによって呼び出されます。

```
virtual void OnShowToolBars();
```

### <a name="remarks"></a>Remarks

既定の実装では、何も行われません。

##  <a name="ontextchanged"></a>  COleControl::OnTextChanged

ストックのキャプションまたはテキストのプロパティ値が変更されたときに、フレームワークによって呼び出されます。

```
virtual void OnTextChanged();
```

### <a name="remarks"></a>Remarks

既定の実装`InvalidateControl`します。

このプロパティの変更後の通知を使用する場合は、この関数をオーバーライドします。

##  <a name="onwindowlessmessage"></a>  COleControl::OnWindowlessMessage

コンテナーの応答にフレームワークによって呼び出されます`IOleInPlaceObjectWindowless::OnWindowMessage`要求。

```
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```

### <a name="parameters"></a>パラメーター

*msg*<br/>
Windows で渡されるメッセージの識別子です。

*wParam*<br/>
Windows で渡される。 追加のメッセージに固有の情報を指定します。 このパラメーターの内容は、の値によって異なります、 *msg*パラメーター。

*lParam*<br/>
Windows で渡される。 追加のメッセージに固有の情報を指定します。 このパラメーターの内容は、の値によって異なります、 *msg*パラメーター。

*plResult*<br/>
Windows の結果コード。 メッセージの処理の結果を指定し、送信メッセージに依存します。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

ウィンドウなしのコントロールのウィンドウ メッセージを処理します。 `COleControl``OnWindowlessMessage`マウス メッセージと、キーボード メッセージ以外のウィンドウ メッセージを処理するために使用する必要があります。 `COleControl` 提供[SetCapture](#setcapture)と[SetFocus](#setfocus)ウィンドウなしの OLE オブジェクトのマウスのキャプチャとキーボード フォーカスを取得するには、具体的には。

ウィンドウなしのオブジェクトは、ウィンドウがあるないために、コンテナー メッセージをディスパッチできるようにするためのメカニズムが必要です。 ウィンドウなしの OLE オブジェクトのメッセージから、コンテナーからのを通じて取得、`OnWindowMessage`メソッドを`IOleInPlaceObjectWindowless`インターフェイス (拡張機能の[IOleInPlaceObject](/windows/desktop/api/oleidl/nn-oleidl-ioleinplaceobject)ウィンドウなしのサポート)。 `OnWindowMessage` 受け取らない、`HWND`パラメーター。

##  <a name="parenttoclient"></a>  COleControl::ParentToClient

座標を変換*pPoint*クライアント座標にします。

```
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;
```

### <a name="parameters"></a>パラメーター

*lprcBounds*<br/>
コンテナー内の OLE コントロールの境界へのポインター。 クライアント領域ではありませんが、領域の境界線とスクロール バーを含むコントロール全体。

*pPoint*<br/>
親 (コンテナー) へのポインターは、コントロールのクライアント領域の座標に変換 をポイントします。

*bHitTest*<br/>
ポイントで実行するかどうかは、ヒット テストを指定します。

### <a name="return-value"></a>戻り値

場合*bHitTest* false、HTNOWHERE を返します。 場合*bHitTest* OLE コントロールのクライアント領域内に着陸した親 (コンテナー) をポイントする場所を返します、ヒット テストの値は、次のマウスの 1 つは TRUE です。

- HTBORDER サイズ変更境界がないウィンドウの境界線にします。

- HTBOTTOM ウィンドウの下の水平方向の境界線にします。

- HTBOTTOMLEFT ウィンドウの境界線の左下隅にします。

- HTBOTTOMRIGHT ウィンドウの枠線の右上隅にあるのです。

- HTCAPTION タイトル バー領域では。

- HTCLIENT クライアント領域では。

- HTERROR 画面の背景上または windows 間の区切り線 (いる点を除き、HTNOWHERE と同じ、 `DefWndProc` Windows 関数がエラーを示す、システムのビープ音が生成されます)。

- HTGROWBOX サイズ ボックスでは。

- HTHSCROLL 水平スクロール バーにします。

- HTLEFT、ウィンドウの左境界線にします。

- HTMAXBUTTON を最大限にボタンをクリックします。

- HTMENU メニュー領域では。

- HTMINBUTTON、最小限のボタンをクリックします。

- 画面の背景で HTNOWHERE または windows 間の区切り線。

- HTREDUCE、最小限のボタンをクリックします。

- HTRIGHT、ウィンドウの右境界線にします。

- HTSIZE (HTGROWBOX と同じ) [サイズ] ボックスには。

- HTSYSMENU コントロールのメニューまたは子ウィンドウの閉じるボタンをクリックします。

- HTTOP ウィンドウの上部の水平方向の境界線にします。

- HTTOPLEFT ウィンドウの境界線の左上隅にします。

- HTTOPRIGHT ウィンドウの枠線の右上隅にします。

- HTTRANSPARENT 現在別のウィンドウでカバー ウィンドウでは。

- HTVSCROLL 垂直スクロール バーにします。

- HTZOOM を最大限にボタンをクリックします。

### <a name="remarks"></a>Remarks

入力に*pPoint*親 (コンテナーの左上隅) の配信元に対する相対パスです。 出力で*pPoint* (コントロールのクライアント領域の左上隅) の OLE コントロールのクライアント領域の原点に対する相対パスです。

##  <a name="postmodaldialog"></a>  COleControl::PostModalDialog

モーダル ダイアログ ボックスが閉じられたことをコンテナーに通知します。

```
void PostModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>パラメーター

*hWndParent*<br/>
モーダル ダイアログ ボックスの親ウィンドウへのハンドルします。

### <a name="remarks"></a>Remarks

任意のモーダル ダイアログ ボックスを表示した後、この関数を呼び出します。 コンテナーがで無効になって、最上位ウィンドウを有効にするように、この関数を呼び出す必要があります`PreModalDialog`します。 この関数への呼び出しとペアリングする必要があります`PreModalDialog`します。

##  <a name="premodaldialog"></a>  COleControl::PreModalDialog

モーダル ダイアログ ボックスが表示されるコンテナーに通知します。

```
void PreModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>パラメーター

*hWndParent*<br/>
モーダル ダイアログ ボックスの親ウィンドウへのハンドルします。

### <a name="remarks"></a>Remarks

任意のモーダル ダイアログ ボックスを表示する前に、この関数を呼び出します。 その最上位レベルのすべての windows コンテナーを無効にするために、この関数を呼び出す必要があります。 次に呼び出す必要があるモーダル ダイアログ ボックスが表示された後`PostModalDialog`します。

##  <a name="recreatecontrolwindow"></a>  COleControl::RecreateControlWindow

破棄し、コントロールのウィンドウを再作成します。

```
void RecreateControlWindow();
```

### <a name="remarks"></a>Remarks

ウィンドウのスタイル ビットを変更する必要がある場合は、必要があります。

##  <a name="refresh"></a>  COleControl::Refresh

OLE コントロールの再描画を強制します。

```
void Refresh();
```

### <a name="remarks"></a>Remarks

この関数はサポート、`COleControl`更新と呼ばれる、ストック メソッドとして基本クラス。 これにより、特定の時点でコントロールを再描画 OLE コントロールのユーザーができます。 このメソッドの詳細については、記事を参照してください。 [ActiveX コントロール。メソッド](../../mfc/mfc-activex-controls-methods.md)します。

##  <a name="releasecapture"></a>  COleControl::ReleaseCapture

マウスのキャプチャを解放します。

```
BOOL ReleaseCapture();
```

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

コントロールがマウス キャプチャ現在を持つキャプチャは解放されます。 それ以外の場合、この関数には影響はありません。

##  <a name="releasedc"></a>  COleControl::ReleaseDC

他のアプリケーションで使用するためのデバイス コンテキストを解放する、ウィンドウなしのコントロールのコンテナーのディスプレイ デバイス コンテキストを解放します。

```
int ReleaseDC(CDC* pDC);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
解放するコンテナーのデバイス コンテキストを識別します。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

アプリケーションを呼び出す必要があります`ReleaseDC`呼び出しごとに[GetDC](#getdc)します。

##  <a name="reparentcontrolwindow"></a>  COleControl::ReparentControlWindow

コントロールの親を設定します。

```
virtual void ReparentControlWindow(
    HWND hWndOuter,
    HWND hWndParent);
```

### <a name="parameters"></a>パラメーター

*hWndOuter*<br/>
コントロール ウィンドウのハンドル。

*hWndParent*<br/>
新しい親ウィンドウのハンドル。

### <a name="remarks"></a>Remarks

コントロール ウィンドウの親をリセットするには、この関数を呼び出します。

##  <a name="resetstockprops"></a>  COleControl::ResetStockProps

状態を初期化、`COleControl`ストック プロパティを既定値。

```
void ResetStockProps();
```

### <a name="remarks"></a>Remarks

次のプロパティです。外観、背景色、BorderStyle、キャプション、Enabled、フォント、ForeColor、hWnd では、およびテキスト。 ストック プロパティの説明は、次を参照してください。 [ActiveX コントロール。ストック プロパティの追加](../../mfc/mfc-activex-controls-adding-stock-properties.md)します。

使用して、コントロールの初期化のバイナリのパフォーマンスを向上できます`ResetStockProps`と`ResetVersion`をオーバーライドする`COleControl::OnResetState`します。 下記の例を参照してください。 初期化の最適化の詳細については、次を参照してください。 [ActiveX コントロール。最適化](../../mfc/mfc-activex-controls-optimization.md)します。

### <a name="example"></a>例

[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]

##  <a name="resetversion"></a>  COleControl::ResetVersion

指定された値にバージョン番号を初期化します。

```
void ResetVersion(DWORD dwVersionDefault);
```

### <a name="parameters"></a>パラメーター

*dwVersionDefault*<br/>
コントロールに割り当てられるバージョン番号です。

### <a name="remarks"></a>Remarks

使用して、コントロールの初期化のバイナリのパフォーマンスを向上できます`ResetVersion`と`ResetStockProps`をオーバーライドする`COleControl::OnResetState`します。 例を参照してください。 [ResetStockProps](#resetstockprops)します。 初期化の最適化の詳細については、次を参照してください。 [ActiveX コントロール。最適化](../../mfc/mfc-activex-controls-optimization.md)します。

##  <a name="scrollwindow"></a>  COleControl::ScrollWindow

ウィンドウなしの画面に、インプレース アクティブ イメージ内の領域をスクロールする OLE オブジェクトを使用します。

```
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>パラメーター

*xAmount*<br/>
水平方向のスクロールのデバイス単位の量を指定します。 このパラメーターは、左にスクロールする負の値を指定する必要があります。

*yAmount*<br/>
垂直方向のスクロールのデバイス単位の量を指定します。 このパラメーターは、上へスクロールする負の値を指定する必要があります。

*lpRect*<br/>
指す、 [CRect](../../atl-mfc-shared/reference/crect-class.md)オブジェクトまたはウィンドウのクライアント座標で OLE オブジェクトのクライアント領域のスクロールの部分を指定する RECT 構造体。 場合*lpRect*が null の場合、全体の OLE オブジェクトのクライアント領域をスクロールします。

*lpClipRect*<br/>
指す、`CRect`オブジェクトまたは`RECT`へのクリップ四角形を指定します。 四角形の内側 (ピクセル) をスクロールします。 四角形の外側のビットである場合でも、 *lpRect*四角形。 場合*lpClipRect*が null の場合、スクロール バーの四角形の領域は実行されません。

##  <a name="selectfontobject"></a>  COleControl::SelectFontObject

デバイス コンテキスト、フォントを選択します。

```
CFont* SelectFontObject(
    CDC* pDC,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
デバイス コンテキスト オブジェクトへのポインター。

*fontHolder*<br/>
参照、 [CFontHolder](../../mfc/reference/cfontholder-class.md)を選択できるフォントを表すオブジェクト。

### <a name="return-value"></a>戻り値

以前に選択したフォントへのポインター。 呼び出し元が使用するすべての描画操作を完了すると*fontHolder、* へのパラメーターとして渡すことによって、以前に選択したフォントがもう一度選択する必要があります[cdc::selectobject](../../mfc/reference/cdc-class.md#selectobject)します。

##  <a name="selectstockfont"></a>  COleControl::SelectStockFont

デバイス コンテキストには、ストック フォント プロパティを選択します。

```
CFont* SelectStockFont(CDC* pDC);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
フォントの選択先デバイス コンテキスト。

### <a name="return-value"></a>戻り値

以前に選択したへのポインター`CFont`オブジェクト。 使用する必要があります[cdc::selectobject](../../mfc/reference/cdc-class.md#selectobject)が完了したら、デバイス コンテキストにこのフォントを選択します。

##  <a name="serializeextent"></a>  COleControl::SerializeExtent

シリアル化またはコントロールに割り当てられた時間表示領域の状態を初期化します。

```
void SerializeExtent(CArchive& ar);
```

### <a name="parameters"></a>パラメーター

*ar*<br/>
A`CArchive`またはからにシリアル化するオブジェクト。

### <a name="remarks"></a>Remarks

使用して、コントロールのバイナリの永続化のパフォーマンスを向上できます`SerializeExtent`、 `SerializeStockProps`、および`SerializeVersion`をオーバーライドする`COleControl::Serialize`します。 下記の例を参照してください。 初期化の最適化の詳細については、次を参照してください。 [ActiveX コントロール。最適化](../../mfc/mfc-activex-controls-optimization.md)します。

### <a name="example"></a>例

[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]

##  <a name="serializestockprops"></a>  COleControl::SerializeStockProps

シリアル化の状態を初期化します。 または、`COleControl`ストック プロパティ。外観、BackColor、BorderStyle、キャプション、有効になっている、フォント、前景色、およびテキスト。

```
void SerializeStockProps(CArchive& ar);
```

### <a name="parameters"></a>パラメーター

*ar*<br/>
A`CArchive`またはからにシリアル化するオブジェクト。

### <a name="remarks"></a>Remarks

ストック プロパティの説明は、次を参照してください。 [ActiveX コントロール。ストック プロパティの追加](../../mfc/mfc-activex-controls-adding-stock-properties.md)します。

使用して、コントロールのバイナリの永続化のパフォーマンスを向上できます`SerializeStockProps`、 `SerializeExtent`、および`SerializeVersion`をオーバーライドする`COleControl::Serialize`します。 例については、コードを参照してください。 [SerializeExtent](#serializeextent)します。 初期化の最適化の詳細については、次を参照してください。 [ActiveX コントロール。最適化](../../mfc/mfc-activex-controls-optimization.md)します。

##  <a name="serializeversion"></a>  COleControl::SerializeVersion

シリアル化またはコントロールのバージョン情報の状態を初期化します。

```
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>パラメーター

*ar*<br/>
A`CArchive`またはからにシリアル化するオブジェクト。

*dwVersionDefault*<br/>
コントロールの現在のバージョン番号。

*bConvert*<br/>
保存、または読み込まれた時と同じ形式で保持されるときに、永続的なデータが最新の形式に変換されるかどうかを示します。

### <a name="return-value"></a>戻り値

コントロールのバージョン番号。 指定されたアーカイブを読み込んでいる場合`SerializeVersion`アーカイブから読み込まれたバージョンを返します。 それ以外の場合、現在読み込まれているバージョンを返します。

### <a name="remarks"></a>Remarks

使用して、コントロールのバイナリの永続化のパフォーマンスを向上できます`SerializeVersion`、 `SerializeExtent`、および`SerializeStockProps`をオーバーライドする`COleControl::Serialize`します。 例については、コードを参照してください。 [SerializeExtent](#serializeextent)します。 初期化の最適化の詳細については、次を参照してください。 [ActiveX コントロール。最適化](../../mfc/mfc-activex-controls-optimization.md)します。

##  <a name="setappearance"></a>  COleControl::SetAppearance

コントロールの株価の外観プロパティの値を設定します。

```
void SetAppearance (short sAppearance);
```

### <a name="parameters"></a>パラメーター

*sAppearance*<br/>
A**短い**コントロールの外観に使用する (VT_I2) 値。 ゼロの値がフラットにコントロールの外観を設定し、値 1 は 3d コントロールの外観を設定します。

### <a name="remarks"></a>Remarks

詳細については、ストック プロパティは、次を参照してください。 [ActiveX コントロール。プロパティ](../../mfc/mfc-activex-controls-properties.md)します。

##  <a name="setbackcolor"></a>  COleControl::SetBackColor

コントロールの株価 BackColor プロパティの値を設定します。

```
void SetBackColor(OLE_COLOR dwBackColor);
```

### <a name="parameters"></a>パラメーター

*dwBackColor*<br/>
コントロールの描画の背景に使用する OLE_COLOR 値。

### <a name="remarks"></a>Remarks

このプロパティおよびその他の使用方法については関連のプロパティは、記事をご覧ください。 [ActiveX コントロール。プロパティ](../../mfc/mfc-activex-controls-properties.md)します。

##  <a name="setborderstyle"></a>  COleControl::SetBorderStyle

コントロールの株価 BorderStyle プロパティの値を設定します。

```
void SetBorderStyle(short sBorderStyle);
```

### <a name="parameters"></a>パラメーター

*sBorderStyle*<br/>
新しいコントロールの境界線のスタイル0 境界線なし、1 は、通常の境界線をことを示します。

### <a name="remarks"></a>Remarks

コントロールのウィンドウが再作成しして`OnBorderStyleChanged`と呼ばれます。

##  <a name="setcapture"></a>  COleControl::SetCapture

コントロールの代わりに、マウス キャプチャを所有しているを実行するコントロールのコンテナーのウィンドウをによりします。

```
CWnd* SetCapture();
```

### <a name="return-value"></a>戻り値

ポインター、`CWnd`マウス入力が以前に受信ウィンドウ オブジェクト。

### <a name="remarks"></a>Remarks

コントロールがアクティブ化およびウィンドウなしの場合は、この関数は、コントロールの代わりに、マウス キャプチャを所有しているを実行するコントロールのコンテナーのウィンドウをによりします。 それ以外の場合、この関数は、コントロール自体をマウスのキャプチャを所有しているを (同じ`CWnd::SetCapture`)。

##  <a name="setcontrolsize"></a>  COleControl::SetControlSize

OLE コントロール ウィンドウのサイズを設定し、コンテナー コントロールのサイトが変更されていることを通知します。

```
BOOL SetControlSize(int cx, int cy);
```

### <a name="parameters"></a>パラメーター

*cx*<br/>
コントロールの新しい幅をピクセル単位で指定します。

*cy*<br/>
コントロールの新しい高さをピクセル単位で指定します。

### <a name="return-value"></a>戻り値

呼び出しが成功した場合、0 以外の場合それ以外の場合 0 を返します。

### <a name="remarks"></a>Remarks

コントロールのコンス トラクターで、この関数を使用しない必要があります。

Windows のコントロールのすべての座標は、コントロールの左上隅に対して相対的ことに注意してください。

##  <a name="setenabled"></a>  COleControl::SetEnabled

在庫、コントロールの Enabled プロパティの値を設定します。

```
void SetEnabled(BOOL bEnabled);
```

### <a name="parameters"></a>パラメーター

*bEnabled*<br/>
コントロールが有効にする場合は TRUE。それ以外の場合は FALSE です。

### <a name="remarks"></a>Remarks

このプロパティを設定した後は`OnEnabledChange`が呼び出されます。

##  <a name="setfocus"></a>  COleControl::SetFocus

コントロールの代わりに入力フォーカスを所有しているを実行するコントロールのコンテナーのウィンドウをによりします。

```
CWnd* SetFocus();
```

### <a name="return-value"></a>戻り値

ポインター、`CWnd`ウィンドウ オブジェクト以前に入力フォーカス、またはこのようなウィンドウがない場合は NULL です。

### <a name="remarks"></a>Remarks

コントロールがアクティブ化およびウィンドウなしの場合は、この関数は、コントロールの代わりに、入力フォーカスを所有しているを実行するコントロールのコンテナーのウィンドウをによりします。 入力フォーカスがコンテナーのウィンドウにキーボード入力を指示し、コンテナーを呼び出す OLE オブジェクトにすべての後続のキーボード メッセージをディスパッチする`SetFocus`します。 入力フォーカスを持っていた任意のウィンドウでは、それが失われます。

この関数が、コントロール自体を入力フォーカスを受け取ると、コントロールがウィンドウなしでない場合 (同じ`CWnd::SetFocus`)。

##  <a name="setfont"></a>  COleControl::SetFont

コントロールのストック フォント プロパティを設定します。

```
void SetFont(LPFONTDISP pFontDisp);
```

### <a name="parameters"></a>パラメーター

*pFontDisp*<br/>
フォントのディスパッチ インターフェイスへのポインター。

##  <a name="setforecolor"></a>  COleControl::SetForeColor

コントロールの株価の前景色プロパティの値を設定します。

```
void SetForeColor(OLE_COLOR dwForeColor);
```

### <a name="parameters"></a>パラメーター

*dwForeColor*<br/>
前景、コントロールの描画に使用する OLE_COLOR 値。

### <a name="remarks"></a>Remarks

このプロパティおよびその他の使用方法については関連のプロパティは、記事をご覧ください。 [ActiveX コントロール。プロパティ](../../mfc/mfc-activex-controls-properties.md)します。

##  <a name="setinitialdataformats"></a>  COleControl::SetInitialDataFormats

コントロールによってサポートされるデータ形式のリストを初期化するためにフレームワークによって呼び出されます。

```
virtual void SetInitialDataFormats();
```

### <a name="remarks"></a>Remarks

既定の実装では、2 つの形式を指定します。CF_METAFILEPICT と永続的なプロパティを設定します。

##  <a name="setinitialsize"></a>  COleControl::SetInitialSize

コンテナーで最初に表示されるときの OLE コントロールのサイズを設定します。

```
void SetInitialSize(
    int cx,
    int cy);
```

### <a name="parameters"></a>パラメーター

*cx*<br/>
ピクセル単位での OLE コントロールの初期の幅。

*cy*<br/>
ピクセル単位での OLE コントロールの初期の高さ。

### <a name="remarks"></a>Remarks

コントロールの初期サイズを設定するコンス トラクターには、この関数を呼び出します。 初期サイズは、デバイス単位 (ピクセル) で測定されます。 コントロールのコンス トラクターにこの呼び出しが行われたことをお勧めします。

##  <a name="setmodifiedflag"></a>  COleControl::SetModifiedFlag

コントロールの変更の状態を変更します。

```
void SetModifiedFlag(BOOL bModified = TRUE);
```

### <a name="parameters"></a>パラメーター

*bModified*<br/>
コントロールの新しい値のフラグを変更します。 TRUE は、コントロールの状態が変更されたことを示しますFALSE は、コントロールの状態が保存だけであることを示します。

### <a name="remarks"></a>Remarks

コントロールの永続的な状態に影響する変更が発生するたびに、この関数は呼び出し。 たとえば、永続的なプロパティの値が変更された場合では、この関数を呼び出す*bModified* **TRUE**します。

##  <a name="setnotpermitted"></a>  COleControl::SetNotPermitted

編集要求が失敗したことを示します。

```
void SetNotPermitted();
```

### <a name="remarks"></a>Remarks

この関数を呼び出すときに`BoundPropertyRequestEdit`は失敗します。 この関数は、型の例外をスローします。`COleDispScodeException`を示す設定操作が許可されていません。

##  <a name="setnotsupported"></a>  COleControl::SetNotSupported

ユーザーがコントロールのプロパティの値を変更できないようにします。

```
void SetNotSupported();
```

### <a name="remarks"></a>Remarks

コントロールのユーザーがプロパティの値の変更はサポートされていない任意のプロパティの Set 関数の代わりに、この関数を呼び出します。 1 つの例には、読み取り専用プロパティがあります。

##  <a name="setrectincontainer"></a>  COleControl::SetRectInContainer

デバイス単位で表される、コンテナーを基準として、コントロールの四角形の座標を設定します。

```
BOOL SetRectInContainer(LPCRECT lpRect);
```

### <a name="parameters"></a>パラメーター

*lpRect*<br/>
コンテナーに対するコントロールの新しい座標を含む四角形へのポインター。

### <a name="return-value"></a>戻り値

呼び出しが成功した場合、0 以外の場合それ以外の場合 0 を返します。

### <a name="remarks"></a>Remarks

コントロールが開いている場合、サイズを変更します。それ以外の場合、コンテナーの`OnPosRectChanged`関数が呼び出されます。

##  <a name="settext"></a>  COleControl::SetText

コントロールのキャプションまたはテキスト ストック プロパティの値を設定します。

```
void SetText(LPCTSTR pszText);
```

### <a name="parameters"></a>パラメーター

*pszText*<br/>
文字の文字列へのポインター。

### <a name="remarks"></a>Remarks

ストックのキャプションとテキストのプロパティが両方にマップされる、同じ値に注意してください。 つまり、いずれかのプロパティに加えられた変更は、両方のプロパティに自動的に変更されます。 一般に、コントロールでは、在庫キャプションまたはテキストのプロパティの両方ではなくいずれかをサポートする必要があります。

##  <a name="throwerror"></a>  COleControl::ThrowError

コントロールでエラーの発生を通知します。

```
void ThrowError(
    SCODE sc,
    UINT nDescriptionID,
    UINT nHelpID = -1);

void ThrowError(
    SCODE sc,
    LPCTSTR pszDescription = NULL,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>パラメーター

*sc*<br/>
報告されるステータス コード値。 可能なコードの完全な一覧は、記事を参照してください。 [ActiveX コントロール。トピックを advanced](../../mfc/mfc-activex-controls-advanced-topics.md)します。

*nDescriptionID*<br/>
報告されることを例外の文字列リソース ID。

*nHelpID*<br/>
報告されるトピックのヘルプ ID です。

*pszDescription*<br/>
報告する例外の説明を含む文字列。

### <a name="remarks"></a>Remarks

この関数のみから呼び出すことは、Get または Set 関数内で OLE プロパティ、または OLE オートメーションのメソッドの実装。 それ以外の場合に発生するエラーを通知する必要がある場合は、ストックのエラー イベントを起動する必要があります。

##  <a name="transformcoords"></a>  COleControl::TransformCoords

HIMETRIC 単位と、コンテナーのネイティブな単位の座標を変換します。

```
void TransformCoords(
    POINTL* lpptlHimetric,
    POINTF* lpptfContainer,
    DWORD flags);
```

### <a name="parameters"></a>パラメーター

*lpptlHimetric*<br/>
ポインター、 `POINTL` HIMETRIC 単位の座標を含む構造体。

*lpptfContainer*<br/>
ポインターを`POINTF`コンテナーの単位サイズでの座標を含む構造体。

*flags*<br/>
次の値の組み合わせです。

- コンテナー内の位置を XFORMCOORDS_POSITION A。

- コンテナーで XFORMCOORDS_SIZE A サイズ。

- コンテナーのユニットに XFORMCOORDS_HIMETRICTOCONTAINER 変換 HIMETRIC 単位です。

- コンテナーのユニットを HIMETRIC 単位を XFORMCOORDS_CONTAINERTOHIMETRIC に変換します。

### <a name="remarks"></a>Remarks

最初の 2 つのフラグ、XFORMCOORDS_POSITION および XFORMCOORDS_SIZE、座標は位置やサイズとして扱うかどうかを示します。 その他の 2 つのフラグは、変換の方向を示します。

##  <a name="translatecolor"></a>  COleControl::TranslateColor

OLE_COLOR データ型の色の値を変換、 [COLORREF](/windows/desktop/gdi/colorref)データ型。

```
COLORREF TranslateColor(
    OLE_COLOR clrColor,
    HPALETTE hpal = NULL);
```

### <a name="parameters"></a>パラメーター

*clrColor*<br/>
OLE_COLOR のデータ型です。 詳細については、Windows を参照してください。 [OleTranslateColor](/windows/desktop/api/olectl/nf-olectl-oletranslatecolor)関数。

*hpal*<br/>
オプションのパレットを識別するハンドルNULL にすることができます。

### <a name="return-value"></a>戻り値

32 ビットの色の RGB (赤、緑、青) 値、平面を定義するに最も近い色、 *clrColor*デバイスを表すことができます。

### <a name="remarks"></a>Remarks

この関数は、ストック前景色と背景色をプロパティによって使用される COLORREF 型に変換するために役立ちます[CDC](../../mfc/reference/cdc-class.md)メンバー関数。

##  <a name="willambientsbevalidduringload"></a>  COleControl::WillAmbientsBeValidDuringLoad

コントロールは、その後、永続的な状態から読み込まれるとき、ソース ファイルを既定値としてアンビエント プロパティの値を使用するかを判断します。

```
BOOL WillAmbientsBeValidDuringLoad();
```

### <a name="return-value"></a>戻り値

0 以外では、アンビエント プロパティを有効になることを示しますそれ以外の場合のアンビエント プロパティは無効になります。

### <a name="remarks"></a>Remarks

一部のコンテナーで、コントロールがない、アンビエント プロパティへのアクセスのオーバーライドの最初の呼び出し中に`COleControl::DoPropExchange`します。 これは、コンテナーを呼び出す場合、該当[IPersistStreamInit::Load](/windows/desktop/api/ocidl/nf-ocidl-ipersiststreaminit-load)または[機能として](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-load)呼び出す前に[IOleObject::SetClientSite](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-setclientsite) (そうでない場合は、OLEMISC_SETCLIENTSITEFIRST 状態のビットを優先)。

##  <a name="windowproc"></a>  COleControl::WindowProc

Windows の手順を説明する`COleControl`オブジェクト。

```
virtual LRESULT WindowProc(
    UINT message,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>パラメーター

*message*<br/>
処理する Windows メッセージを指定します。

*wParam*<br/>
メッセージの処理で使用される追加情報を提供します。 パラメーターの値は、メッセージに依存します。

*lParam*<br/>
メッセージの処理で使用される追加情報を提供します。 パラメーターの値は、メッセージに依存します。

### <a name="return-value"></a>戻り値

ディスパッチされたメッセージの戻り値。

### <a name="remarks"></a>Remarks

コントロールのメッセージ マップを通じて特定のメッセージをディスパッチするには、この関数を呼び出します。

## <a name="see-also"></a>関連項目

[MFC のサンプル CIRC3](../../overview/visual-cpp-samples.md)<br/>
[MFC サンプル TESTHELP](../../overview/visual-cpp-samples.md)<br/>
[COlePropertyPage クラス](../../mfc/reference/colepropertypage-class.md)<br/>
[CWnd クラス](../../mfc/reference/cwnd-class.md)<br/>
[階層図](../../mfc/hierarchy-chart.md)<br/>
[CFontHolder クラス](../../mfc/reference/cfontholder-class.md)<br/>
[CPictureHolder クラス](../../mfc/reference/cpictureholder-class.md)<br/>
