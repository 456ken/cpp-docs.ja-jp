---
title: 'チュートリアル: MFC によるリボン アプリケーションの作成'
ms.date: 11/04/2016
helpviewer_keywords:
- ribbon application, creating (MFC)
- creating a ribbon aplication (MFC)
ms.assetid: e61393e2-1d6b-4594-a7ce-157d3d1b0d9f
ms.openlocfilehash: 29991a389a09e1fe3dc0074b80fd9a255458f673
ms.sourcegitcommit: 72583d30170d6ef29ea5c6848dc00169f2c909aa
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/18/2019
ms.locfileid: "58781225"
---
# <a name="walkthrough-creating-a-ribbon-application-by-using-mfc"></a>チュートリアル: MFC によるリボン アプリケーションの作成

このチュートリアルで使用する方法、 **MFC アプリケーション ウィザード**を既定では、リボンを持つアプリケーションを作成します。 追加することで、リボンを拡張することができます、**カスタム**リボン カテゴリを持つ、**お気に入り**リボン パネル、およびよく使用される一部のコマンドをそのパネルを追加します。

## <a name="prerequisites"></a>必須コンポーネント

このチュートリアルは、使用する Visual Studio を設定することが前提としています。**汎用開発設定**します。 さまざまな設定を使用している場合は、次の手順で参照されるユーザー インターフェイス (UI) 要素の一部が表示されません。

### <a name="to-create-an-mfc-application-that-has-a-ribbon"></a>リボンを備えた MFC アプリケーションを作成するには

1. 使用して、 **MFC アプリケーション ウィザード**リボンを備えた MFC アプリケーションを作成します。 上に、ウィザードを実行する、**ファイル**メニューで、**新規**、 をクリックし、**プロジェクト**します。

1. **新しいプロジェクト** ダイアログ ボックスで、展開、 **Visual C**ノードの下**インストールされたテンプレート**を選択します**MFC**、しを選択します。**MFC アプリケーション**します。 たとえば、プロジェクトの名前を入力*MFCRibbonApp*、順にクリックします**OK**します。

1. 次のオプションを設定、 **MFC アプリケーション ウィザード**:

    1. **アプリケーションの種類**セクションの**視覚スタイルと色**、 **Office 2007 (青のテーマ)** します。

    1. **複合ドキュメント サポート**セクションで、必ず**None**が選択されています。

    1. **ドキュメント テンプレート プロパティ**セクションで、**ファイル拡張子**ボックスに、このアプリケーションを作成、たとえば、ドキュメントのファイル名拡張子を入力*mfcrbnapp*.

    1. **データベース サポート**セクションで、必ず**None**が選択されています。

    1. **ユーザー インターフェイス機能**セクションで、必ず**リボンを使用する**が選択されています。

    1. 既定で、 **MFC アプリケーション ウィザード**いくつかのドッキング ペインのサポートを追加します。 ただし、このチュートリアルで説明するのはリボンについてのみであるため、アプリケーションからこれらのオプションを削除します。 **高度な機能**セクションで、すべてのオプションをオフにします。

1. クリックして**完了**MFC アプリケーションを作成します。

1. アプリケーションが正常に作成されたことを確認するために、アプリケーションをビルドして実行します。 アプリケーションを構築する、**ビルド** メニューのをクリックして**ソリューションのビルド**します。 場合は、アプリケーションが正常にビルド、実行をクリックして**デバッグの開始**上、**デバッグ**メニュー。

    名前は 1 つのリボン カテゴリを持つリボンを自動的に作成**ホーム**します。 このリボンには、名前は 3 つのリボン パネル**クリップボード**、**ビュー**、および**ウィンドウ**します。

### <a name="to-add-a-category-and-panel-to-the-ribbon"></a>カテゴリとパネルをリボンに追加するには

1. ウィザードが作成したリボン リソースを開く、**ビュー**メニューで、**その他の Windows**順にクリックします**リソース ビュー**します。 **リソース ビュー**、 をクリックして**リボン**し、ダブルクリック**IDR_RIBBON**します。

1. 最初をダブルクリックして、リボンにカスタム カテゴリを追加**カテゴリ**で、**ツールボックス**します。

    キャプションのあるカテゴリ**Category1**が作成されます。 既定では、カテゴリにはパネルが 1 つあります。

    右クリックして**Category1**  をクリックし、**プロパティ**します。 **プロパティ**ウィンドウで、変更**キャプション**に*カスタム*します。

    **Large Images**と**Small Images**プロパティは、このカテゴリのリボン要素のアイコンとして使用されるビットマップを指定します。 カスタムのビットマップの作成はこのチュートリアルの対象外であるため、ウィザードで作成されたビットマップをそのまま使用します。 小さいビットマップは 16 × 16 ピクセルです。 小さいイメージは、によってアクセスされるビットマップを使用して、`IDB_FILESMALL`リソース id です。 大きいビットマップは 32 × 32 ピクセルです。 大きいイメージは、によってアクセスされるビットマップを使用して、`IDB_FILELARGE`リソース id です。

    > [!NOTE]
    > 高解像度 (HDPI: High Dots per Inch) 表示では、HDPI 版のイメージが自動的に使用されます。

1. 次は、パネルをカスタマイズします。 パネルは、互いに論理的に関連する項目をグループ化するために使用されます。 たとえば、**ホーム**このアプリケーションのタブ、**切り取り**、**コピー**と**貼り付け**コマンドがすべて上に存在、 **クリップボード**パネル。 右パネルをカスタマイズする**Panel1**  をクリックし、**プロパティ**します。 **プロパティ**ウィンドウで、変更**キャプション**に*お気に入り*します。

    指定することができます、**イメージ インデックス**パネル。 この数に、リボン パネルが追加された場合に表示されるアイコンを指定します、**クイック アクセス ツールバー**します。 リボン パネルそのものにアイコンが表示されません。

1. リボンのカテゴリとパネルが正しく作成されたことを確認するために、リボン コントロールをプレビューします。 **Ribbon エディター ツールバー**、 をクリックして、 **ribbon のテスト**ボタンをクリックします。 A**カスタム** タブと**お気に入り**パネルをリボンに表示する必要があります。

### <a name="to-add-elements-to-the-ribbon-panels"></a>リボン パネルに要素を追加するには

1. 前の手順で作成したパネルに要素を追加するからコントロールをドラッグ、 **Ribbon エディター**のセクション、**ツールボックス**デザイン ビュー内のパネルにします。

1. 最初に、追加、**印刷**ボタンをクリックします。 **印刷**を含むサブメニューをあるボタンを**クイック印刷**通常使うプリンターを使用して出力するコマンド。 このアプリケーションに対して、両方のコマンドが既に定義されています。 [アプリケーション] メニュー、配置します。

    作成する、**印刷**ボタン、Button ツールをパネルにドラッグします。

    **プロパティ**ウィンドウで、変更、 **ID**プロパティを**ID_FILE_PRINT**、これは既に定義する必要があります。 変更**キャプション**に*印刷*します。 変更**イメージ インデックス**に*4*します。

    作成する、**クイック印刷**ボタン、プロパティの値列の横に **メニュー項目**、クリックして、省略記号 (**.**).**項目エディター**、ラベルのない**追加**メニュー項目を作成するボタンをクリックします。 **プロパティ**ウィンドウで、変更**キャプション**に*クイック印刷*、 **ID**に*ID_FILE_PRINT_DIRECT*、および**イメージ**に*5*します。 イメージのプロパティを指定します、**クイック印刷**アイコン、`IDB_FILESMALL`ビットマップ リソース。

1. ボタンがリボン パネルに追加されたことを確認するには、アプリケーションをビルドして実行します。 アプリケーションを構築する、**ビルド** メニューのをクリックして**ソリューションのビルド**します。 アプリケーションが正常にビルドする場合をクリックしてアプリケーションを実行**デバッグの開始**上、**デバッグ**メニュー。 **印刷**ボタンとコンボ ボックスに、**お気に入り**パネルで、**カスタム**リボンのタブを表示する必要があります。

## <a name="next-steps"></a>次の手順

[方法: クイック アクセス ツールバーをカスタマイズします。](../mfc/how-to-customize-the-quick-access-toolbar.md)

[方法: アプリケーション ボタンをカスタマイズします。](../mfc/how-to-customize-the-application-button.md)

エンド ツー エンドのサンプルを参照してください。[サンプル (MFC Feature Pack)](../overview/visual-cpp-samples.md)します。

## <a name="see-also"></a>関連項目

[チュートリアル](../mfc/walkthroughs-mfc.md)<br/>
[サンプル (MFC Feature Pack)](../overview/visual-cpp-samples.md)
