---
title: オートメーション サーバー
ms.date: 11/04/2016
helpviewer_keywords:
- Automation servers
- COM components, Automation servers
- dispatch maps [MFC], Automation servers
- servers, Automation
ms.assetid: 523fd155-51ce-4f91-b986-b74bdbdd7d92
ms.openlocfilehash: 39e870db2f5476a630a8ed3bc68944dbb164d469
ms.sourcegitcommit: 0ab61bc3d2b6cfbd52a16c6ab2b97a8ea1864f12
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "62374169"
---
# <a name="automation-servers"></a>オートメーション サーバー

Automation により、別のアプリケーションで実装されているオブジェクトを操作する、または操作できるようにするオブジェクトを公開するアプリケーション。 オートメーション サーバー (オートメーション オブジェクトと呼ばれます)、プログラミング可能なオブジェクトを他のアプリケーションに公開するアプリケーションとは (と呼ばれる[オートメーション クライアント](../mfc/automation-clients.md))。 オートメーション サーバーは、オートメーションのコンポーネントとも呼ばれます。

オートメーション オブジェクトを公開することにより、クライアントは、オブジェクトへの直接アクセスして特定の手順を自動化して、サーバーの機能が使用できるようにします。 アプリケーションが他のアプリケーションに役立つ機能を備えている場合は、このようにオブジェクトを公開すると便利です。 たとえば、ワード プロセッサは、他のプログラムで使用できるように、スペル チェック機能を公開可能性があります。 オブジェクトを公開できるよう他のアプリケーションの既製の機能を使用してそのアプリケーションの機能を向上させるためにベンダー。

これらのオートメーション オブジェクトは、外部インターフェイスとしてのプロパティとメソッドがあります。 プロパティには、オートメーション オブジェクトの属性は名前付き。 プロパティは、C++ クラスのデータ メンバーと同様にします。 メソッドは、オートメーション オブジェクトを操作する関数です。 メソッドでは、C++ クラスのパブリック メンバー関数と同様です。

> [!NOTE]
>  プロパティは、C++ のデータ メンバーのようには、直接アクセスすることはありません。 透過的なアクセスを提供するには、それらにアクセスするオートメーション オブジェクトを取得/設定メンバー関数のペアの内部変数を設定します。

一般的で適切に定義されたインターフェイスを介してアプリケーションの機能を公開すると、自動化できるようになります、単一の汎用言語の代わりに Microsoft Visual Basic のように、アプリケーション固有のさまざまなマクロ内でアプリケーションを構築言語。

##  <a name="_core_support_for_automation_servers"></a> オートメーション サーバー用のサポート

Visual C と MFC フレームワークは、オートメーション サーバーの広範なサポートを提供します。 アプリケーションの機能に、作業を集中できるように、オートメーション サーバーを行うにはオーバーヘッドの多くを処理します。

オートメーションをサポートするためのフレームワークのプリンシパル メカニズムは、ディスパッチ マップ、宣言と OLE のメソッドとプロパティを公開するために必要な呼び出しに展開されるマクロのセットです。 典型的なディスパッチ マップのようになります。

[!code-cpp[NVC_MFCAutomation#1](../mfc/codesnippet/cpp/automation-servers_1.cpp)]

プロパティ ウィンドウと クラス ビューは、ディスパッチ マップの管理に役立ちます。 Visual C では、対応する追加クラスに新しいメソッドまたはプロパティを追加すると`DISP_FUNCTION`または`DISP_PROPERTY`マクロ クラス名、メソッドやプロパティ、およびデータ型の外部および内部の名前を示すパラメーターを使用します。

**クラスの追加** ダイアログ ボックスは、オートメーション クラスの宣言とそのプロパティと操作の管理も簡素化します。 プロジェクトにクラスを追加するクラスの追加 ダイアログ ボックスを使用する場合は、その基本クラスを指定します。 クラスの追加 ダイアログ ボックスに、新しいクラスがオートメーションをサポートするかどうかを指定する"OLE 作成可能な"(つまり、かどうか、クラスのオブジェクト作成できます COM クライアントからの要求に基づいて) があるかどうかを使用するコントロールが表示されます、基底クラスは、オートメーションを許可している場合、および COM クライアントが使用する外部の名前。

**クラスの追加** ダイアログ ボックスは、クラス宣言を作成し、OLE の機能するのに適切なマクロを含む指定しました。 また、クラスのメンバー関数の実装用のスケルトン コードを追加します。

MFC アプリケーション ウィザードでは、地上からオートメーション サーバー アプリケーションを取得するための手順が簡略化します。 選択した場合、 **Automation**のチェック ボックスを**高度な機能**] ページの [MFC アプリケーション ウィザードをアプリケーションに追加`InitInstance`関数、オートメーションを登録するために必要な呼び出しオブジェクトし、オートメーション サーバー アプリケーションを実行します。

### <a name="what-do-you-want-to-do"></a>どうしたいんですか

- [オートメーション クライアントについて説明します](../mfc/automation-clients.md)

- [CCmdTarget クラスを詳細します。](../mfc/reference/ccmdtarget-class.md)

- [COleDispatchDriver クラスを詳細します。](../mfc/reference/coledispatchdriver-class.md)

## <a name="see-also"></a>関連項目

[オートメーション](../mfc/automation.md)<br/>
[MFC アプリケーション ウィザード](../mfc/reference/mfc-application-wizard.md)
