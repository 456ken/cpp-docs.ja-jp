---
title: Visual Studio で C/C++ Dll を作成します。
ms.date: 12/10/2018
helpviewer_keywords:
- executable files [C++]
- dynamic linking [C++]
- linking [C++], dynamic vs. static
- DLLs [C++]
- DLLs [C++], about DLLs
ms.assetid: 5216bca4-51e2-466b-b221-0e3e776056f0
ms.openlocfilehash: 5bd30c84ba202c3f772ad4451368efde10285e6c
ms.sourcegitcommit: 0ab61bc3d2b6cfbd52a16c6ab2b97a8ea1864f12
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "62195463"
---
# <a name="create-cc-dlls-in-visual-studio"></a>Visual Studio で C/C++ Dll を作成します。

Windows では、ダイナミック リンク ライブラリ (DLL) はある種の関数とリソースの共有ライブラリとして機能する実行可能ファイルです。 関数を呼び出すか、別のファイルに格納されているリソースを使用する実行可能ファイルを使用するオペレーティング システムの機能は、動的リンクします。 これらの関数とリソースはコンパイルできるだけでなく、これらを使用する実行可能ファイルとは別に配置することができます。 DLL がないスタンドアロン実行可能ファイルです。これを呼び出すアプリケーションのコンテキストで実行されます。 オペレーティング システムは、アプリケーションが読み込まれるときに、アプリケーションのメモリ領域の DLL を読み込むことができます (*暗黙的リンク*)、または実行時にオンデマンドで (*明示的リンク*)。 また、DLL は、実行可能ファイル間で関数とリソースを共有しやすくします。 メモリ内の DLL の内容には、同時に複数のアプリケーションがアクセスできます。

## <a name="differences-between-dynamic-linking-and-static-linking"></a>動的リンクと、静的リンク間の違い

静的リンク オブジェクトのすべてのコードをスタティック ライブラリで構築されているときに使用できる実行可能ファイルにコピーします。 動的リンクには、Windows で実行時に検索して、データ項目または関数を含む DLL を読み込むために必要な情報のみが含まれています。 DLL を作成するときに、この情報を含むインポート ライブラリを作成します。 DLL を呼び出す実行可能ファイルをビルドすると、リンカーは、Windows ローダーは、この情報を格納するのにインポート ライブラリにエクスポートされたシンボルを使用します。 ローダーが DLL を読み込むときに、DLL は、アプリケーションのメモリ領域にマップされます。 存在する場合、特殊な関数、DLL `DllMain`DLL が必要です。 初期化を行うには呼び出されます。

<a name="differences-between-applications-and-dlls"></a>

## <a name="differences-between-applications-and-dlls"></a>アプリケーションと Dll の違い

Dll とアプリケーションは、両方の実行可能モジュールには、いくつかの方法が異なります。 ユーザーが、最も明白な違いは、Dll は直接実行できるアプリケーションではありません。 システム側から見ると、アプリケーションと DLL には次の 2 つの根本的な違いがあります。

- アプリケーションはシステム内で稼働する複数のインスタンスを同時に持つことができるのに対し、DLL のインスタンスは 1 つしかありません。

- など、スタック、スレッドの実行、グローバル メモリ、ファイル ハンドル、およびメッセージ キューを所有できるプロセスとしてアプリケーションを読み込むことができますが、DLL ことはできません。

<a name="advantages-of-using-dlls"></a>

## <a name="advantages-of-using-dlls"></a>Dll の利点

いくつかの利点を提供するコードとリソースに静的リンクではなく動的にリンクします。 DLL を使用すると、メモリ領域を節約し、スワップを低減できます。 複数のアプリケーションが DLL の 1 つのコピーを使用すると、ディスク領域とダウンロードの帯域幅を節約することができます。 DLL は、個別に配置および更新できます。これにより、すべてのコードのリビルドと出荷をしなくても、出荷後のサポートとソフトウェアの更新プログラムを提供することができます。 DLL は、ロケール固有のリソースを指定する便利な方法です。多言語のプログラムをサポートし、アプリケーションの各国語バージョンを簡単に作成することができます。 明示的リンクを許可するアプリケーションを検出し、新しい機能を提供する拡張機能など、実行時に Dll を読み込むことができます。

動的リンクには、以下の利点があります。

- 動的リンクと、メモリを節約し、スワップ処理を抑制します。 多くのプロセスでは、DLL を同時に使用できるため、メモリ内の DLL の読み取り専用の部分の 1 つのコピーを共有します。 これに対し、静的にリンクされたライブラリを使用して組み込まれているすべてのアプリケーションは、Windows がメモリに読み込む必要があるライブラリ コードの完全なコピーを保持します。

- 動的リンクには、ディスク領域と帯域幅が節約できます。 複数のアプリケーションが、ディスク上の DLL を共有できます。 これに対し、スタティック リンク ライブラリを使用してビルドされたアプリケーションより多くのディスク領域を使用し、転送する多くの帯域幅は、実行可能ファイル、イメージにリンクされているライブラリ コードがあります。

- メンテナンス、セキュリティの修正プログラムし、アップグレードが簡単になります。 アプリケーションでは、DLL 内で共通の関数を使用するときに関数の引数と戻り値は変更しない限り、限りできますバグの修正を実装し、DLL への更新プログラムの展開します。 Dll が更新されると、それらを使用するアプリケーションは、再コンパイルや再リンクすると、必要はありませんし、新しい DLL が展開されているとすぐに使用します。 これに対し、静的にリンクされたオブジェクト コードの修正には、再リンクして、それを使用するすべてのアプリケーションを再デプロイすることが必要です。

- 出荷のサポートを提供するのに Dll を使用することができます。 たとえば、アプリケーションの出荷時には利用できなかったディスプレイをサポートするよう、ディスプレイ ドライバー DLL を後から変更することもできます。 明示的リンクを使用して、Dll としてのアプリケーションの拡張機能を読み込むしを再構築または再デプロイせず、新しい機能をアプリに追加できます。

- 動的リンクすると、さまざまなプログラミング言語で記述されたアプリケーションをサポートしやすきます。 異なるプログラミング言語で書かれたプログラムでも、関数の呼び出し規則に従う限り、同じ DLL 関数を呼び出すことができます。 ただし、引数がスタックにプッシュされる順序、スタックのクリアをアプリケーションと関数のどちらが行うか、引数のレジスタ渡しの有無に関しては、使用する側のプログラムと DLL 関数の間に互換性が成立している必要があります。

- 動的リンクは、MFC ライブラリ クラスを拡張するためのメカニズムを提供します。 既存の MFC クラスの派生クラスを作成し、MFC アプリケーションから使用可能な MFC 拡張 DLL に配置できます。

- 動的リンクと、アプリケーションの各国語バージョンの作成が簡単にできます。 DLL のロケール固有のリソースを配置すると、アプリケーションの各国語バージョンを作成するはるかに簡単です。 多くのローカライズされたバージョンのアプリケーションを配布するには、代わりに別のリソース DLL に文字列と言語ごとにイメージを配置してし、アプリケーションが実行時にそのロケールの適切なリソースを読み込むことができます。

Dll を使用する潜在的なデメリットは、アプリケーションが自己完結していること配置またはインストールの一部として自分で確認する必要がある個別の DLL モジュールの存在に依存します。

## <a name="more-information-on-how-to-create-and-use-dlls"></a>作成して Dll を使用する方法の詳細について

次のトピックでは、Visual c dll のプログラミン方法に関する詳細を説明します。

[チュートリアル: ダイナミック リンク ライブラリの作成と使用 (C++)](walkthrough-creating-and-using-a-dynamic-link-library-cpp.md)<br/>
Visual Studio を使用して DLL を作成および使用する方法について説明します。

[DLL の種類](kinds-of-dlls.md)<br/>
ビルドできる各種 DLL に関する情報を提供します。

[DLL のよく寄せられる質問](dll-frequently-asked-questions.md)<br/>
DLL に関してよく寄せられる質問への回答を示します。

[実行可能ファイルと DLL のリンク](linking-an-executable-to-a-dll.md)<br/>
DLL との明示的なリンクと暗黙的なリンクについて説明します。

[DLL を初期化します。](run-time-library-behavior.md#initializing-a-dll)<br/>
DLL の読み込み時に実行する必要があります DLL の初期化コードをについて説明します。

[DLL と Visual C++ ランタイム ライブラリの動作](run-time-library-behavior.md)<br/>
ランタイム ライブラリで DLL の起動処理をどのように実行するかについて説明します。

[LoadLibrary と AfxLoadLibrary](loadlibrary-and-afxloadlibrary.md)<br/>
使用について説明**LoadLibrary**と`AfxLoadLibrary`実行時に DLL を明示的にリンクします。

[GetProcAddress](getprocaddress.md)<br/>
使用について説明**GetProcAddress** DLL でエクスポートされた関数のアドレスを取得します。

[FreeLibrary と AfxFreeLibrary](freelibrary-and-afxfreelibrary.md)<br/>
使用について説明**FreeLibrary**と`AfxFreeLibrary`DLL モジュールが不要になった場合。

[ダイナミック リンク ライブラリの検索順序](/windows/desktop/Dlls/dynamic-link-library-search-order)<br/>
Windows オペレーティング システムがシステム上の DLL を検索するために使用する検索パスについて説明します。

[MFC と動的にリンクされるレギュラー MFC DLL のモジュール状態](module-states-of-a-regular-dll-dynamically-linked-to-mfc.md)<br/>
MFC と動的にリンクされている MFC DLL の通常のモジュールの状態について説明します。

[MFC 拡張 DLL](extension-dlls-overview.md)<br/>
既存の MFC ライブラリ クラスから派生した再利用可能なクラスを主に実装する DLL について説明します。

[リソースのみの DLL の作成](creating-a-resource-only-dll.md)<br/>
アイコン、ビットマップ、文字列、ダイアログ ボックスなどのリソースだけを含む、リソースのみの DLL について説明します。

[MFC アプリケーションのローカライズされたリソース:サテライト DLL](localized-resources-in-mfc-applications-satellite-dlls.md)<br/>
混合言語にローカライズされるアプリケーションの作成に役立つ、サテライト DLL のサポートを強化します。

[インポートとエクスポート](importing-and-exporting.md)<br/>
アプリケーションへのパブリック シンボルのインポート、または DLL からの関数のエクスポートについて説明します。

[Active テクノロジと DLL](active-technology-and-dlls.md)<br/>
オブジェクト サーバーを DLL 内部に実装できます。

[DLL でのオートメーション](automation-in-a-dll.md)<br/>
MFC DLL ウィザードの [オートメーション] オプションについて説明します。

[MFC DLL の名前付け規則](../mfc/mfc-library-versions.md#mfc-static-library-naming-conventions)<br/>
MFC に含まれる DLL やライブラリに適用される一定の名前付け規則について説明します。

[Visual Basic アプリケーションから DLL 関数を呼び出す](calling-dll-functions-from-visual-basic-applications.md)<br/>
Visual Basic アプリケーションから DLL 関数を呼び出す方法について説明します。

## <a name="related-sections"></a>関連項目

[DLL の一部としての MFC の使用](../mfc/tn011-using-mfc-as-part-of-a-dll.md)<br/>
MFC ライブラリを Windows ダイナミック リンク ライブラリの一部として使用することができますが、レギュラー MFC Dll について説明します。

[MFC の DLL バージョン](../mfc/tn033-dll-version-of-mfc.md)<br/>
MFCxx.dll を使用して MFCxxD.dll (x は MFC のバージョン番号です) は、MFC アプリケーションや MFC 拡張 Dll とダイナミック リンク ライブラリを共有する方法について説明します。
