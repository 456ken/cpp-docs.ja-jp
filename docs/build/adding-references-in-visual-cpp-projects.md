---
title: ライブラリと C++ プロジェクト内のコンポーネントを利用します。
ms.date: 12/10/2018
f1_keywords:
- VC.Project.References
helpviewer_keywords:
- Add References Dialog Box (C++)
- .NET Framework (C++), Add References Dialog Box
ms.assetid: 12b8f571-0f21-40b3-9404-5318a57e9cb5
ms.openlocfilehash: eb4d970527ba919af10eadab7c907f5108767b9b
ms.sourcegitcommit: 5cecccba0a96c1b4ccea1f7a1cfd91f259cc5bde
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/01/2019
ms.locfileid: "58780471"
---
# <a name="consuming-libraries-and-components"></a>ライブラリとコンポーネントを利用します。

多くの場合、C++ プロジェクトは、関数を呼び出すか、スタティック ライブラリ (.lib ファイル) などのバイナリ ファイル内のデータにアクセスする必要があります。 DLL、Windows ランタイム コンポーネント、COM コンポーネント、または .NET アセンブリです。 このような場合は、ビルド時にバイナリを検索できるように、プロジェクトを構成する必要です。 具体的な手順は、バイナリの種類のプロジェクトの種類によって異なりますが、バイナリをプロジェクトと同じソリューションで構築されているかどうかとします。 

## <a name="consuming-libraries-downloaded-via-vcpkg"></a>Vcpkg を使用してダウンロードされたライブラリの使用

使用してダウンロードしたライブラリを使用する、 **vcpkg**パッケージ マネージャーでは、以下の手順を無視することができます。 「[vcpkg: Windows、Linux、MacOS 用の C++ パッケージ マネージャー](vcpkg.md#integrate-with-visual-studio-windows)詳細についてはします。

## <a name="consuming-static-libraries"></a>静的ライブラリの使用

スタティック ライブラリ プロジェクトが同じソリューションで構築される: 場合

1. #<a name="include-the-header-files-for-the-static-library-using-quotation-marks-in-a-typical-solution-the-path-will-start-with-library-project-name-intellisense-will-help-you-find-it"></a>引用符を使用して静的ライブラリのヘッダー ファイルが含まれます。 一般的なソリューションで、パスは始まります`../<library project name>`します。 IntelliSense は、これを見つけるのに役立ちます。
2. スタティック ライブラリ プロジェクトへの参照を追加します。 右クリックして**参照**でアプリケーションのプロジェクト ノードの下**ソリューション エクスプ ローラー**選択**参照の追加**します。 

場合は、ソリューションの一部でない静的ライブラリ。

1. アプリケーションのプロジェクト ノードを右クリックして**ソリューション エクスプ ローラー**選び、**プロパティ**します。 
2. **Vc++ ディレクトリ**プロパティ ページで、.lib ファイルにあるディレクトリへのパスを追加**ライブラリ パス**ライブラリのヘッダー ファイルにパスを追加および**のインクルード ディレクトリ**.  
3. **リンカー > 入力**プロパティ ページで、.lib ファイルの名前を追加**追加の依存関係**します。

## <a name="dynamic-link-libraries"></a>ダイナミック リンク ライブラリ

アプリケーションと同じソリューションの一部として、DLL を構築する場合は、スタティック ライブラリと同じ手順に従います。

DLL がアプリケーション ソリューションの一部でない場合、DLL ファイルのエクスポートされた関数およびクラスのプロトタイプのヘッダーとリンクに必要な情報を提供する .lib ファイル必要があります。

1. Dll の場合、プロジェクトの出力フォルダーに、または標準の Windows 検索パス内の別のフォルダーに DLL をコピーします。 参照してください[ダイナミック リンク ライブラリの検索順序](/windows/desktop/dlls/dynamic-link-library-search-order)します。
2. ヘッダーと .lib ファイルへのパスを提供する静的ライブラリの 1 ~ 3 の手順に従います。

## <a name="com-objects"></a>COM オブジェクト

場合は、ネイティブ C++ アプリケーションが、COM オブジェクトを使用する必要があるあり、そのオブジェクトが*登録*CoCreateInstance を呼び出して、オブジェクトの CLSID を渡すにはすべて行う必要があります。 システムが Windows レジストリで検索し、読み込むことです。 C++/cli またはからへの参照を追加することで、同じ方法で CLI プロジェクトが COM オブジェクトを使用できる、**参照の追加 > COM**リストを使用する. その[ランタイム呼び出し可能ラッパー](/dotnet/framework/interop/runtime-callable-wrapper)。 

## <a name="net-assemblies-and-windows-runtime-components"></a>.NET アセンブリと Windows ランタイム コンポーネント

UWP または C +/cli CLI プロジェクトでは、.NET アセンブリまたは Windows ランタイム コンポーネントを追加することで使用する、*参照*アセンブリまたはコンポーネントにします。 下、**参照**ノード UWP または C +/cli プロジェクトで、一般的に使用されるコンポーネントへの参照を参照してください。 右クリックし、**参照**ノード**ソリューション エクスプ ローラー**を起動、**参照マネージャー**し、システムで認識されている追加のコンポーネントを参照します。 をクリックして、**参照**カスタム コンポーネントが配置されている任意のフォルダーに移動するボタンをクリックします。 メソッド、クラスを表示を右クリックして .NET アセンブリと Windows ランタイム コンポーネントには、組み込みの型情報が含まれている、ため**オブジェクト ブラウザーで表示**します。 

## <a name="reference-properties"></a>参照のプロパティ

参照には種類に従ってそれぞれプロパティがあります。 プロパティを表示するには、ソリューション エクスプローラーで参照を選んで **Alt + Enter**キーを押すか、右クリックして **[プロパティ]** を選びます。 読み取り専用のプロパティと、変更できるプロパティがあります。 ただし、通常はこれらのプロパティを手動で変更する必要はありません。

### <a name="activex-reference-properties"></a>ActiveX 参照のプロパティ

ActiveX 参照のプロパティは、COM コンポーネントへの参照に対してのみ使用できます。 これらのプロパティは、 **[参照]** ウィンドウで COM コンポーネントが選択されている場合にのみ表示されます。 プロパティは修正できません。

- **コントロールの完全なパス**

   参照先のコントロールのディレクトリ パスが表示されます。

- **コントロールの GUID**

   ActiveX コントロールの GUID が表示されます。

- **コントロールのバージョン**

   参照先の ActiveX コントロールのバージョンが表示されます。

- **タイプ ライブラリ名**

   参照されているタイプ ライブラリ名が表示されます。

- **ラッパー ツール**

   参照先の COM ライブラリまたは ActiveX コントロールからの相互運用機能アセンブリをビルドするために使用するツールが表示されます。

### <a name="assembly-reference-properties-ccli"></a>アセンブリ参照のプロパティ (C +/cli CLI)

アセンブリ参照のプロパティは、C + での .NET Framework アセンブリへの参照でのみ使用できます/cli CLI プロジェクト。 これらのプロパティが表示されるは、.NET Framework アセンブリが選択されている場合にのみ、**参照**ウィンドウ。 プロパティは修正できません。

- **相対パス**

   プロジェクト ディレクトリから参照するアセンブリへの相対パスが表示されます。

### <a name="build-properties"></a>ビルド プロパティ

次のプロパティは、さまざまな種類の参照で使用できます。 参照付きでビルドする方法をこれらのプロパティにより指定できます。

- **ローカルにコピー**

   ビルド時に、参照するアセンブリをターゲットの場所に自動的にコピーするかどうかを指定します。

- **ローカル サテライト アセンブリをコピーする (C +/cli CLI)**

   ビルド時に、参照するアセンブリのサテライト アセンブリをターゲットの場所に自動的にコピーするかどうかを指定します。 **[ローカルにコピー]** が **true** の場合にのみ使用します。

- **参照アセンブリの出力**

   このアセンブリがビルド処理で使用されることを指定します。 **true** の場合、ビルド時にコンパイラのコマンド ラインでアセンブリが使用されます。

### <a name="project-to-project-reference-properties"></a>プロジェクト間参照プロパティ

次のプロパティを定義、*プロジェクト間参照*で選択されているプロジェクトから、**参照**ウィンドウで、同じソリューション内の別のプロジェクトにします。 詳細については、「[プロジェクト内の参照の管理](/visualstudio/ide/managing-references-in-a-project)」を参照してください。

- **ライブラリ依存関係のリンク**

   このプロパティが **True**の場合、プロジェクト システムは、独立プロジェクトから生成される依存プロジェクトである .lib ファイルにリンクされます。 通常は **True**を指定します。

- **プロジェクト識別子**

   独立したプロジェクトを一意に識別します。 プロパティの値は、変更できない内部システムの GUID です。

- **ライブラリ依存関係の入力の使用**

   このプロパティが **False**の場合、プロジェクト システムは、独立プロジェクトから生成されるライブラリの依存プロジェクトである .lib ファイルにリンクされません。 そのため、この値はインクリメンタル リンクを無効にします。 依存プロジェクトが多い場合、アプリケーションのビルドには時間がかかるため、通常は **False** を指定します。

### <a name="read-only-reference-properties-com--net"></a>読み取り専用参照プロパティ (COM と .NET)

次のプロパティは COM および .NET のアセンブリ参照のものであり、変更できません。

- **アセンブリ名**

   参照するアセンブリのアセンブリ名が表示されます。

- **カルチャ**

   選択された参照のカルチャが表示されます。

- **説明**

   選択された参照の説明が表示されます。

- **完全パス**

   参照されたアセンブリのディレクトリ パスが表示されます。

- **ID**

   .NET Framework アセンブリでは、完全なパスが表示されます。 COM コンポーネントでは、GUID が表示されます。

- **ラベル**

   参照のラベルが表示されます。

- **Name**

   参照名が表示されます。

- **公開キー トークン**

   参照されたアセンブリを識別するための公開キー トークンが表示されます。

- **厳密な名前**

   参照が厳密な名前を持つ場合は`true` です。 厳密な名前を持つアセンブリは、一意にバージョン管理されます。

- **Version**

   参照アセンブリのバージョンが表示されます。

## <a name="see-also"></a>関連項目

[C++ プロジェクト プロパティ ページの参照](reference/property-pages-visual-cpp.md)<br>
[Visual Studio で C++ コンパイラとビルド プロパティを設定する](working-with-project-properties.md)