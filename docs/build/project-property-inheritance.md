---
title: C++ の Visual Studio プロジェクトのプロパティの継承
ms.date: 12/10/2018
helpviewer_keywords:
- Visual C++ projects, property inheritance
ms.openlocfilehash: edd6d3bf82f7a13cf6687abeba3758dcceca5e84
ms.sourcegitcommit: 0ab61bc3d2b6cfbd52a16c6ab2b97a8ea1864f12
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "62295454"
---
# <a name="property-inheritance-in-visual-studio-projects"></a>Visual Studio プロジェクトのプロパティの継承

Visual Studio プロジェクト システムは、ファイル形式と任意の種類のプロジェクトを構築するための規則を定義する MSBuild に基づいています。 MSBuild は、複数の構成とプラットフォームに対するビルドの複雑さの大部分を管理しますが、そのしくみについて少し理解しておく必要があります。 これは、カスタム構成を定義する場合、または複数のプロジェクトで共有してインポートできる再利用可能なプロパティのセットを作成する場合に、特に重要です。

## <a name="the-vcxproj-file-props-files-and-targets-files"></a>.Vcxproj ファイル、.props ファイルおよび .targets ファイル

プロジェクト ファイル (*.vcxproj) に直接、またはその他の .targets または .props ファイル、プロジェクト ファイルのインポートとこれが既定値を指定することで、プロジェクトのプロパティが格納されます。 Visual Studio 2015 では、これらのファイルは **\Program Files (x86)\MSBuild\Microsoft.Cpp\v4.0\V140** にあります。 Visual Studio 2017 では、これらのファイルは **\\Program Files (x86)\\Microsoft Visual Studio\\2017\\_edition_\\Common7\\IDE\\VC\\VCTargets** にあります。_edition_ はインストールされている Visual Studio のエディションです。 プロパティは、独自のプロジェクトに追加されているすべてのカスタム .props ファイルにも格納されます。 これらのファイルは手動で編集しないことを強くお勧めします。MSBuild を非常によく理解しているのでないかぎり、すべてのプロパティの変更には IDE のプロパティ ページを使ってください。継承に関わるプロパティは特にそうです。

前述のように同じ構成の同じプロパティはこれらの異なるファイルで別の値を割り当てる可能性があります。 プロジェクトをビルドするとき、MSBuild エンジンは、プロジェクト ファイルとすべてのインポートされたファイルを、適切に定義された順序 (後述) で評価します。 各ファイルが評価されると、そのファイルで定義されているすべてのプロパティ値が、既存の値をオーバーライドします。 指定されていない値は、前に評価されたファイルから継承されます。 そのため、プロパティ ページでプロパティを設定するときは、それを設定する場所にも注意を払うことが重要です。 あるプロパティを .props ファイルで "X" に設定しても、プロジェクト ファイルでそのプロパティが "Y" に設定されている場合、プロジェクトは "Y" に設定されたプロパティでビルドされます。 同じプロパティが .cpp ファイルなどのプロジェクト項目で "Z" に設定されている場合、MSBuild エンジンは値 "Z" を使います。 

基本的な継承ツリーを次に示します。

1. MSBuild CPP ツールセットの既定の設定 (.vcxproj ファイルによってインポートされる ..\Program Files\MSBuild\Microsoft.Cpp\v4.0\Microsoft.Cpp.Default.props)

2. プロパティ シート

3. .vcxproj ファイル (既定値とプロパティ シートの設定をオーバーライド可能)。

4. 項目メタデータ

> [!TIP]
> プロパティ ページで、`bold` のプロパティは、現在のコンテキストで定義されます。 通常フォントのプロパティが継承されます。

## <a name="view-an-expanded-project-file-with-all-imported-values"></a>展開されたプロジェクト ファイルをインポートしたすべての値を表示します。

指定したプロパティ値がどのように継承されているかを特定するために、拡張されたファイルを表示すると便利な場合があります。 拡張されたバージョンを表示するには、Visual Studio コマンド プロンプトで次のコマンドを入力します (プレースホルダー ファイル名を適宜変更してください)。

**msbuild /pp:** *temp* **.txt** *myapp* **.vcxproj**

拡張されたプロジェクト ファイルは大きく、MSBuild に詳しくない場合は理解するのが難しい可能性があります。 プロジェクト ファイルの基本的な構造を次に示します。

1. IDE では公開されていない基本的なプロジェクトのプロパティ。

2. ツールセットに依存しない一部の基本的なプロパティを定義する Microsoft.cpp.default.props のインポート。

3. グローバル構成プロパティ (**[Configuration General]\(構成概要\)** ページの **[PlatformToolset]** および **[プロジェクト]** 既定プロパティとして公開されます)。 これらのプロパティは、次の手順の Microsoft.cpp.props でインポートされるツールセットおよび組み込みプロパティ シートを決定します。

4. プロジェクトのほとんどの既定値を設定する Microsoft.cpp.props のインポート。

5. .user を含むすべてのプロパティ シートのインポート。 これらのプロパティ シートは、**[PlatformToolset]** および **[プロジェクト]** の既定プロパティを除くすべてをオーバーライドできます。

6. プロジェクト構成プロパティの残り。 これらの値は、プロパティ シートの設定をオーバーライドできます。

7. 項目 (ファイル) とそのメタデータ。 これらは、他のプロパティやインポートの前に発生した場合でも、常に MSBuild 評価規則の最後の単語です。

詳細については、「[MSBuild プロパティ](/visualstudio/msbuild/msbuild-properties)」を参照してください。

## <a name="build-configurations"></a>ビルドの構成

構成は、名前が与えられたプロパティの任意のグループでしかありません。 Visual Studio では、デバッグ構成とリリース構成が提供されており、それぞれにおいてデバッグ ビルドまたはリリース ビルドに適したさまざまなプロパティが設定されています。 **構成マネージャー**を使うと、特定のビルド フレーバーに対するプロパティをグループ化するための便利な方法として、カスタム構成を定義できます。 

ビルド構成の理解を深めるを開きます**プロパティ マネージャー**を選択して**ビュー&#124;プロパティ マネージャー**または**ビュー&#124;その他の Windows&#124;プロパティ マネージャー**の設定によって異なります。 **プロパティ マネージャー**プロジェクトに構成およびプラットフォームの各ペアのノードが存在します。 これらの各ノードの下には、その構成に固有のプロパティを設定するプロパティ シート (.props ファイル) のノードがあります。

![プロパティ マネージャー](media/property-manager.png "プロパティ マネージャー")

プロパティ ページで、全般 ペインに移動し、"Unicode を使用して"ではなく「設定しない」する文字セット プロパティを設定してかどうか をクリックして**OK**、プロパティ マネージャーに表示されますありません**Unicode のサポート**のプロパティ シート現在の構成が残っている他の構成。

プロパティ マネージャーやプロパティ シートに関する詳細については、次を参照してください。 [Visual Studio の C++ プロジェクトの設定を共有または resuse](create-reusable-property-configurations.md)します。

> [!TIP]
> .user ファイルはレガシ機能であり、構成/プラットフォームに従ってプロパティが正しくグループ化されるように、削除することをお勧めします。



