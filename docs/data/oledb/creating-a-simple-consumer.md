---
title: 単純なコンシューマーの作成
ms.date: 11/06/2018
helpviewer_keywords:
- OLE DB consumers, creating
ms.assetid: ae32d657-72ea-4db8-9839-75cb5cff68ae
ms.openlocfilehash: 060a39a8436ff73900ebfaea7d1c882b9862ee7e
ms.sourcegitcommit: c7f90df497e6261764893f9cc04b5d1f1bf0b64b
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/05/2019
ms.locfileid: "59025138"
---
# <a name="creating-a-simple-consumer"></a>単純なコンシューマーの作成

使用して、 **ATL プロジェクト ウィザード**と**ATL OLE DB コンシューマー ウィザード**OLE DB テンプレート コンシューマーを生成します。

## <a name="to-create-a-console-application-for-an-ole-db-consumer"></a>OLE DB コンシューマーのコンソール アプリケーションを作成するには

1. **[ファイル]** メニューの **[新規作成]** をポイントし、 **[プロジェクト]** をクリックします。

   **[新しいプロジェクト]** ダイアログ ボックスが表示されます。

1. **プロジェクトの種類**ウィンドウで、をクリックして、**インストール済み** > **Visual C** > **Windows デスクトップ**フォルダークリックして、 **Windows デスクトップ ウィザード**アイコン、**テンプレート**ウィンドウ。 **名前**ボックスに、たとえば、プロジェクトの名前を入力*MyCons*します。

1. **[OK]** をクリックします。

   **Windows デスクトップ プロジェクト**ウィザードが表示されます。

1. **アプリケーション設定** ページで、**コンソール アプリケーション**、し、 **ATL の共通ヘッダー ファイルの追加**します。

1. クリックして**OK**ウィザードを閉じるし、プロジェクトを生成します。

次に、使用、 **ATL OLE DB コンシューマー ウィザード**OLE DB コンシューマー オブジェクトを追加します。

## <a name="to-create-a-consumer-with-the-atl-ole-db-consumer-wizard"></a>ATL OLE DB コンシューマー ウィザードを使用してコンシューマーを作成するには

1. **ソリューション エクスプ ローラー**を右クリックし、`MyCons`プロジェクト。

1. ショートカット メニューで、**追加**、 をクリックし、**新しい項目の**。

   **[新しい項目の追加]** ダイアログ ボックスが表示されます。

1. **カテゴリ**ウィンドウで、をクリックして**インストール済み** > **Visual C** > **ATL**をクリックします **。ATL OLEDB コンシューマー**アイコン、**テンプレート**ペイン、およびクリック**追加**します。

   **ATL OLEDB コンシューマー ウィザード**が表示されます。

1. をクリックして、**データソース**ボタンをクリックします。

   **データ リンク プロパティ** ダイアログ ボックスが表示されます。

1. **データ リンク プロパティ** ダイアログ ボックスで、次の操作を行います。

   1. **プロバイダー** ] タブの [OLE DB プロバイダーを指定します。

   1. **接続** タブで、サーバー上のサーバー名、ログオン ID、およびデータ ソースとデータベースのパスワードなど、必要な情報を指定します。

      > [!NOTE]
      > セキュリティの問題がある、**パスワードを保存する**の機能、**データ リンク プロパティ** ダイアログ ボックス。 **、サーバーにログオン情報を入力して**は 2 つのラジオ ボタンがあります。**統合セキュリティを使用して Windows NT**と**特定のユーザー名とパスワードを使用して、** します。

      > [!NOTE]
      > 選択した場合**特定のユーザー名とパスワードを使用して、**、パスワードを保存するオプションがある (を使用して、**パスワードを保存する** チェック ボックス)。 ただし、このオプションは安全ではありません。 選択することをお勧め**統合セキュリティを使用して Windows NT**; このオプションでは、Windows NT を使用して、お客様の本人確認します。

      > [!NOTE]
      > Windows NT 統合セキュリティを使用できない場合は、パスワードの入力を求めますか、それを保護するためのセキュリティ機構の場所にパスワードを保存する中間層アプリケーションを使用する必要があります (の代わりにソース コードで)。

   1. プロバイダーとその他の設定を選択すると、次のようにクリックします。 **Test-connection**を前のダイアログ ボックスのページで選択内容を確認します。 場合、**結果**レポート ボックス`Test connection succeeded`、 をクリックして**OK**データ リンクを作成します。

   **データベース オブジェクトの選択** ダイアログ ボックスが表示されます。

1. ツリー コントロールを使用すると、テーブル、ビュー、またはストアド プロシージャを選択できます。 この例では、選択、`Products`テーブルから、`Northwind`データベース。

1. **[OK]** をクリックします。 戻ります、 **ATL OLE DB コンシューマー ウィザード**します。

1. ウィザードの完了の名`Class`と **.h ファイル**のテーブル、ビュー、名前に基づくまたはストアド プロシージャを選択します。 場合は、これらの名前を編集できます。

1. クリア、**属性**ウィザードを使用するコンシューマー コードを作成するようにチェック ボックスをオン[OLE DB テンプレート クラス](../../data/oledb/ole-db-consumer-templates-reference.md)、既定ではなく[OLE DB コンシューマー属性](../../windows/ole-db-consumer-attributes.md)します。

1. **型**、**コマンド**します。

   ウィザードを作成、 [CCommand](../../data/oledb/ccommand-class.md)-選択した場合は、コンシューマーをベース**コマンド**または[CTable](../../data/oledb/ctable-class.md)-選択した場合は、コンシューマーをベース**テーブル**。 テーブルまたはコマンド クラスの名前は、選択したオブジェクトが名前を編集することができます。

1. **サポート**のままに、**変更**、**挿入**、および**削除**ボックスをオフします。

   選択、**変更**、**挿入**、および**削除**変更、挿入、および行セット内のレコードの削除をサポートするためのチェック ボックス。 ストアのデータへのデータの書き込みの詳細についてを参照してください[行セットの更新](../../data/oledb/updating-rowsets.md)します。

1. クリックして**完了**コンシューマーを作成します。

ウィザードで生成コマンド クラスとユーザー レコード クラスでは、ように[コンシューマー クラス](../../data/oledb/consumer-wizard-generated-classes.md)します。 コマンド クラスに入力した名前になります、`Class`ボックス、ウィザードに (この場合、 `CProducts`)、ユーザー レコード クラスは、フォームの名前が"*ClassName*アクセサー"(この場合、 `CProductsAccessor`)。

> [!NOTE]
> ウィザードは、次の行に`Products.h`:

```cpp
#error Security Issue: The connection string may contain a password
```

> [!NOTE]
> この行コンシューマー アプリケーションをコンパイルおよびプロセスのパスワードをハード コーディングされた接続文字列を確認することを知らせます。 接続文字列を確認するには後のコード行を削除できます。

## <a name="see-also"></a>関連項目

[ウィザードを使用した OLE DB コンシューマーの作成](../../data/oledb/creating-an-ole-db-consumer-using-a-wizard.md)
