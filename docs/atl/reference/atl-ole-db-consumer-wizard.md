---
title: ATL OLE DB コンシューマー ウィザード
ms.date: 08/31/2018
f1_keywords:
- vc.codewiz.class.atl.consumer.overview
helpviewer_keywords:
- ATL projects, adding ATL OLE DB consumers
- connection strings [C++], OLE DB consumers
- ATL OLE DB Consumer Wizard
ms.assetid: dcb68ed1-2224-422f-9f7b-108a74864204
ms.openlocfilehash: 59ad635f62ab7a20a31de7255ec4522136e102ec
ms.sourcegitcommit: 0ab61bc3d2b6cfbd52a16c6ab2b97a8ea1864f12
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "62261261"
---
# <a name="atl-ole-db-consumer-wizard"></a>ATL OLE DB コンシューマー ウィザード

このウィザードを設定する OLE DB コンシューマー クラス、データ バインディングで指定された OLE DB プロバイダーを指定したデータ ソースにアクセスするために必要です。

> [!NOTE]
> このウィザードでは、をクリックする必要があります、**データソース**で名前を入力する前に、データ ソースを選択するボタン、`Class`と **.h ファイル**フィールド。

## <a name="uielement-list"></a>UIElement の一覧

- **Data Source**

   **データソース**ボタンを指定した OLE DB プロバイダーを使用して、指定されたデータ ソースを設定することができます。 このボタンをクリックすると、**データ リンク プロパティ** ダイアログ ボックスが表示されます。 接続文字列の作成の詳細については、**データ リンク プロパティ**ダイアログ ボックスを参照してください[Data Link API の概要](/previous-versions/windows/desktop/ms718102)Windows SDK のドキュメント。

   次の追加情報がタブについて説明します、**データ リンク プロパティ** ダイアログ ボックス。

   - **プロバイダー**  タブ

      データ ソースへの接続を管理する適切なプロバイダーを選択します。 プロバイダーの種類は、通常、接続先データベースの種類によって決まります。 をクリックして、**次**ボタンまたはをクリックして、**接続**タブ。

   - **接続** タブ

      このタブの内容は、選択したプロバイダーによって異なります。 ここで、2 つの接続は、さまざまな種類のプロバイダーがありますが、最も一般的な。SQL および ODBC のデータ。 他のユーザーは、ここで説明するフィールドのようなバリエーションです。

      SQL データ。

      1. **選択するか、サーバー名を入力します。** ネットワーク上に登録されているデータのすべてのサーバーを表示するドロップダウン メニューをクリックし、いずれかを選択します。

      1. **サーバーにログオンする情報を入力します。** ユーザー名とデータ サーバーにログオンするためのパスワードを入力します。

         > [!NOTE]
         > データ リンク プロパティ ダイアログ ボックスの「パスワードを保存する」機能でセキュリティの問題があります。 「サーバーにログオンする入力は、」では、2 つのラジオ ボタンがあります。
         >
         > - **Windows NT 統合セキュリティを使用します。**
         > - **[特定のユーザー名とパスワードを使用する]**
         >
         > 選択した場合**特定のユーザー名とパスワードを使用して、**、(「パスワードの保存を許可する」のチェック ボックスを使用して) パスワードを保存するオプションがあります。 ただし、このオプションは安全ではありません。 選択することをお勧め**統合セキュリティを使用して Windows NT**; パスワードが暗号化されるため、このオプションはセキュリティで保護します。
         > 「パスワードを保存する」を選択する状況もあります。 たとえば、プライベート データベース ソリューションのライブラリをリリースする場合する必要があります、データベースに直接アクセスできませんは代わりに使用中間層アプリケーション (選択した任意の認証方法) を介してユーザーを確認し、データの並べ替えを制限するにはユーザーが使用できます。

      1. **サーバー上のデータベースを選択します。** データ サーバーに登録されているすべてのデータベースを表示するドロップダウン メニューをクリックし、いずれかを選択します。

         \- または -

         **データベース名としてデータベース ファイルをアタッチします。** データベースとして使用するファイルを指定します。明示的なパス名を入力します。

      ODBC データ。

      1. **データのソースを指定します。** データ ソース名または接続文字列を使用することができます。

         **データ ソース名を使用します。** このドロップダウン リストには、コンピューターに登録されているデータ ソースが表示されます。 事前に、ODBC データ ソース アドミニストレーターを使用してデータ ソースを設定することができます。

         \- または -

         **接続文字列を使用します。** 取得済み、またはをクリックする、接続文字列を入力するか、**ビルド**; ボタン、**データ ソースの選択** ダイアログ ボックスが表示されます。 ファイルまたはマシンのデータ ソースを選択し、クリックして**OK**します。

         > [!NOTE]
         > 接続文字列を取得するには、既存の接続のプロパティを表示する**サーバー エクスプ ローラー**をダブルクリックして、接続を作成することも**接続の追加**で**サーバーエクスプ ローラー**します。

      1. **サーバーにログオンする情報を入力します。** ユーザー名とデータ サーバーにログオンするためのパスワードを入力します。

      1. 使用する初期カタログを入力します。

      1. をクリックして**接続のテスト**、テストが成功したかどうかはクリックして**OK**。 ない場合は、ログオン情報を調べて、別のデータベースまたはデータの別のサーバーを実行してください。

   - **高度な** タブ

      **ネットワークの設定:** 指定、**偽装レベル**(サーバーがクライアントを偽装するときに使用できる; RPC 偽装レベルに直接対応している権限借用のレベル) と**保護レベル**(クライアントとサーバーの間で送信されるデータの保護レベル直接対応して RPC 保護レベル)。

      **その他の。****接続のタイムアウト**タイムアウトが発生する前に許容されるアイドル時間の秒数を指定します。 **アクセス許可**、データ接続のアクセス許可を指定します。

      高度な初期化プロパティの詳細については、各 OLE DB プロバイダーに提供されるドキュメントを参照してください。

   - **すべて** タブ

      このタブには、データ ソースと指定した接続の初期化プロパティの概要が表示されます。 これらの値を編集することができます。

      をクリックして**OK**を完了します。 **データベース オブジェクトの選択** ダイアログ ボックスが表示されます。 このダイアログ ボックスからテーブル、ビュー、またはコンシューマーが使用するストアド プロシージャを選択します。

- **Class**

   データ ソースを選択すると、このボックスには、テーブルまたは選択したストアド プロシージャに基づく既定のクラス名が設定されます (を参照してください**データ ソースの選択**以下)。 クラス名を編集することができます。

- **.h ファイル**

   データ ソースを選択すると、このボックスには、テーブルまたは選択したストアド プロシージャに基づく既定のヘッダー クラス名が設定されます (を参照してください**データ ソースの選択**以下)。 ヘッダー ファイルの名前を編集したり、既存のヘッダー ファイルを選択することができます。

- **属性付き**

   このオプションは、ウィザードが属性またはテンプレート宣言を使用してコンシューマー クラスを作成するかどうかを指定します。 このオプションを選択すると、ウィザードは、テンプレートの宣言 (これは、既定のオプションです) ではなく属性を使用します。 このオプションをオフにすると、ウィザードは、属性ではなくテンプレート宣言を使用します。

   - コンシューマーを選択した場合**型**の**テーブル**、ウィザードを使用して、`db_source`と`db_table`クラス宣言では、テーブルとテーブルのアクセサーを作成する属性を使用して`db_column`に列マップを作成します。 たとえば、このマップが作成されます。

        ```cpp
        // Inject table class and table accessor class declarations
        [db_source("<initialization_string>"), db_table("dbo.Orders")]
        ...
        // Column map
        [ db_column(1, status=m_dwOrderIDStatus, length=m_dwOrderIDLength) ] LONG m_OrderID;
        [ db_column(2, status=m_dwCustomerIDStatus, length=m_dwCustomerIDLength) ] TCHAR m_CustomerID[6];
        ...
        ```

      使用する代わりに、`CTable`テーブルとテーブルのアクセサー クラスとこの例のように、列のマップを作成する BEGIN_COLUMN_MAP と END_COLUMN_MAP マクロを宣言するテンプレート クラス。

        ```cpp
        // Table accessor class
            class COrdersAccessor; // Table class
            class COrders : public CTable<CAccessor<COrdersAccessor>>;
        // ...
        // Column map
            BEGIN_COLUMN_MAP(COrderDetailsAccessor)
                COLUMN_ENTRY_LENGTH_STATUS(1, m_OrderID, m_dwOrderIDLength, m_dwOrderIDStatus)
                COLUMN_ENTRY_LENGTH_STATUS(2, m_CustomerID, m_dwCustomerIDLength, m_dwCustomerIDStatus)
                // ...
            END_COLUMN_MAP()
        ```

   - コンシューマーを選択した場合**型**の**コマンド**、ウィザードを使用して、`db_source`と`db_command`属性、および使用`db_column`列マップを作成します。 たとえば、このマップが作成されます。

        ```cpp
        [db_source("<initialization_string>"), db_command("SQL_command")]
        ...
        // Column map using db_column is the same as for consumer type of 'table'
        ```

      コマンドとコマンドのアクセサーを使用する代わりに、コマンド クラスの .h ファイル内の宣言をたとえばクラスします。

        ```cpp
        // Command accessor class:
            class CListOrdersAccessor;
        // Command class:
            class CListOrders : public CCommand<CAccessor<CListOrdersAccessor>>;
        // ...
        // Column map using BEGIN_COLUMN_MAP ... END_COLUMN_MAP is the same as
        // for consumer type of 'table'
        ```

      参照してください[属性の基本的なしくみ](../../windows/basic-mechanics-of-attributes.md)詳細についてはします。

- **Type**

   これらのコンシューマー クラスをから派生するかどうかを指定するラジオ ボタンのいずれかを選択`CTable`または`CCommand`(既定値)。

   - **テーブル**

      使用する場合は、このオプションを選択`CTable`または`db_table`クラス宣言にテーブルとテーブルのアクセサーを作成します。

   - **コマンド**

      使用する場合は、このオプションを選択`CCommand`または`db_command`クラス宣言に、コマンドとコマンドのアクセサーを作成します。 これは既定値です。

- **サポート**

   (既定値は none です)、コンシューマーでサポートされる更新プログラムの種類を指定するチェック ボックスを選択します。 次の各設定は[DBPROP_IRowsetChange](/previous-versions/windows/desktop/ms715892)の適切なエントリ[DBPROP_UPDATABILITY](/previous-versions/windows/desktop/ms722676)プロパティにマップを設定します。

   - **変更**

      コンシューマーが行セットの行のデータの更新をサポートするを指定します。

   - **[挿入]**

      コンシューマーが行セットに行の挿入をサポートするを指定します。

   - **削除**

      コンシューマーが行セットから行の削除をサポートするを指定します。

## <a name="see-also"></a>関連項目

[ATL OLE DB コンシューマー](../../atl/reference/adding-an-atl-ole-db-consumer.md)<br/>
[コード ウィザードを使用した機能の追加](../../ide/adding-functionality-with-code-wizards-cpp.md)<br/>
[接続文字列およびデータ リンク (OLE DB)](/previous-versions/windows/desktop/ms718376)
