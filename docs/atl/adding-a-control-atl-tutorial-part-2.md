---
title: コントロールの追加 (ATL チュートリアル、パート 2)
ms.custom: get-started-article
ms.date: 09/26/2018
ms.assetid: c9575a75-1064-41f1-9697-7aada560c669
ms.openlocfilehash: 53f38d63a44328bf014f04635a24989a875ddf1e
ms.sourcegitcommit: 6cf0c67acce633b07ff31b56cebd5de3218fd733
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/24/2019
ms.locfileid: "67344328"
---
# <a name="adding-a-control-atl-tutorial-part-2"></a>コントロールの追加 (ATL チュートリアル、パート 2)

この手順で、ビルドし、および、Web ページでテストをプロジェクトにコントロールを追加します。

## <a name="procedures"></a>手順

### <a name="to-add-an-object-to-an-atl-project"></a>オブジェクトを ATL プロジェクトに追加するには

1. **ソリューション エクスプローラー**で、`Polygon` プロジェクトを右クリックします。

1. をポイント**追加**をクリックし、ショートカット メニュー**新しい項目の**サブメニューにします。

    **[新しい項目の追加]** ダイアログ ボックスが表示されます。 さまざまなオブジェクトのカテゴリが、左側にツリー構造で表示されます。

1. をクリックして、 **ATL**フォルダー。

1. 右側にあるテンプレートのリストから選択**ATL コントロール**します。 **[追加]** をクリックします。 **ATL コントロール**ウィザードが起動し、コントロールを構成することができます。

1. 型`PolyCtl`として短い名前とその他のフィールドが自動的に完了したことに注意してください。 クリックしてしないでください**完了**まだ、少し変更する必要があるためです。

**ATL コントロール**ウィザードの**名**ページには、次のフィールドが含まれています。

|フィールド|目次|
|-----------|--------------|
|**短い名前**|コントロール用に入力した名前。|
|**Class**|コントロールを実装するために作成された C++ クラス名。|
|**.h ファイル**|C++ クラスの定義を格納するために作成されたファイル。|
|**.cpp ファイル**|C++ クラスの実装を格納するために作成されたファイル。|
|**コクラス**|このコントロールのコンポーネント クラスの名前。|
|**Interface**|コントロールがカスタム プロパティとメソッドを実装するインターフェイスの名前。|
|**Type**|コントロールの説明。|
|**ProgID**|コントロールの CLSID を検索するために使用できる、判読可能な名前。|

その他の設定の変更が必要があります、 **ATL コントロール**ウィザード。

### <a name="to-enable-support-for-rich-error-information-and-connection-points"></a>詳細なエラー情報と接続ポイントのサポートを有効にするには

1. クリックして**オプション**を開く、**オプション**ページ。

1. 選択、**コネクション ポイント**チェック ボックスをオンします。 このオプションでは、IDL ファイルに、アウトゴーイング インターフェイスのサポートを作成します。

コントロールの機能を拡張するインターフェイスを追加することもできます。

### <a name="to-extend-the-controls-functionality"></a>コントロールの機能を拡張するには

1. クリックして**インターフェイス**を開く、**インターフェイス**ページ。

1. 選択`IProvideClassInfo2` をクリックし、**を**に移動する矢印、**サポートされている**一覧。

1. 選択`ISpecifyPropertyPages` をクリックし、**を**に移動する矢印、**サポートされている**一覧。

コントロールを作成することも*挿入可能な*Excel や Word などの埋め込みオブジェクトをサポートするアプリケーションに埋め込むことを意味するは。

### <a name="to-make-the-control-insertable"></a>コントロールを挿入可能にするには

1. クリックして**外観**を開く、**外観**ページ。

1. 選択、 **Insertable**チェック ボックスをオンします。

このオブジェクトによって表示される多角形には、単色による塗りつぶしを適用するため、"`Fill Color`" ストック プロパティを追加する必要があります。

### <a name="to-add-a-fill-color-stock-property-and-create-the-control"></a>"塗りつぶしの色" ストック プロパティを追加するには、コントロールを作成します。

1. クリックして**ストック プロパティ**を開く、**ストック プロパティ**ページ。

1. **はサポートされていません**、可能なストック プロパティの一覧をスクロールしています。 選択`Fill Color` をクリックし、**を**に移動する矢印、**サポートされている**一覧。

1. **[完了]** を選択します。

ウィザードでは、コントロールが作成され、いくつかのコードの変更とファイルの追加が発生します。 次のファイルが作成されます。

|ファイル|説明|
|----------|-----------------|
|PolyCtl.h|C++ クラス `CPolyCtl` のほとんどの実装が格納されています。|
|PolyCtl.cpp|`CPolyCtl` の残りの部分が格納されています。|
|PolyCtl.rgs|コントロールの登録に使用するレジストリ スクリプトが格納されたテキスト ファイル。|
|PolyCtl.htm|新しく作成されたコントロールへの参照が含まれた Web ページ。|

ウィザードでは、次のコード変更も加えます。

- 追加、`#include`ステートメントを含める、ATL stdafx.h および stdafx.cpp ファイルにはコントロールをサポートするために必要なファイルします。

- 新しいコントロールの詳細を含めるに Polygon.idl が変更されます。

- Polygon.cpp のオブジェクトのマップに新しいコントロールを追加します。

これで、コントロールをビルドして動作を確認できます。

## <a name="building-and-testing-the-control"></a>コントロールのビルドとテスト

### <a name="to-build-and-test-the-control"></a>コントロールをビルドおよびテストするには

1. **ビルド** メニューのをクリックして**多角形のビルド**します。

    コントロールには、ビルドが完了すると後で PolyCtl.htm を右クリックして**ソリューション エクスプ ローラー**選択**ブラウザーで表示**します。 コントロールを含む HTML Web ページが表示されます。 タイトル"ATL 8.0 テスト ページ オブジェクト PolyCtl"と、コントロール、テキスト PolyCtl のあるページが表示されます。

> [!NOTE]
> コントロールが表示されない場合は、一部のブラウザーが ActiveX コントロールの実行設定の調整を必要と知っています。 ActiveX コントロールを有効にする方法については、ブラウザーのドキュメントを参照してください。

> [!NOTE]
> DLL ファイルを作成できないこと、エラー メッセージが表示された場合、このチュートリアルの実行と PolyCtl.htm ファイルを閉じて、ActiveX コントロール テスト コンテナー ソリューションをもう一度ビルドします。 それでも DLL を作成できない場合、コンピューターを再起動またはターミナル サービスを使用している場合は、ログオフします。

次に、コントロールにカスタム プロパティを追加します。

[手順 1 に戻る](../atl/creating-the-project-atl-tutorial-part-1.md) &#124; [ステップ 3 に進む](../atl/adding-a-property-to-the-control-atl-tutorial-part-3.md)

## <a name="see-also"></a>関連項目

[チュートリアル](../atl/active-template-library-atl-tutorial.md)
